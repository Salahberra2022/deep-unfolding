<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.5.0"/>
    <title>deep_unfolding API documentation</title>
            <link rel="icon" href="img/favicon.png"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>
            <img src="img/logo.png" class="logo" alt="project logo"/>


            <h2>Contents</h2>
            <ul>
  <li><a href="#deep-unfolding-deep-unfolding-of-iterative-methods">deep-unfolding: Deep unfolding of iterative methods</a>
  <ul>
    <li><a href="#installation">Installation</a></li>
    <li><a href="#quick-start">Quick start</a></li>
    <li><a href="#package-contents">Package contents</a></li>
    <li><a href="#reference">Reference</a></li>
    <li><a href="#license">License</a></li>
  </ul></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#AOR">AOR</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AOR.__init__">AOR</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.n">n</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.Minv">Minv</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.omega">omega</a>
                        </li>
                        <li>
                                <a class="variable" href="#AOR.r">r</a>
                        </li>
                        <li>
                                <a class="function" href="#AOR.iterate">iterate</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AORCheby">AORCheby</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AORCheby.__init__">AORCheby</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.n">n</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.Minv">Minv</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.omega">omega</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORCheby.r">r</a>
                        </li>
                        <li>
                                <a class="function" href="#AORCheby.iterate">iterate</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AORNet">AORNet</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AORNet.__init__">AORNet</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORNet.device">device</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORNet.r">r</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORNet.omega">omega</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORNet.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORNet.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORNet.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORNet.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORNet.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORNet.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORNet.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#AORNet.y">y</a>
                        </li>
                        <li>
                                <a class="function" href="#AORNet.forward">forward</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#BaseModel">BaseModel</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BaseModel.__init__">BaseModel</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaseModel.n">n</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaseModel.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaseModel.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaseModel.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaseModel.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaseModel.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaseModel.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaseModel.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaseModel.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaseModel.Minv">Minv</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#decompose_matrix">decompose_matrix</a>
            </li>
            <li>
                    <a class="variable" href="#device">device</a>
            </li>
            <li>
                    <a class="function" href="#evaluate_model">evaluate_model</a>
            </li>
            <li>
                    <a class="function" href="#generate_A_H_sol">generate_A_H_sol</a>
            </li>
            <li>
                    <a class="class" href="#GS">GS</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#GS.__init__">GS</a>
                        </li>
                        <li>
                                <a class="variable" href="#GS.n">n</a>
                        </li>
                        <li>
                                <a class="variable" href="#GS.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#GS.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#GS.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#GS.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#GS.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#GS.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#GS.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#GS.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#GS.Minv">Minv</a>
                        </li>
                        <li>
                                <a class="variable" href="#GS.num_itr">num_itr</a>
                        </li>
                        <li>
                                <a class="function" href="#GS.iterate">iterate</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Jacobi">Jacobi</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Jacobi.__init__">Jacobi</a>
                        </li>
                        <li>
                                <a class="variable" href="#Jacobi.n">n</a>
                        </li>
                        <li>
                                <a class="variable" href="#Jacobi.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#Jacobi.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#Jacobi.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#Jacobi.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#Jacobi.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#Jacobi.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#Jacobi.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#Jacobi.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#Jacobi.Minv">Minv</a>
                        </li>
                        <li>
                                <a class="variable" href="#Jacobi.omega">omega</a>
                        </li>
                        <li>
                                <a class="function" href="#Jacobi.iterate">iterate</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#model_iterations">model_iterations</a>
            </li>
            <li>
                    <a class="class" href="#RI">RI</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#RI.__init__">RI</a>
                        </li>
                        <li>
                                <a class="variable" href="#RI.n">n</a>
                        </li>
                        <li>
                                <a class="variable" href="#RI.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#RI.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#RI.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#RI.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#RI.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#RI.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#RI.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#RI.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#RI.Minv">Minv</a>
                        </li>
                        <li>
                                <a class="function" href="#RI.iterate">iterate</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RINet">RINet</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#RINet.__init__">RINet</a>
                        </li>
                        <li>
                                <a class="variable" href="#RINet.inv_omega">inv_omega</a>
                        </li>
                        <li>
                                <a class="variable" href="#RINet.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#RINet.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#RINet.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#RINet.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#RINet.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#RINet.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#RINet.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#RINet.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#RINet.device">device</a>
                        </li>
                        <li>
                                <a class="function" href="#RINet.forward">forward</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SOR">SOR</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SOR.__init__">SOR</a>
                        </li>
                        <li>
                                <a class="variable" href="#SOR.n">n</a>
                        </li>
                        <li>
                                <a class="variable" href="#SOR.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#SOR.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#SOR.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#SOR.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#SOR.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#SOR.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#SOR.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#SOR.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#SOR.Minv">Minv</a>
                        </li>
                        <li>
                                <a class="variable" href="#SOR.omega">omega</a>
                        </li>
                        <li>
                                <a class="function" href="#SOR.iterate">iterate</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SORCheby">SORCheby</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SORCheby.__init__">SORCheby</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.n">n</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.Minv">Minv</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.omega">omega</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.omegaa">omegaa</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORCheby.gamma">gamma</a>
                        </li>
                        <li>
                                <a class="function" href="#SORCheby.iterate">iterate</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SORChebyNet">SORChebyNet</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SORChebyNet.__init__">SORChebyNet</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.device">device</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.gamma">gamma</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.omega">omega</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.inv_omega">inv_omega</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORChebyNet.y">y</a>
                        </li>
                        <li>
                                <a class="function" href="#SORChebyNet.forward">forward</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SORNet">SORNet</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SORNet.__init__">SORNet</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORNet.device">device</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORNet.inv_omega">inv_omega</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORNet.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORNet.D">D</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORNet.L">L</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORNet.U">U</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORNet.H">H</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORNet.Dinv">Dinv</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORNet.bs">bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#SORNet.y">y</a>
                        </li>
                        <li>
                                <a class="function" href="#SORNet.forward">forward</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#train_model">train_model</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
deep_unfolding    </h1>

                        <div class="docstring"><p><a href="https://github.com/Salahberra2022/deep-unfolding/actions/workflows/tests.yml"><img src="https://github.com/Salahberra2022/deep-unfolding/actions/workflows/tests.yml/badge.svg" alt="Tests" /></a>
<a href="https://codecov.io/gh/Salahberra2022/deep-unfolding"><img src="https://codecov.io/gh/Salahberra2022/deep-unfolding/graph/badge.svg?token=7LPWPLHYC4" alt="codecov" /></a>
<a href="https://Salahberra2022.github.io/deep-unfolding/"><img src="https://img.shields.io/badge/docs-click_here-blue.svg" alt="docs" /></a>
<a href="https://pypi.org/project/deep-unfolding/"><img src="https://img.shields.io/pypi/v/deep-unfolding" alt="PyPI" /></a>
<img src="https://img.shields.io/pypi/dm/deep-unfolding?color=blueviolet" alt="PyPI - Downloads" />
<a href="https://www.tldrlegal.com/license/gnu-general-public-license-v3-gpl-3"><img src="https://img.shields.io/badge/license-GPLv3-yellowgreen.svg" alt="GPLv3" /></a></p>

<h1 id="deep-unfolding-deep-unfolding-of-iterative-methods">deep-unfolding: Deep unfolding of iterative methods</h1>

<p>The <strong>deep-unfolding</strong> package includes iterative methods for solving linear equations. However, due to the various parameters and performance characteristics of the iterative approach, it is necessary to optimize these parameters to improve the convergence rate. <strong>deep-unfolding</strong> takes an iterative algorithm with a fixed number of iterations $T$, unravels its structure, and adds trainable parameters. These parameters are then trained using deep learning techniques such as loss functions, stochastic gradient descent, and backpropagation.</p>

<p>The package contains two different modules containing iterative methods. The first, <code>methods</code>, includes conventional iterative methods. The second, <code>train_methods</code>, includes deep unfolding versions of the conventional methods.</p>

<h2 id="installation">Installation</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
pip<span class="w"> </span>install<span class="w"> </span>deep-unfolding
</code></pre>
</div>

<h2 id="quick-start">Quick start</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">deep_unfolding</span> <span class="kn">import</span> <span class="n">device</span><span class="p">,</span> <span class="n">evaluate_model</span><span class="p">,</span> <span class="n">generate_A_H_sol</span><span class="p">,</span> <span class="n">SORNet</span><span class="p">,</span> <span class="n">train_model</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">optim</span>

<span class="n">total_itr</span> <span class="o">=</span> <span class="mi">25</span>  <span class="c1"># Total number of iterations</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># Number of rows</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1"># Number of columns</span>
<span class="n">bs</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># Mini-batch size (samples)</span>
<span class="n">num_batch</span> <span class="o">=</span> <span class="mi">500</span>  <span class="c1"># Number of mini-batches</span>
<span class="n">lr_adam</span> <span class="o">=</span> <span class="mf">0.002</span>  <span class="c1"># Learning rate of optimizer</span>
<span class="n">init_val_SORNet</span> <span class="o">=</span> <span class="mf">1.1</span>  <span class="c1"># Initial value of omega for SORNet</span>

<span class="n">seed</span> <span class="o">=</span> <span class="mi">12</span>

<span class="n">A</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">solution</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">generate_A_H_sol</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">)</span>
<span class="n">loss_func</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>

<span class="c1"># Model</span>
<span class="n">model_SorNet</span> <span class="o">=</span> <span class="n">SORNet</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">init_val_SORNet</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

<span class="c1"># Optimizer</span>
<span class="n">opt_SORNet</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model_SorNet</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">lr_adam</span><span class="p">)</span>

<span class="n">trained_model_SorNet</span><span class="p">,</span> <span class="n">loss_gen_SORNet</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">model_SorNet</span><span class="p">,</span> <span class="n">opt_SORNet</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">,</span> <span class="n">solution</span><span class="p">,</span> <span class="n">total_itr</span><span class="p">,</span> <span class="n">num_batch</span><span class="p">)</span>

<span class="n">norm_list_SORNet</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">trained_model_SorNet</span><span class="p">,</span> <span class="n">solution</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">total_itr</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="package-contents">Package contents</h2>

<p>This package implements various iterative techniques for approximating the solutions of linear problems of the type $Ax = b$. The conventional methods implemented in the <code>methods</code> module are:</p>

<ul>
<li><strong>GS</strong>: Gauss-Seidel (GS) algorithm</li>
<li><strong>RI</strong>: Richardson iteration algorithm</li>
<li><strong>Jacobi</strong>: Jacobi iteration (RI) algorithm</li>
<li><strong>SOR</strong>: Successive Over-Relaxation (SOR) algorithm</li>
<li><strong>SORCheby</strong>: Successive Over-Relaxation (SOR) with Chebyshev acceleration algorithm</li>
<li><strong>AOR</strong>: Accelerated Over-Relaxation (AOR) algorithm</li>
<li><strong>AORCheby</strong>: Accelerated Over-Relaxation (AOR) with Chebyshev acceleration algorithm</li>
</ul>

<p>This package also implements several models based on <strong>Deep Unfolding Learning</strong>, enabling optimization of the parameters of some of the preceding algorithms to obtain an optimal approximation. The models implemented in the module <code>train_methods</code> are:</p>

<ul>
<li><strong>SORNet</strong>: Optimization via Deep Unfolding Learning of the Successive Over-Relaxation (SOR) algorithm</li>
<li><strong>SORChebyNet</strong>: Optimization via Deep Unfolding Learning of the Successive Over-Relaxation (SOR) with Chebyshev acceleration algorithm</li>
<li><strong>AORNet</strong>: Optimization via Deep Unfolding Learning of the Accelerated Over-Relaxation (AOR) algorithm</li>
<li><strong>RINet</strong>: Optimization via Deep Unfolding Learning of the Richardson iteration (RI) algorithm</li>
</ul>

<h2 id="reference">Reference</h2>

<p>If you use this software, please cite the following reference: <em>available soon</em></p>

<h2 id="license">License</h2>

<p><a href="LICENSE">GPLv3 License</a></p>
</div>

                        <input id="mod-deep_unfolding-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-deep_unfolding-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="c1"># Copyright (c) 2023-2024 Salah Berra and contributors</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="c1"># Distributed under the the GNU General Public License (See accompanying file</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="c1"># LICENSE or copy at https://www.gnu.org/licenses/)</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="sd">.. include:: ../../README.md</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="n">__docformat__</span> <span class="o">=</span> <span class="s2">&quot;google&quot;</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>    <span class="s2">&quot;AOR&quot;</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>    <span class="s2">&quot;AORCheby&quot;</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a>    <span class="s2">&quot;AORNet&quot;</span><span class="p">,</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a>    <span class="s2">&quot;BaseModel&quot;</span><span class="p">,</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a>    <span class="s2">&quot;decompose_matrix&quot;</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a>    <span class="s2">&quot;device&quot;</span><span class="p">,</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a>    <span class="s2">&quot;evaluate_model&quot;</span><span class="p">,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a>    <span class="s2">&quot;generate_A_H_sol&quot;</span><span class="p">,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a>    <span class="s2">&quot;GS&quot;</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a>    <span class="s2">&quot;Jacobi&quot;</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>    <span class="s2">&quot;model_iterations&quot;</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a>    <span class="s2">&quot;RI&quot;</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>    <span class="s2">&quot;RINet&quot;</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>    <span class="s2">&quot;SOR&quot;</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>    <span class="s2">&quot;SORCheby&quot;</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>    <span class="s2">&quot;SORChebyNet&quot;</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>    <span class="s2">&quot;SORNet&quot;</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>    <span class="s2">&quot;train_model&quot;</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a><span class="p">]</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a><span class="kn">from</span> <span class="nn">deep_unfolding.methods</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="n">AOR</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a>    <span class="n">GS</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>    <span class="n">RI</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>    <span class="n">SOR</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>    <span class="n">AORCheby</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="n">BaseModel</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>    <span class="n">Jacobi</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>    <span class="n">SORCheby</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="n">model_iterations</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a><span class="p">)</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a><span class="kn">from</span> <span class="nn">deep_unfolding.train_methods</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>    <span class="n">AORNet</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>    <span class="n">RINet</span><span class="p">,</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>    <span class="n">SORChebyNet</span><span class="p">,</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>    <span class="n">SORNet</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>    <span class="n">evaluate_model</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>    <span class="n">train_model</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a><span class="p">)</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a><span class="kn">from</span> <span class="nn">deep_unfolding.utils</span> <span class="kn">import</span> <span class="n">decompose_matrix</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">generate_A_H_sol</span>
</span></pre></div>


            </section>
                <section id="AOR">
                            <input id="AOR-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AOR</span><wbr>(<span class="base"><a href="#BaseModel">deep_unfolding.BaseModel</a></span>):

                <label class="view-source-button" for="AOR-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AOR"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AOR-543"><a href="#AOR-543"><span class="linenos">543</span></a><span class="k">class</span> <span class="nc">AOR</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="AOR-544"><a href="#AOR-544"><span class="linenos">544</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class implementing the Accelerated Over-Relaxation (AOR) algorithm for</span>
</span><span id="AOR-545"><a href="#AOR-545"><span class="linenos">545</span></a><span class="sd">    solving a linear system.&quot;&quot;&quot;</span>
</span><span id="AOR-546"><a href="#AOR-546"><span class="linenos">546</span></a>
</span><span id="AOR-547"><a href="#AOR-547"><span class="linenos">547</span></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="AOR-548"><a href="#AOR-548"><span class="linenos">548</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimension of the solution.&quot;&quot;&quot;</span>
</span><span id="AOR-549"><a href="#AOR-549"><span class="linenos">549</span></a>
</span><span id="AOR-550"><a href="#AOR-550"><span class="linenos">550</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AOR-551"><a href="#AOR-551"><span class="linenos">551</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random matrix $H$.&quot;&quot;&quot;</span>
</span><span id="AOR-552"><a href="#AOR-552"><span class="linenos">552</span></a>
</span><span id="AOR-553"><a href="#AOR-553"><span class="linenos">553</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="AOR-554"><a href="#AOR-554"><span class="linenos">554</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="AOR-555"><a href="#AOR-555"><span class="linenos">555</span></a>
</span><span id="AOR-556"><a href="#AOR-556"><span class="linenos">556</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AOR-557"><a href="#AOR-557"><span class="linenos">557</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution tensor.&quot;&quot;&quot;</span>
</span><span id="AOR-558"><a href="#AOR-558"><span class="linenos">558</span></a>
</span><span id="AOR-559"><a href="#AOR-559"><span class="linenos">559</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AOR-560"><a href="#AOR-560"><span class="linenos">560</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Original matrix converted to a torch tensor.&quot;&quot;&quot;</span>
</span><span id="AOR-561"><a href="#AOR-561"><span class="linenos">561</span></a>
</span><span id="AOR-562"><a href="#AOR-562"><span class="linenos">562</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AOR-563"><a href="#AOR-563"><span class="linenos">563</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="AOR-564"><a href="#AOR-564"><span class="linenos">564</span></a>
</span><span id="AOR-565"><a href="#AOR-565"><span class="linenos">565</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AOR-566"><a href="#AOR-566"><span class="linenos">566</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="AOR-567"><a href="#AOR-567"><span class="linenos">567</span></a>
</span><span id="AOR-568"><a href="#AOR-568"><span class="linenos">568</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AOR-569"><a href="#AOR-569"><span class="linenos">569</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="AOR-570"><a href="#AOR-570"><span class="linenos">570</span></a>
</span><span id="AOR-571"><a href="#AOR-571"><span class="linenos">571</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AOR-572"><a href="#AOR-572"><span class="linenos">572</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="AOR-573"><a href="#AOR-573"><span class="linenos">573</span></a>
</span><span id="AOR-574"><a href="#AOR-574"><span class="linenos">574</span></a>    <span class="n">Minv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AOR-575"><a href="#AOR-575"><span class="linenos">575</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the matrix $D + L$.&quot;&quot;&quot;</span>
</span><span id="AOR-576"><a href="#AOR-576"><span class="linenos">576</span></a>
</span><span id="AOR-577"><a href="#AOR-577"><span class="linenos">577</span></a>    <span class="n">omega</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AOR-578"><a href="#AOR-578"><span class="linenos">578</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Relaxation parameter for AOR iterations.&quot;&quot;&quot;</span>
</span><span id="AOR-579"><a href="#AOR-579"><span class="linenos">579</span></a>
</span><span id="AOR-580"><a href="#AOR-580"><span class="linenos">580</span></a>    <span class="n">r</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AOR-581"><a href="#AOR-581"><span class="linenos">581</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Relaxation parameter.&quot;&quot;&quot;</span>
</span><span id="AOR-582"><a href="#AOR-582"><span class="linenos">582</span></a>
</span><span id="AOR-583"><a href="#AOR-583"><span class="linenos">583</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="AOR-584"><a href="#AOR-584"><span class="linenos">584</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="AOR-585"><a href="#AOR-585"><span class="linenos">585</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AOR-586"><a href="#AOR-586"><span class="linenos">586</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
</span><span id="AOR-587"><a href="#AOR-587"><span class="linenos">587</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AOR-588"><a href="#AOR-588"><span class="linenos">588</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AOR-589"><a href="#AOR-589"><span class="linenos">589</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AOR-590"><a href="#AOR-590"><span class="linenos">590</span></a>        <span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
</span><span id="AOR-591"><a href="#AOR-591"><span class="linenos">591</span></a>        <span class="n">r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="AOR-592"><a href="#AOR-592"><span class="linenos">592</span></a>    <span class="p">):</span>
</span><span id="AOR-593"><a href="#AOR-593"><span class="linenos">593</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the AOR solver.</span>
</span><span id="AOR-594"><a href="#AOR-594"><span class="linenos">594</span></a>
</span><span id="AOR-595"><a href="#AOR-595"><span class="linenos">595</span></a><span class="sd">        Args:</span>
</span><span id="AOR-596"><a href="#AOR-596"><span class="linenos">596</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="AOR-597"><a href="#AOR-597"><span class="linenos">597</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="AOR-598"><a href="#AOR-598"><span class="linenos">598</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="AOR-599"><a href="#AOR-599"><span class="linenos">599</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="AOR-600"><a href="#AOR-600"><span class="linenos">600</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="AOR-601"><a href="#AOR-601"><span class="linenos">601</span></a><span class="sd">          omega: Relaxation parameter for AOR iterations.</span>
</span><span id="AOR-602"><a href="#AOR-602"><span class="linenos">602</span></a><span class="sd">          r: Relaxation parameter.</span>
</span><span id="AOR-603"><a href="#AOR-603"><span class="linenos">603</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AOR-604"><a href="#AOR-604"><span class="linenos">604</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">AOR</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="AOR-605"><a href="#AOR-605"><span class="linenos">605</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</span><span id="AOR-606"><a href="#AOR-606"><span class="linenos">606</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span><span id="AOR-607"><a href="#AOR-607"><span class="linenos">607</span></a>
</span><span id="AOR-608"><a href="#AOR-608"><span class="linenos">608</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="AOR-609"><a href="#AOR-609"><span class="linenos">609</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the AOR iterations and returns the final solution and</span>
</span><span id="AOR-610"><a href="#AOR-610"><span class="linenos">610</span></a><span class="sd">          trajectory of solutions.</span>
</span><span id="AOR-611"><a href="#AOR-611"><span class="linenos">611</span></a>
</span><span id="AOR-612"><a href="#AOR-612"><span class="linenos">612</span></a><span class="sd">        Args:</span>
</span><span id="AOR-613"><a href="#AOR-613"><span class="linenos">613</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="AOR-614"><a href="#AOR-614"><span class="linenos">614</span></a>
</span><span id="AOR-615"><a href="#AOR-615"><span class="linenos">615</span></a><span class="sd">        Returns:</span>
</span><span id="AOR-616"><a href="#AOR-616"><span class="linenos">616</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="AOR-617"><a href="#AOR-617"><span class="linenos">617</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="AOR-618"><a href="#AOR-618"><span class="linenos">618</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="AOR-619"><a href="#AOR-619"><span class="linenos">619</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AOR-620"><a href="#AOR-620"><span class="linenos">620</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AOR-621"><a href="#AOR-621"><span class="linenos">621</span></a>
</span><span id="AOR-622"><a href="#AOR-622"><span class="linenos">622</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="AOR-623"><a href="#AOR-623"><span class="linenos">623</span></a>        <span class="n">m_inv_aor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="AOR-624"><a href="#AOR-624"><span class="linenos">624</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AOR-625"><a href="#AOR-625"><span class="linenos">625</span></a>            <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
</span><span id="AOR-626"><a href="#AOR-626"><span class="linenos">626</span></a>            <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="AOR-627"><a href="#AOR-627"><span class="linenos">627</span></a>            <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span>
</span><span id="AOR-628"><a href="#AOR-628"><span class="linenos">628</span></a>        <span class="p">)</span>
</span><span id="AOR-629"><a href="#AOR-629"><span class="linenos">629</span></a>
</span><span id="AOR-630"><a href="#AOR-630"><span class="linenos">630</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AOR-631"><a href="#AOR-631"><span class="linenos">631</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="AOR-632"><a href="#AOR-632"><span class="linenos">632</span></a>
</span><span id="AOR-633"><a href="#AOR-633"><span class="linenos">633</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="AOR-634"><a href="#AOR-634"><span class="linenos">634</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="AOR-635"><a href="#AOR-635"><span class="linenos">635</span></a>
</span><span id="AOR-636"><a href="#AOR-636"><span class="linenos">636</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="AOR-637"><a href="#AOR-637"><span class="linenos">637</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv_aor</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span>
</span><span id="AOR-638"><a href="#AOR-638"><span class="linenos">638</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv_aor</span><span class="p">)</span>
</span><span id="AOR-639"><a href="#AOR-639"><span class="linenos">639</span></a>            <span class="p">)</span>
</span><span id="AOR-640"><a href="#AOR-640"><span class="linenos">640</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="AOR-641"><a href="#AOR-641"><span class="linenos">641</span></a>
</span><span id="AOR-642"><a href="#AOR-642"><span class="linenos">642</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Class implementing the Accelerated Over-Relaxation (AOR) algorithm for
solving a linear system.</p>
</div>


                            <div id="AOR.__init__" class="classattr">
                                        <input id="AOR.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">AOR</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">+</span><span class="n">_ScalarType_co</span><span class="p">]]</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span>,</span><span class="param">	<span class="n">r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span></span>)</span>

                <label class="view-source-button" for="AOR.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AOR.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AOR.__init__-583"><a href="#AOR.__init__-583"><span class="linenos">583</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="AOR.__init__-584"><a href="#AOR.__init__-584"><span class="linenos">584</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="AOR.__init__-585"><a href="#AOR.__init__-585"><span class="linenos">585</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AOR.__init__-586"><a href="#AOR.__init__-586"><span class="linenos">586</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
</span><span id="AOR.__init__-587"><a href="#AOR.__init__-587"><span class="linenos">587</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AOR.__init__-588"><a href="#AOR.__init__-588"><span class="linenos">588</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AOR.__init__-589"><a href="#AOR.__init__-589"><span class="linenos">589</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AOR.__init__-590"><a href="#AOR.__init__-590"><span class="linenos">590</span></a>        <span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
</span><span id="AOR.__init__-591"><a href="#AOR.__init__-591"><span class="linenos">591</span></a>        <span class="n">r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="AOR.__init__-592"><a href="#AOR.__init__-592"><span class="linenos">592</span></a>    <span class="p">):</span>
</span><span id="AOR.__init__-593"><a href="#AOR.__init__-593"><span class="linenos">593</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the AOR solver.</span>
</span><span id="AOR.__init__-594"><a href="#AOR.__init__-594"><span class="linenos">594</span></a>
</span><span id="AOR.__init__-595"><a href="#AOR.__init__-595"><span class="linenos">595</span></a><span class="sd">        Args:</span>
</span><span id="AOR.__init__-596"><a href="#AOR.__init__-596"><span class="linenos">596</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="AOR.__init__-597"><a href="#AOR.__init__-597"><span class="linenos">597</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="AOR.__init__-598"><a href="#AOR.__init__-598"><span class="linenos">598</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="AOR.__init__-599"><a href="#AOR.__init__-599"><span class="linenos">599</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="AOR.__init__-600"><a href="#AOR.__init__-600"><span class="linenos">600</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="AOR.__init__-601"><a href="#AOR.__init__-601"><span class="linenos">601</span></a><span class="sd">          omega: Relaxation parameter for AOR iterations.</span>
</span><span id="AOR.__init__-602"><a href="#AOR.__init__-602"><span class="linenos">602</span></a><span class="sd">          r: Relaxation parameter.</span>
</span><span id="AOR.__init__-603"><a href="#AOR.__init__-603"><span class="linenos">603</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AOR.__init__-604"><a href="#AOR.__init__-604"><span class="linenos">604</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">AOR</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="AOR.__init__-605"><a href="#AOR.__init__-605"><span class="linenos">605</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</span><span id="AOR.__init__-606"><a href="#AOR.__init__-606"><span class="linenos">606</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the AOR solver.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n:</strong>  Dimension of the solution.</li>
<li><strong>a:</strong>  Input square matrix to decompose.</li>
<li><strong>h:</strong>  Random matrix $H$.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution tensor.</li>
<li><strong>omega:</strong>  Relaxation parameter for AOR iterations.</li>
<li><strong>r:</strong>  Relaxation parameter.</li>
</ul>
</div>


                            </div>
                            <div id="AOR.n" class="classattr">
                                <div class="attr variable">
            <span class="name">n</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#AOR.n"></a>
    
            <div class="docstring"><p>Dimension of the solution.</p>
</div>


                            </div>
                            <div id="AOR.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AOR.H"></a>
    
            <div class="docstring"><p>Random matrix $H$.</p>
</div>


                            </div>
                            <div id="AOR.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#AOR.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="AOR.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AOR.y"></a>
    
            <div class="docstring"><p>Solution tensor.</p>
</div>


                            </div>
                            <div id="AOR.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AOR.A"></a>
    
            <div class="docstring"><p>Original matrix converted to a torch tensor.</p>
</div>


                            </div>
                            <div id="AOR.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AOR.D"></a>
    
            <div class="docstring"><p>Diagonal matrix of $A$.</p>
</div>


                            </div>
                            <div id="AOR.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AOR.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="AOR.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AOR.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="AOR.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AOR.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="AOR.Minv" class="classattr">
                                <div class="attr variable">
            <span class="name">Minv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AOR.Minv"></a>
    
            <div class="docstring"><p>Inverse of the matrix $D + L$.</p>
</div>


                            </div>
                            <div id="AOR.omega" class="classattr">
                                <div class="attr variable">
            <span class="name">omega</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AOR.omega"></a>
    
            <div class="docstring"><p>Relaxation parameter for AOR iterations.</p>
</div>


                            </div>
                            <div id="AOR.r" class="classattr">
                                <div class="attr variable">
            <span class="name">r</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AOR.r"></a>
    
            <div class="docstring"><p>Relaxation parameter.</p>
</div>


                            </div>
                            <div id="AOR.iterate" class="classattr">
                                        <input id="AOR.iterate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iterate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="AOR.iterate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AOR.iterate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AOR.iterate-608"><a href="#AOR.iterate-608"><span class="linenos">608</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="AOR.iterate-609"><a href="#AOR.iterate-609"><span class="linenos">609</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the AOR iterations and returns the final solution and</span>
</span><span id="AOR.iterate-610"><a href="#AOR.iterate-610"><span class="linenos">610</span></a><span class="sd">          trajectory of solutions.</span>
</span><span id="AOR.iterate-611"><a href="#AOR.iterate-611"><span class="linenos">611</span></a>
</span><span id="AOR.iterate-612"><a href="#AOR.iterate-612"><span class="linenos">612</span></a><span class="sd">        Args:</span>
</span><span id="AOR.iterate-613"><a href="#AOR.iterate-613"><span class="linenos">613</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="AOR.iterate-614"><a href="#AOR.iterate-614"><span class="linenos">614</span></a>
</span><span id="AOR.iterate-615"><a href="#AOR.iterate-615"><span class="linenos">615</span></a><span class="sd">        Returns:</span>
</span><span id="AOR.iterate-616"><a href="#AOR.iterate-616"><span class="linenos">616</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="AOR.iterate-617"><a href="#AOR.iterate-617"><span class="linenos">617</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="AOR.iterate-618"><a href="#AOR.iterate-618"><span class="linenos">618</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="AOR.iterate-619"><a href="#AOR.iterate-619"><span class="linenos">619</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AOR.iterate-620"><a href="#AOR.iterate-620"><span class="linenos">620</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AOR.iterate-621"><a href="#AOR.iterate-621"><span class="linenos">621</span></a>
</span><span id="AOR.iterate-622"><a href="#AOR.iterate-622"><span class="linenos">622</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="AOR.iterate-623"><a href="#AOR.iterate-623"><span class="linenos">623</span></a>        <span class="n">m_inv_aor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="AOR.iterate-624"><a href="#AOR.iterate-624"><span class="linenos">624</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AOR.iterate-625"><a href="#AOR.iterate-625"><span class="linenos">625</span></a>            <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
</span><span id="AOR.iterate-626"><a href="#AOR.iterate-626"><span class="linenos">626</span></a>            <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="AOR.iterate-627"><a href="#AOR.iterate-627"><span class="linenos">627</span></a>            <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span>
</span><span id="AOR.iterate-628"><a href="#AOR.iterate-628"><span class="linenos">628</span></a>        <span class="p">)</span>
</span><span id="AOR.iterate-629"><a href="#AOR.iterate-629"><span class="linenos">629</span></a>
</span><span id="AOR.iterate-630"><a href="#AOR.iterate-630"><span class="linenos">630</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AOR.iterate-631"><a href="#AOR.iterate-631"><span class="linenos">631</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="AOR.iterate-632"><a href="#AOR.iterate-632"><span class="linenos">632</span></a>
</span><span id="AOR.iterate-633"><a href="#AOR.iterate-633"><span class="linenos">633</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="AOR.iterate-634"><a href="#AOR.iterate-634"><span class="linenos">634</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="AOR.iterate-635"><a href="#AOR.iterate-635"><span class="linenos">635</span></a>
</span><span id="AOR.iterate-636"><a href="#AOR.iterate-636"><span class="linenos">636</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="AOR.iterate-637"><a href="#AOR.iterate-637"><span class="linenos">637</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv_aor</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span>
</span><span id="AOR.iterate-638"><a href="#AOR.iterate-638"><span class="linenos">638</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv_aor</span><span class="p">)</span>
</span><span id="AOR.iterate-639"><a href="#AOR.iterate-639"><span class="linenos">639</span></a>            <span class="p">)</span>
</span><span id="AOR.iterate-640"><a href="#AOR.iterate-640"><span class="linenos">640</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="AOR.iterate-641"><a href="#AOR.iterate-641"><span class="linenos">641</span></a>
</span><span id="AOR.iterate-642"><a href="#AOR.iterate-642"><span class="linenos">642</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Performs the AOR iterations and returns the final solution and
  trajectory of solutions.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  The number of iterations to perform.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>The final solution tensor of shape (<code><a href="#AOR.bs">bs</a></code>, <code><a href="#AOR.n">n</a></code>).</li>
  <li>List containing the trajectory of solutions throughout the iterations.</li>
  </ul>
</blockquote>
</div>


                            </div>
                </section>
                <section id="AORCheby">
                            <input id="AORCheby-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AORCheby</span><wbr>(<span class="base"><a href="#BaseModel">deep_unfolding.BaseModel</a></span>):

                <label class="view-source-button" for="AORCheby-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AORCheby"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AORCheby-645"><a href="#AORCheby-645"><span class="linenos">645</span></a><span class="k">class</span> <span class="nc">AORCheby</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="AORCheby-646"><a href="#AORCheby-646"><span class="linenos">646</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class implementing the Accelerated Over-Relaxation (AOR) with Chebyshev</span>
</span><span id="AORCheby-647"><a href="#AORCheby-647"><span class="linenos">647</span></a><span class="sd">    acceleration algorithm for solving a linear system.&quot;&quot;&quot;</span>
</span><span id="AORCheby-648"><a href="#AORCheby-648"><span class="linenos">648</span></a>
</span><span id="AORCheby-649"><a href="#AORCheby-649"><span class="linenos">649</span></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="AORCheby-650"><a href="#AORCheby-650"><span class="linenos">650</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimension of the solution.&quot;&quot;&quot;</span>
</span><span id="AORCheby-651"><a href="#AORCheby-651"><span class="linenos">651</span></a>
</span><span id="AORCheby-652"><a href="#AORCheby-652"><span class="linenos">652</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORCheby-653"><a href="#AORCheby-653"><span class="linenos">653</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random matrix $H$.&quot;&quot;&quot;</span>
</span><span id="AORCheby-654"><a href="#AORCheby-654"><span class="linenos">654</span></a>
</span><span id="AORCheby-655"><a href="#AORCheby-655"><span class="linenos">655</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="AORCheby-656"><a href="#AORCheby-656"><span class="linenos">656</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="AORCheby-657"><a href="#AORCheby-657"><span class="linenos">657</span></a>
</span><span id="AORCheby-658"><a href="#AORCheby-658"><span class="linenos">658</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORCheby-659"><a href="#AORCheby-659"><span class="linenos">659</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution tensor.&quot;&quot;&quot;</span>
</span><span id="AORCheby-660"><a href="#AORCheby-660"><span class="linenos">660</span></a>
</span><span id="AORCheby-661"><a href="#AORCheby-661"><span class="linenos">661</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORCheby-662"><a href="#AORCheby-662"><span class="linenos">662</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Original matrix converted to a torch tensor.&quot;&quot;&quot;</span>
</span><span id="AORCheby-663"><a href="#AORCheby-663"><span class="linenos">663</span></a>
</span><span id="AORCheby-664"><a href="#AORCheby-664"><span class="linenos">664</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORCheby-665"><a href="#AORCheby-665"><span class="linenos">665</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="AORCheby-666"><a href="#AORCheby-666"><span class="linenos">666</span></a>
</span><span id="AORCheby-667"><a href="#AORCheby-667"><span class="linenos">667</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORCheby-668"><a href="#AORCheby-668"><span class="linenos">668</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="AORCheby-669"><a href="#AORCheby-669"><span class="linenos">669</span></a>
</span><span id="AORCheby-670"><a href="#AORCheby-670"><span class="linenos">670</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORCheby-671"><a href="#AORCheby-671"><span class="linenos">671</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="AORCheby-672"><a href="#AORCheby-672"><span class="linenos">672</span></a>
</span><span id="AORCheby-673"><a href="#AORCheby-673"><span class="linenos">673</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORCheby-674"><a href="#AORCheby-674"><span class="linenos">674</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="AORCheby-675"><a href="#AORCheby-675"><span class="linenos">675</span></a>
</span><span id="AORCheby-676"><a href="#AORCheby-676"><span class="linenos">676</span></a>    <span class="n">Minv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORCheby-677"><a href="#AORCheby-677"><span class="linenos">677</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the matrix $D + L$.&quot;&quot;&quot;</span>
</span><span id="AORCheby-678"><a href="#AORCheby-678"><span class="linenos">678</span></a>
</span><span id="AORCheby-679"><a href="#AORCheby-679"><span class="linenos">679</span></a>    <span class="n">omega</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORCheby-680"><a href="#AORCheby-680"><span class="linenos">680</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Relaxation parameter for AOR iterations.&quot;&quot;&quot;</span>
</span><span id="AORCheby-681"><a href="#AORCheby-681"><span class="linenos">681</span></a>
</span><span id="AORCheby-682"><a href="#AORCheby-682"><span class="linenos">682</span></a>    <span class="n">r</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORCheby-683"><a href="#AORCheby-683"><span class="linenos">683</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Relaxation parameter.&quot;&quot;&quot;</span>
</span><span id="AORCheby-684"><a href="#AORCheby-684"><span class="linenos">684</span></a>
</span><span id="AORCheby-685"><a href="#AORCheby-685"><span class="linenos">685</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="AORCheby-686"><a href="#AORCheby-686"><span class="linenos">686</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="AORCheby-687"><a href="#AORCheby-687"><span class="linenos">687</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AORCheby-688"><a href="#AORCheby-688"><span class="linenos">688</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
</span><span id="AORCheby-689"><a href="#AORCheby-689"><span class="linenos">689</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AORCheby-690"><a href="#AORCheby-690"><span class="linenos">690</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AORCheby-691"><a href="#AORCheby-691"><span class="linenos">691</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AORCheby-692"><a href="#AORCheby-692"><span class="linenos">692</span></a>        <span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="AORCheby-693"><a href="#AORCheby-693"><span class="linenos">693</span></a>        <span class="n">r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="AORCheby-694"><a href="#AORCheby-694"><span class="linenos">694</span></a>    <span class="p">):</span>
</span><span id="AORCheby-695"><a href="#AORCheby-695"><span class="linenos">695</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the AOR-Chebyshev solver.</span>
</span><span id="AORCheby-696"><a href="#AORCheby-696"><span class="linenos">696</span></a>
</span><span id="AORCheby-697"><a href="#AORCheby-697"><span class="linenos">697</span></a><span class="sd">        Args:</span>
</span><span id="AORCheby-698"><a href="#AORCheby-698"><span class="linenos">698</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="AORCheby-699"><a href="#AORCheby-699"><span class="linenos">699</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="AORCheby-700"><a href="#AORCheby-700"><span class="linenos">700</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="AORCheby-701"><a href="#AORCheby-701"><span class="linenos">701</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="AORCheby-702"><a href="#AORCheby-702"><span class="linenos">702</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="AORCheby-703"><a href="#AORCheby-703"><span class="linenos">703</span></a><span class="sd">          omega: Relaxation parameter for AOR iterations.</span>
</span><span id="AORCheby-704"><a href="#AORCheby-704"><span class="linenos">704</span></a><span class="sd">          r: Relaxation parameter.</span>
</span><span id="AORCheby-705"><a href="#AORCheby-705"><span class="linenos">705</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AORCheby-706"><a href="#AORCheby-706"><span class="linenos">706</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">AORCheby</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="AORCheby-707"><a href="#AORCheby-707"><span class="linenos">707</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</span><span id="AORCheby-708"><a href="#AORCheby-708"><span class="linenos">708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span><span id="AORCheby-709"><a href="#AORCheby-709"><span class="linenos">709</span></a>
</span><span id="AORCheby-710"><a href="#AORCheby-710"><span class="linenos">710</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="AORCheby-711"><a href="#AORCheby-711"><span class="linenos">711</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the AOR-Chebyshev iterations and returns the final solution</span>
</span><span id="AORCheby-712"><a href="#AORCheby-712"><span class="linenos">712</span></a><span class="sd">          and trajectory of solutions.</span>
</span><span id="AORCheby-713"><a href="#AORCheby-713"><span class="linenos">713</span></a>
</span><span id="AORCheby-714"><a href="#AORCheby-714"><span class="linenos">714</span></a><span class="sd">        Args:</span>
</span><span id="AORCheby-715"><a href="#AORCheby-715"><span class="linenos">715</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="AORCheby-716"><a href="#AORCheby-716"><span class="linenos">716</span></a>
</span><span id="AORCheby-717"><a href="#AORCheby-717"><span class="linenos">717</span></a><span class="sd">        Returns:</span>
</span><span id="AORCheby-718"><a href="#AORCheby-718"><span class="linenos">718</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="AORCheby-719"><a href="#AORCheby-719"><span class="linenos">719</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="AORCheby-720"><a href="#AORCheby-720"><span class="linenos">720</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="AORCheby-721"><a href="#AORCheby-721"><span class="linenos">721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AORCheby-722"><a href="#AORCheby-722"><span class="linenos">722</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AORCheby-723"><a href="#AORCheby-723"><span class="linenos">723</span></a>
</span><span id="AORCheby-724"><a href="#AORCheby-724"><span class="linenos">724</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORCheby-725"><a href="#AORCheby-725"><span class="linenos">725</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="AORCheby-726"><a href="#AORCheby-726"><span class="linenos">726</span></a>
</span><span id="AORCheby-727"><a href="#AORCheby-727"><span class="linenos">727</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="AORCheby-728"><a href="#AORCheby-728"><span class="linenos">728</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="AORCheby-729"><a href="#AORCheby-729"><span class="linenos">729</span></a>
</span><span id="AORCheby-730"><a href="#AORCheby-730"><span class="linenos">730</span></a>        <span class="n">y0</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="AORCheby-731"><a href="#AORCheby-731"><span class="linenos">731</span></a>
</span><span id="AORCheby-732"><a href="#AORCheby-732"><span class="linenos">732</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="AORCheby-733"><a href="#AORCheby-733"><span class="linenos">733</span></a>        <span class="n">m_inv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="AORCheby-734"><a href="#AORCheby-734"><span class="linenos">734</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AORCheby-735"><a href="#AORCheby-735"><span class="linenos">735</span></a>            <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
</span><span id="AORCheby-736"><a href="#AORCheby-736"><span class="linenos">736</span></a>            <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="AORCheby-737"><a href="#AORCheby-737"><span class="linenos">737</span></a>            <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span>
</span><span id="AORCheby-738"><a href="#AORCheby-738"><span class="linenos">738</span></a>        <span class="p">)</span>
</span><span id="AORCheby-739"><a href="#AORCheby-739"><span class="linenos">739</span></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="AORCheby-740"><a href="#AORCheby-740"><span class="linenos">740</span></a>
</span><span id="AORCheby-741"><a href="#AORCheby-741"><span class="linenos">741</span></a>        <span class="n">rho</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="AORCheby-742"><a href="#AORCheby-742"><span class="linenos">742</span></a>        <span class="n">mu0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AORCheby-743"><a href="#AORCheby-743"><span class="linenos">743</span></a>        <span class="n">mu1</span> <span class="o">=</span> <span class="n">rho</span>
</span><span id="AORCheby-744"><a href="#AORCheby-744"><span class="linenos">744</span></a>        <span class="n">xhat1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv</span><span class="p">)</span>
</span><span id="AORCheby-745"><a href="#AORCheby-745"><span class="linenos">745</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">xhat1</span>
</span><span id="AORCheby-746"><a href="#AORCheby-746"><span class="linenos">746</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span>
</span><span id="AORCheby-747"><a href="#AORCheby-747"><span class="linenos">747</span></a>
</span><span id="AORCheby-748"><a href="#AORCheby-748"><span class="linenos">748</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="AORCheby-749"><a href="#AORCheby-749"><span class="linenos">749</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">mu1</span><span class="p">)</span>
</span><span id="AORCheby-750"><a href="#AORCheby-750"><span class="linenos">750</span></a>            <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">mu0</span>
</span><span id="AORCheby-751"><a href="#AORCheby-751"><span class="linenos">751</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span> <span class="o">-</span> <span class="n">j</span>
</span><span id="AORCheby-752"><a href="#AORCheby-752"><span class="linenos">752</span></a>            <span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">c</span>
</span><span id="AORCheby-753"><a href="#AORCheby-753"><span class="linenos">753</span></a>            <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">mu1</span><span class="p">)</span>
</span><span id="AORCheby-754"><a href="#AORCheby-754"><span class="linenos">754</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AORCheby-755"><a href="#AORCheby-755"><span class="linenos">755</span></a>                <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">((</span><span class="n">y1</span> <span class="o">*</span> <span class="n">a</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
</span><span id="AORCheby-756"><a href="#AORCheby-756"><span class="linenos">756</span></a>                <span class="o">-</span> <span class="p">(((</span><span class="n">mu</span> <span class="o">/</span> <span class="n">mu0</span><span class="p">))</span> <span class="o">*</span> <span class="n">y0</span><span class="p">)</span>
</span><span id="AORCheby-757"><a href="#AORCheby-757"><span class="linenos">757</span></a>                <span class="o">+</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv</span><span class="p">))</span>
</span><span id="AORCheby-758"><a href="#AORCheby-758"><span class="linenos">758</span></a>            <span class="p">)</span>
</span><span id="AORCheby-759"><a href="#AORCheby-759"><span class="linenos">759</span></a>            <span class="n">y0</span> <span class="o">=</span> <span class="n">y1</span>
</span><span id="AORCheby-760"><a href="#AORCheby-760"><span class="linenos">760</span></a>            <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="AORCheby-761"><a href="#AORCheby-761"><span class="linenos">761</span></a>            <span class="n">mu0</span> <span class="o">=</span> <span class="n">mu1</span>
</span><span id="AORCheby-762"><a href="#AORCheby-762"><span class="linenos">762</span></a>            <span class="n">mu1</span> <span class="o">=</span> <span class="n">mu</span>
</span><span id="AORCheby-763"><a href="#AORCheby-763"><span class="linenos">763</span></a>
</span><span id="AORCheby-764"><a href="#AORCheby-764"><span class="linenos">764</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="AORCheby-765"><a href="#AORCheby-765"><span class="linenos">765</span></a>
</span><span id="AORCheby-766"><a href="#AORCheby-766"><span class="linenos">766</span></a>        <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Class implementing the Accelerated Over-Relaxation (AOR) with Chebyshev
acceleration algorithm for solving a linear system.</p>
</div>


                            <div id="AORCheby.__init__" class="classattr">
                                        <input id="AORCheby.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">AORCheby</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">+</span><span class="n">_ScalarType_co</span><span class="p">]]</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span>)</span>

                <label class="view-source-button" for="AORCheby.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AORCheby.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AORCheby.__init__-685"><a href="#AORCheby.__init__-685"><span class="linenos">685</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="AORCheby.__init__-686"><a href="#AORCheby.__init__-686"><span class="linenos">686</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="AORCheby.__init__-687"><a href="#AORCheby.__init__-687"><span class="linenos">687</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AORCheby.__init__-688"><a href="#AORCheby.__init__-688"><span class="linenos">688</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
</span><span id="AORCheby.__init__-689"><a href="#AORCheby.__init__-689"><span class="linenos">689</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AORCheby.__init__-690"><a href="#AORCheby.__init__-690"><span class="linenos">690</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AORCheby.__init__-691"><a href="#AORCheby.__init__-691"><span class="linenos">691</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AORCheby.__init__-692"><a href="#AORCheby.__init__-692"><span class="linenos">692</span></a>        <span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="AORCheby.__init__-693"><a href="#AORCheby.__init__-693"><span class="linenos">693</span></a>        <span class="n">r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="AORCheby.__init__-694"><a href="#AORCheby.__init__-694"><span class="linenos">694</span></a>    <span class="p">):</span>
</span><span id="AORCheby.__init__-695"><a href="#AORCheby.__init__-695"><span class="linenos">695</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the AOR-Chebyshev solver.</span>
</span><span id="AORCheby.__init__-696"><a href="#AORCheby.__init__-696"><span class="linenos">696</span></a>
</span><span id="AORCheby.__init__-697"><a href="#AORCheby.__init__-697"><span class="linenos">697</span></a><span class="sd">        Args:</span>
</span><span id="AORCheby.__init__-698"><a href="#AORCheby.__init__-698"><span class="linenos">698</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="AORCheby.__init__-699"><a href="#AORCheby.__init__-699"><span class="linenos">699</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="AORCheby.__init__-700"><a href="#AORCheby.__init__-700"><span class="linenos">700</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="AORCheby.__init__-701"><a href="#AORCheby.__init__-701"><span class="linenos">701</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="AORCheby.__init__-702"><a href="#AORCheby.__init__-702"><span class="linenos">702</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="AORCheby.__init__-703"><a href="#AORCheby.__init__-703"><span class="linenos">703</span></a><span class="sd">          omega: Relaxation parameter for AOR iterations.</span>
</span><span id="AORCheby.__init__-704"><a href="#AORCheby.__init__-704"><span class="linenos">704</span></a><span class="sd">          r: Relaxation parameter.</span>
</span><span id="AORCheby.__init__-705"><a href="#AORCheby.__init__-705"><span class="linenos">705</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AORCheby.__init__-706"><a href="#AORCheby.__init__-706"><span class="linenos">706</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">AORCheby</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="AORCheby.__init__-707"><a href="#AORCheby.__init__-707"><span class="linenos">707</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</span><span id="AORCheby.__init__-708"><a href="#AORCheby.__init__-708"><span class="linenos">708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the AOR-Chebyshev solver.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n:</strong>  Dimension of the solution.</li>
<li><strong>a:</strong>  Input square matrix to decompose.</li>
<li><strong>h:</strong>  Random matrix $H$.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution tensor.</li>
<li><strong>omega:</strong>  Relaxation parameter for AOR iterations.</li>
<li><strong>r:</strong>  Relaxation parameter.</li>
</ul>
</div>


                            </div>
                            <div id="AORCheby.n" class="classattr">
                                <div class="attr variable">
            <span class="name">n</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.n"></a>
    
            <div class="docstring"><p>Dimension of the solution.</p>
</div>


                            </div>
                            <div id="AORCheby.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.H"></a>
    
            <div class="docstring"><p>Random matrix $H$.</p>
</div>


                            </div>
                            <div id="AORCheby.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="AORCheby.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.y"></a>
    
            <div class="docstring"><p>Solution tensor.</p>
</div>


                            </div>
                            <div id="AORCheby.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.A"></a>
    
            <div class="docstring"><p>Original matrix converted to a torch tensor.</p>
</div>


                            </div>
                            <div id="AORCheby.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.D"></a>
    
            <div class="docstring"><p>Diagonal matrix of $A$.</p>
</div>


                            </div>
                            <div id="AORCheby.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="AORCheby.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="AORCheby.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="AORCheby.Minv" class="classattr">
                                <div class="attr variable">
            <span class="name">Minv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.Minv"></a>
    
            <div class="docstring"><p>Inverse of the matrix $D + L$.</p>
</div>


                            </div>
                            <div id="AORCheby.omega" class="classattr">
                                <div class="attr variable">
            <span class="name">omega</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.omega"></a>
    
            <div class="docstring"><p>Relaxation parameter for AOR iterations.</p>
</div>


                            </div>
                            <div id="AORCheby.r" class="classattr">
                                <div class="attr variable">
            <span class="name">r</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORCheby.r"></a>
    
            <div class="docstring"><p>Relaxation parameter.</p>
</div>


                            </div>
                            <div id="AORCheby.iterate" class="classattr">
                                        <input id="AORCheby.iterate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iterate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="AORCheby.iterate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AORCheby.iterate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AORCheby.iterate-710"><a href="#AORCheby.iterate-710"><span class="linenos">710</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="AORCheby.iterate-711"><a href="#AORCheby.iterate-711"><span class="linenos">711</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the AOR-Chebyshev iterations and returns the final solution</span>
</span><span id="AORCheby.iterate-712"><a href="#AORCheby.iterate-712"><span class="linenos">712</span></a><span class="sd">          and trajectory of solutions.</span>
</span><span id="AORCheby.iterate-713"><a href="#AORCheby.iterate-713"><span class="linenos">713</span></a>
</span><span id="AORCheby.iterate-714"><a href="#AORCheby.iterate-714"><span class="linenos">714</span></a><span class="sd">        Args:</span>
</span><span id="AORCheby.iterate-715"><a href="#AORCheby.iterate-715"><span class="linenos">715</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="AORCheby.iterate-716"><a href="#AORCheby.iterate-716"><span class="linenos">716</span></a>
</span><span id="AORCheby.iterate-717"><a href="#AORCheby.iterate-717"><span class="linenos">717</span></a><span class="sd">        Returns:</span>
</span><span id="AORCheby.iterate-718"><a href="#AORCheby.iterate-718"><span class="linenos">718</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="AORCheby.iterate-719"><a href="#AORCheby.iterate-719"><span class="linenos">719</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="AORCheby.iterate-720"><a href="#AORCheby.iterate-720"><span class="linenos">720</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="AORCheby.iterate-721"><a href="#AORCheby.iterate-721"><span class="linenos">721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AORCheby.iterate-722"><a href="#AORCheby.iterate-722"><span class="linenos">722</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AORCheby.iterate-723"><a href="#AORCheby.iterate-723"><span class="linenos">723</span></a>
</span><span id="AORCheby.iterate-724"><a href="#AORCheby.iterate-724"><span class="linenos">724</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORCheby.iterate-725"><a href="#AORCheby.iterate-725"><span class="linenos">725</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="AORCheby.iterate-726"><a href="#AORCheby.iterate-726"><span class="linenos">726</span></a>
</span><span id="AORCheby.iterate-727"><a href="#AORCheby.iterate-727"><span class="linenos">727</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="AORCheby.iterate-728"><a href="#AORCheby.iterate-728"><span class="linenos">728</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="AORCheby.iterate-729"><a href="#AORCheby.iterate-729"><span class="linenos">729</span></a>
</span><span id="AORCheby.iterate-730"><a href="#AORCheby.iterate-730"><span class="linenos">730</span></a>        <span class="n">y0</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="AORCheby.iterate-731"><a href="#AORCheby.iterate-731"><span class="linenos">731</span></a>
</span><span id="AORCheby.iterate-732"><a href="#AORCheby.iterate-732"><span class="linenos">732</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="AORCheby.iterate-733"><a href="#AORCheby.iterate-733"><span class="linenos">733</span></a>        <span class="n">m_inv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="AORCheby.iterate-734"><a href="#AORCheby.iterate-734"><span class="linenos">734</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AORCheby.iterate-735"><a href="#AORCheby.iterate-735"><span class="linenos">735</span></a>            <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
</span><span id="AORCheby.iterate-736"><a href="#AORCheby.iterate-736"><span class="linenos">736</span></a>            <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="AORCheby.iterate-737"><a href="#AORCheby.iterate-737"><span class="linenos">737</span></a>            <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span>
</span><span id="AORCheby.iterate-738"><a href="#AORCheby.iterate-738"><span class="linenos">738</span></a>        <span class="p">)</span>
</span><span id="AORCheby.iterate-739"><a href="#AORCheby.iterate-739"><span class="linenos">739</span></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="AORCheby.iterate-740"><a href="#AORCheby.iterate-740"><span class="linenos">740</span></a>
</span><span id="AORCheby.iterate-741"><a href="#AORCheby.iterate-741"><span class="linenos">741</span></a>        <span class="n">rho</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="AORCheby.iterate-742"><a href="#AORCheby.iterate-742"><span class="linenos">742</span></a>        <span class="n">mu0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AORCheby.iterate-743"><a href="#AORCheby.iterate-743"><span class="linenos">743</span></a>        <span class="n">mu1</span> <span class="o">=</span> <span class="n">rho</span>
</span><span id="AORCheby.iterate-744"><a href="#AORCheby.iterate-744"><span class="linenos">744</span></a>        <span class="n">xhat1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv</span><span class="p">)</span>
</span><span id="AORCheby.iterate-745"><a href="#AORCheby.iterate-745"><span class="linenos">745</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">xhat1</span>
</span><span id="AORCheby.iterate-746"><a href="#AORCheby.iterate-746"><span class="linenos">746</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span>
</span><span id="AORCheby.iterate-747"><a href="#AORCheby.iterate-747"><span class="linenos">747</span></a>
</span><span id="AORCheby.iterate-748"><a href="#AORCheby.iterate-748"><span class="linenos">748</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="AORCheby.iterate-749"><a href="#AORCheby.iterate-749"><span class="linenos">749</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">mu1</span><span class="p">)</span>
</span><span id="AORCheby.iterate-750"><a href="#AORCheby.iterate-750"><span class="linenos">750</span></a>            <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">mu0</span>
</span><span id="AORCheby.iterate-751"><a href="#AORCheby.iterate-751"><span class="linenos">751</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">f</span> <span class="o">-</span> <span class="n">j</span>
</span><span id="AORCheby.iterate-752"><a href="#AORCheby.iterate-752"><span class="linenos">752</span></a>            <span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">c</span>
</span><span id="AORCheby.iterate-753"><a href="#AORCheby.iterate-753"><span class="linenos">753</span></a>            <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">mu1</span><span class="p">)</span>
</span><span id="AORCheby.iterate-754"><a href="#AORCheby.iterate-754"><span class="linenos">754</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AORCheby.iterate-755"><a href="#AORCheby.iterate-755"><span class="linenos">755</span></a>                <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">((</span><span class="n">y1</span> <span class="o">*</span> <span class="n">a</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
</span><span id="AORCheby.iterate-756"><a href="#AORCheby.iterate-756"><span class="linenos">756</span></a>                <span class="o">-</span> <span class="p">(((</span><span class="n">mu</span> <span class="o">/</span> <span class="n">mu0</span><span class="p">))</span> <span class="o">*</span> <span class="n">y0</span><span class="p">)</span>
</span><span id="AORCheby.iterate-757"><a href="#AORCheby.iterate-757"><span class="linenos">757</span></a>                <span class="o">+</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv</span><span class="p">))</span>
</span><span id="AORCheby.iterate-758"><a href="#AORCheby.iterate-758"><span class="linenos">758</span></a>            <span class="p">)</span>
</span><span id="AORCheby.iterate-759"><a href="#AORCheby.iterate-759"><span class="linenos">759</span></a>            <span class="n">y0</span> <span class="o">=</span> <span class="n">y1</span>
</span><span id="AORCheby.iterate-760"><a href="#AORCheby.iterate-760"><span class="linenos">760</span></a>            <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="AORCheby.iterate-761"><a href="#AORCheby.iterate-761"><span class="linenos">761</span></a>            <span class="n">mu0</span> <span class="o">=</span> <span class="n">mu1</span>
</span><span id="AORCheby.iterate-762"><a href="#AORCheby.iterate-762"><span class="linenos">762</span></a>            <span class="n">mu1</span> <span class="o">=</span> <span class="n">mu</span>
</span><span id="AORCheby.iterate-763"><a href="#AORCheby.iterate-763"><span class="linenos">763</span></a>
</span><span id="AORCheby.iterate-764"><a href="#AORCheby.iterate-764"><span class="linenos">764</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="AORCheby.iterate-765"><a href="#AORCheby.iterate-765"><span class="linenos">765</span></a>
</span><span id="AORCheby.iterate-766"><a href="#AORCheby.iterate-766"><span class="linenos">766</span></a>        <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Performs the AOR-Chebyshev iterations and returns the final solution
  and trajectory of solutions.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  The number of iterations to perform.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>The final solution tensor of shape (<code><a href="#AORCheby.bs">bs</a></code>, <code><a href="#AORCheby.n">n</a></code>).</li>
  <li>List containing the trajectory of solutions throughout the iterations.</li>
  </ul>
</blockquote>
</div>


                            </div>
                </section>
                <section id="AORNet">
                            <input id="AORNet-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AORNet</span><wbr>(<span class="base">torch.nn.modules.module.Module</span>):

                <label class="view-source-button" for="AORNet-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AORNet"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AORNet-305"><a href="#AORNet-305"><span class="linenos">305</span></a><span class="k">class</span> <span class="nc">AORNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span id="AORNet-306"><a href="#AORNet-306"><span class="linenos">306</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Deep unfolded AOR with a constant step size.&quot;&quot;&quot;</span>
</span><span id="AORNet-307"><a href="#AORNet-307"><span class="linenos">307</span></a>
</span><span id="AORNet-308"><a href="#AORNet-308"><span class="linenos">308</span></a>    <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span>
</span><span id="AORNet-309"><a href="#AORNet-309"><span class="linenos">309</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Device to run the model on.&quot;&quot;&quot;</span>
</span><span id="AORNet-310"><a href="#AORNet-310"><span class="linenos">310</span></a>
</span><span id="AORNet-311"><a href="#AORNet-311"><span class="linenos">311</span></a>    <span class="n">r</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span>
</span><span id="AORNet-312"><a href="#AORNet-312"><span class="linenos">312</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameter `r` for AOR.&quot;&quot;&quot;</span>
</span><span id="AORNet-313"><a href="#AORNet-313"><span class="linenos">313</span></a>
</span><span id="AORNet-314"><a href="#AORNet-314"><span class="linenos">314</span></a>    <span class="n">omega</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span>
</span><span id="AORNet-315"><a href="#AORNet-315"><span class="linenos">315</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Relaxation parameter omega.&quot;&quot;&quot;</span>
</span><span id="AORNet-316"><a href="#AORNet-316"><span class="linenos">316</span></a>
</span><span id="AORNet-317"><a href="#AORNet-317"><span class="linenos">317</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORNet-318"><a href="#AORNet-318"><span class="linenos">318</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix $A$ of the linear system.&quot;&quot;&quot;</span>
</span><span id="AORNet-319"><a href="#AORNet-319"><span class="linenos">319</span></a>
</span><span id="AORNet-320"><a href="#AORNet-320"><span class="linenos">320</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORNet-321"><a href="#AORNet-321"><span class="linenos">321</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="AORNet-322"><a href="#AORNet-322"><span class="linenos">322</span></a>
</span><span id="AORNet-323"><a href="#AORNet-323"><span class="linenos">323</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORNet-324"><a href="#AORNet-324"><span class="linenos">324</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix $L$.&quot;&quot;&quot;</span>
</span><span id="AORNet-325"><a href="#AORNet-325"><span class="linenos">325</span></a>
</span><span id="AORNet-326"><a href="#AORNet-326"><span class="linenos">326</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORNet-327"><a href="#AORNet-327"><span class="linenos">327</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix $U$.&quot;&quot;&quot;</span>
</span><span id="AORNet-328"><a href="#AORNet-328"><span class="linenos">328</span></a>
</span><span id="AORNet-329"><a href="#AORNet-329"><span class="linenos">329</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORNet-330"><a href="#AORNet-330"><span class="linenos">330</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix $H$.&quot;&quot;&quot;</span>
</span><span id="AORNet-331"><a href="#AORNet-331"><span class="linenos">331</span></a>
</span><span id="AORNet-332"><a href="#AORNet-332"><span class="linenos">332</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORNet-333"><a href="#AORNet-333"><span class="linenos">333</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="AORNet-334"><a href="#AORNet-334"><span class="linenos">334</span></a>
</span><span id="AORNet-335"><a href="#AORNet-335"><span class="linenos">335</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="AORNet-336"><a href="#AORNet-336"><span class="linenos">336</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="AORNet-337"><a href="#AORNet-337"><span class="linenos">337</span></a>
</span><span id="AORNet-338"><a href="#AORNet-338"><span class="linenos">338</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="AORNet-339"><a href="#AORNet-339"><span class="linenos">339</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution of the linear equation.&quot;&quot;&quot;</span>
</span><span id="AORNet-340"><a href="#AORNet-340"><span class="linenos">340</span></a>
</span><span id="AORNet-341"><a href="#AORNet-341"><span class="linenos">341</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="AORNet-342"><a href="#AORNet-342"><span class="linenos">342</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="AORNet-343"><a href="#AORNet-343"><span class="linenos">343</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AORNet-344"><a href="#AORNet-344"><span class="linenos">344</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AORNet-345"><a href="#AORNet-345"><span class="linenos">345</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AORNet-346"><a href="#AORNet-346"><span class="linenos">346</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AORNet-347"><a href="#AORNet-347"><span class="linenos">347</span></a>        <span class="n">init_val_AORNet_r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
</span><span id="AORNet-348"><a href="#AORNet-348"><span class="linenos">348</span></a>        <span class="n">init_val_AORNet_omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span>
</span><span id="AORNet-349"><a href="#AORNet-349"><span class="linenos">349</span></a>        <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">,</span>
</span><span id="AORNet-350"><a href="#AORNet-350"><span class="linenos">350</span></a>    <span class="p">):</span>
</span><span id="AORNet-351"><a href="#AORNet-351"><span class="linenos">351</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the AORNet model.</span>
</span><span id="AORNet-352"><a href="#AORNet-352"><span class="linenos">352</span></a>
</span><span id="AORNet-353"><a href="#AORNet-353"><span class="linenos">353</span></a><span class="sd">        Args:</span>
</span><span id="AORNet-354"><a href="#AORNet-354"><span class="linenos">354</span></a><span class="sd">          a: Matrix $A$ of the linear system.</span>
</span><span id="AORNet-355"><a href="#AORNet-355"><span class="linenos">355</span></a><span class="sd">          h: Matrix $H$.</span>
</span><span id="AORNet-356"><a href="#AORNet-356"><span class="linenos">356</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="AORNet-357"><a href="#AORNet-357"><span class="linenos">357</span></a><span class="sd">          y: Solution of the linear equation.</span>
</span><span id="AORNet-358"><a href="#AORNet-358"><span class="linenos">358</span></a><span class="sd">          init_val_AORNet_r: Initial value for `r`.</span>
</span><span id="AORNet-359"><a href="#AORNet-359"><span class="linenos">359</span></a><span class="sd">          init_val_AORNet_omega: Initial value for `omega`.</span>
</span><span id="AORNet-360"><a href="#AORNet-360"><span class="linenos">360</span></a><span class="sd">          device: Device to run the model on (&#39;cpu&#39; or &#39;cuda&#39;).</span>
</span><span id="AORNet-361"><a href="#AORNet-361"><span class="linenos">361</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AORNet-362"><a href="#AORNet-362"><span class="linenos">362</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">AORNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="AORNet-363"><a href="#AORNet-363"><span class="linenos">363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
</span><span id="AORNet-364"><a href="#AORNet-364"><span class="linenos">364</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_val_AORNet_r</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>
</span><span id="AORNet-365"><a href="#AORNet-365"><span class="linenos">365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_val_AORNet_omega</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>
</span><span id="AORNet-366"><a href="#AORNet-366"><span class="linenos">366</span></a>
</span><span id="AORNet-367"><a href="#AORNet-367"><span class="linenos">367</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">decompose_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="AORNet-368"><a href="#AORNet-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet-369"><a href="#AORNet-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet-370"><a href="#AORNet-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet-371"><a href="#AORNet-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet-372"><a href="#AORNet-372"><span class="linenos">372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet-373"><a href="#AORNet-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet-374"><a href="#AORNet-374"><span class="linenos">374</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span>
</span><span id="AORNet-375"><a href="#AORNet-375"><span class="linenos">375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet-376"><a href="#AORNet-376"><span class="linenos">376</span></a>
</span><span id="AORNet-377"><a href="#AORNet-377"><span class="linenos">377</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]:</span>
</span><span id="AORNet-378"><a href="#AORNet-378"><span class="linenos">378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform forward pass of the AORNet model.</span>
</span><span id="AORNet-379"><a href="#AORNet-379"><span class="linenos">379</span></a>
</span><span id="AORNet-380"><a href="#AORNet-380"><span class="linenos">380</span></a><span class="sd">        Args:</span>
</span><span id="AORNet-381"><a href="#AORNet-381"><span class="linenos">381</span></a><span class="sd">          num_itr: Number of iterations.</span>
</span><span id="AORNet-382"><a href="#AORNet-382"><span class="linenos">382</span></a>
</span><span id="AORNet-383"><a href="#AORNet-383"><span class="linenos">383</span></a><span class="sd">        Returns:</span>
</span><span id="AORNet-384"><a href="#AORNet-384"><span class="linenos">384</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="AORNet-385"><a href="#AORNet-385"><span class="linenos">385</span></a><span class="sd">          - Output tensor.</span>
</span><span id="AORNet-386"><a href="#AORNet-386"><span class="linenos">386</span></a><span class="sd">          - List of intermediate results.</span>
</span><span id="AORNet-387"><a href="#AORNet-387"><span class="linenos">387</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AORNet-388"><a href="#AORNet-388"><span class="linenos">388</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AORNet-389"><a href="#AORNet-389"><span class="linenos">389</span></a>
</span><span id="AORNet-390"><a href="#AORNet-390"><span class="linenos">390</span></a>        <span class="n">m_inv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
</span><span id="AORNet-391"><a href="#AORNet-391"><span class="linenos">391</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AORNet-392"><a href="#AORNet-392"><span class="linenos">392</span></a>            <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span>
</span><span id="AORNet-393"><a href="#AORNet-393"><span class="linenos">393</span></a>            <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span>
</span><span id="AORNet-394"><a href="#AORNet-394"><span class="linenos">394</span></a>            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span>
</span><span id="AORNet-395"><a href="#AORNet-395"><span class="linenos">395</span></a>        <span class="p">)</span>
</span><span id="AORNet-396"><a href="#AORNet-396"><span class="linenos">396</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="AORNet-397"><a href="#AORNet-397"><span class="linenos">397</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span>
</span><span id="AORNet-398"><a href="#AORNet-398"><span class="linenos">398</span></a>        <span class="p">)</span>  <span class="c1"># change to size(0)</span>
</span><span id="AORNet-399"><a href="#AORNet-399"><span class="linenos">399</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="AORNet-400"><a href="#AORNet-400"><span class="linenos">400</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="AORNet-401"><a href="#AORNet-401"><span class="linenos">401</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="AORNet-402"><a href="#AORNet-402"><span class="linenos">402</span></a>
</span><span id="AORNet-403"><a href="#AORNet-403"><span class="linenos">403</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="AORNet-404"><a href="#AORNet-404"><span class="linenos">404</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv</span><span class="p">)</span>
</span><span id="AORNet-405"><a href="#AORNet-405"><span class="linenos">405</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="AORNet-406"><a href="#AORNet-406"><span class="linenos">406</span></a>
</span><span id="AORNet-407"><a href="#AORNet-407"><span class="linenos">407</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Deep unfolded AOR with a constant step size.</p>
</div>


                            <div id="AORNet.__init__" class="classattr">
                                        <input id="AORNet.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">AORNet</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">init_val_AORNet_r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span>,</span><span class="param">	<span class="n">init_val_AORNet_omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span>,</span><span class="param">	<span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span></span>)</span>

                <label class="view-source-button" for="AORNet.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AORNet.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AORNet.__init__-341"><a href="#AORNet.__init__-341"><span class="linenos">341</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="AORNet.__init__-342"><a href="#AORNet.__init__-342"><span class="linenos">342</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="AORNet.__init__-343"><a href="#AORNet.__init__-343"><span class="linenos">343</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AORNet.__init__-344"><a href="#AORNet.__init__-344"><span class="linenos">344</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AORNet.__init__-345"><a href="#AORNet.__init__-345"><span class="linenos">345</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AORNet.__init__-346"><a href="#AORNet.__init__-346"><span class="linenos">346</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="AORNet.__init__-347"><a href="#AORNet.__init__-347"><span class="linenos">347</span></a>        <span class="n">init_val_AORNet_r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
</span><span id="AORNet.__init__-348"><a href="#AORNet.__init__-348"><span class="linenos">348</span></a>        <span class="n">init_val_AORNet_omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span>
</span><span id="AORNet.__init__-349"><a href="#AORNet.__init__-349"><span class="linenos">349</span></a>        <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">,</span>
</span><span id="AORNet.__init__-350"><a href="#AORNet.__init__-350"><span class="linenos">350</span></a>    <span class="p">):</span>
</span><span id="AORNet.__init__-351"><a href="#AORNet.__init__-351"><span class="linenos">351</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the AORNet model.</span>
</span><span id="AORNet.__init__-352"><a href="#AORNet.__init__-352"><span class="linenos">352</span></a>
</span><span id="AORNet.__init__-353"><a href="#AORNet.__init__-353"><span class="linenos">353</span></a><span class="sd">        Args:</span>
</span><span id="AORNet.__init__-354"><a href="#AORNet.__init__-354"><span class="linenos">354</span></a><span class="sd">          a: Matrix $A$ of the linear system.</span>
</span><span id="AORNet.__init__-355"><a href="#AORNet.__init__-355"><span class="linenos">355</span></a><span class="sd">          h: Matrix $H$.</span>
</span><span id="AORNet.__init__-356"><a href="#AORNet.__init__-356"><span class="linenos">356</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="AORNet.__init__-357"><a href="#AORNet.__init__-357"><span class="linenos">357</span></a><span class="sd">          y: Solution of the linear equation.</span>
</span><span id="AORNet.__init__-358"><a href="#AORNet.__init__-358"><span class="linenos">358</span></a><span class="sd">          init_val_AORNet_r: Initial value for `r`.</span>
</span><span id="AORNet.__init__-359"><a href="#AORNet.__init__-359"><span class="linenos">359</span></a><span class="sd">          init_val_AORNet_omega: Initial value for `omega`.</span>
</span><span id="AORNet.__init__-360"><a href="#AORNet.__init__-360"><span class="linenos">360</span></a><span class="sd">          device: Device to run the model on (&#39;cpu&#39; or &#39;cuda&#39;).</span>
</span><span id="AORNet.__init__-361"><a href="#AORNet.__init__-361"><span class="linenos">361</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AORNet.__init__-362"><a href="#AORNet.__init__-362"><span class="linenos">362</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">AORNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="AORNet.__init__-363"><a href="#AORNet.__init__-363"><span class="linenos">363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
</span><span id="AORNet.__init__-364"><a href="#AORNet.__init__-364"><span class="linenos">364</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_val_AORNet_r</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>
</span><span id="AORNet.__init__-365"><a href="#AORNet.__init__-365"><span class="linenos">365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_val_AORNet_omega</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>
</span><span id="AORNet.__init__-366"><a href="#AORNet.__init__-366"><span class="linenos">366</span></a>
</span><span id="AORNet.__init__-367"><a href="#AORNet.__init__-367"><span class="linenos">367</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">decompose_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="AORNet.__init__-368"><a href="#AORNet.__init__-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet.__init__-369"><a href="#AORNet.__init__-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet.__init__-370"><a href="#AORNet.__init__-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet.__init__-371"><a href="#AORNet.__init__-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet.__init__-372"><a href="#AORNet.__init__-372"><span class="linenos">372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet.__init__-373"><a href="#AORNet.__init__-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="AORNet.__init__-374"><a href="#AORNet.__init__-374"><span class="linenos">374</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span>
</span><span id="AORNet.__init__-375"><a href="#AORNet.__init__-375"><span class="linenos">375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the AORNet model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>a:</strong>  Matrix $A$ of the linear system.</li>
<li><strong>h:</strong>  Matrix $H$.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution of the linear equation.</li>
<li><strong>init_val_AORNet_r:</strong>  Initial value for <code><a href="#AORNet.r">r</a></code>.</li>
<li><strong>init_val_AORNet_omega:</strong>  Initial value for <code><a href="#AORNet.omega">omega</a></code>.</li>
<li><strong>device:</strong>  Device to run the model on ('cpu' or 'cuda').</li>
</ul>
</div>


                            </div>
                            <div id="AORNet.device" class="classattr">
                                <div class="attr variable">
            <span class="name">device</span><span class="annotation">: torch.device</span>

        
    </div>
    <a class="headerlink" href="#AORNet.device"></a>
    
            <div class="docstring"><p>Device to run the model on.</p>
</div>


                            </div>
                            <div id="AORNet.r" class="classattr">
                                <div class="attr variable">
            <span class="name">r</span><span class="annotation">: torch.nn.parameter.Parameter</span>

        
    </div>
    <a class="headerlink" href="#AORNet.r"></a>
    
            <div class="docstring"><p>Parameter <code><a href="#AORNet.r">r</a></code> for AOR.</p>
</div>


                            </div>
                            <div id="AORNet.omega" class="classattr">
                                <div class="attr variable">
            <span class="name">omega</span><span class="annotation">: torch.nn.parameter.Parameter</span>

        
    </div>
    <a class="headerlink" href="#AORNet.omega"></a>
    
            <div class="docstring"><p>Relaxation parameter omega.</p>
</div>


                            </div>
                            <div id="AORNet.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORNet.A"></a>
    
            <div class="docstring"><p>Matrix $A$ of the linear system.</p>
</div>


                            </div>
                            <div id="AORNet.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORNet.D"></a>
    
            <div class="docstring"><p>Diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="AORNet.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORNet.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix $L$.</p>
</div>


                            </div>
                            <div id="AORNet.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORNet.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix $U$.</p>
</div>


                            </div>
                            <div id="AORNet.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORNet.H"></a>
    
            <div class="docstring"><p>Matrix $H$.</p>
</div>


                            </div>
                            <div id="AORNet.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORNet.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="AORNet.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#AORNet.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="AORNet.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#AORNet.y"></a>
    
            <div class="docstring"><p>Solution of the linear equation.</p>
</div>


                            </div>
                            <div id="AORNet.forward" class="classattr">
                                        <input id="AORNet.forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">forward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="AORNet.forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AORNet.forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AORNet.forward-377"><a href="#AORNet.forward-377"><span class="linenos">377</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]:</span>
</span><span id="AORNet.forward-378"><a href="#AORNet.forward-378"><span class="linenos">378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform forward pass of the AORNet model.</span>
</span><span id="AORNet.forward-379"><a href="#AORNet.forward-379"><span class="linenos">379</span></a>
</span><span id="AORNet.forward-380"><a href="#AORNet.forward-380"><span class="linenos">380</span></a><span class="sd">        Args:</span>
</span><span id="AORNet.forward-381"><a href="#AORNet.forward-381"><span class="linenos">381</span></a><span class="sd">          num_itr: Number of iterations.</span>
</span><span id="AORNet.forward-382"><a href="#AORNet.forward-382"><span class="linenos">382</span></a>
</span><span id="AORNet.forward-383"><a href="#AORNet.forward-383"><span class="linenos">383</span></a><span class="sd">        Returns:</span>
</span><span id="AORNet.forward-384"><a href="#AORNet.forward-384"><span class="linenos">384</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="AORNet.forward-385"><a href="#AORNet.forward-385"><span class="linenos">385</span></a><span class="sd">          - Output tensor.</span>
</span><span id="AORNet.forward-386"><a href="#AORNet.forward-386"><span class="linenos">386</span></a><span class="sd">          - List of intermediate results.</span>
</span><span id="AORNet.forward-387"><a href="#AORNet.forward-387"><span class="linenos">387</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AORNet.forward-388"><a href="#AORNet.forward-388"><span class="linenos">388</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AORNet.forward-389"><a href="#AORNet.forward-389"><span class="linenos">389</span></a>
</span><span id="AORNet.forward-390"><a href="#AORNet.forward-390"><span class="linenos">390</span></a>        <span class="n">m_inv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
</span><span id="AORNet.forward-391"><a href="#AORNet.forward-391"><span class="linenos">391</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AORNet.forward-392"><a href="#AORNet.forward-392"><span class="linenos">392</span></a>            <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span>
</span><span id="AORNet.forward-393"><a href="#AORNet.forward-393"><span class="linenos">393</span></a>            <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span>
</span><span id="AORNet.forward-394"><a href="#AORNet.forward-394"><span class="linenos">394</span></a>            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span>
</span><span id="AORNet.forward-395"><a href="#AORNet.forward-395"><span class="linenos">395</span></a>        <span class="p">)</span>
</span><span id="AORNet.forward-396"><a href="#AORNet.forward-396"><span class="linenos">396</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="AORNet.forward-397"><a href="#AORNet.forward-397"><span class="linenos">397</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span>
</span><span id="AORNet.forward-398"><a href="#AORNet.forward-398"><span class="linenos">398</span></a>        <span class="p">)</span>  <span class="c1"># change to size(0)</span>
</span><span id="AORNet.forward-399"><a href="#AORNet.forward-399"><span class="linenos">399</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="AORNet.forward-400"><a href="#AORNet.forward-400"><span class="linenos">400</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="AORNet.forward-401"><a href="#AORNet.forward-401"><span class="linenos">401</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="AORNet.forward-402"><a href="#AORNet.forward-402"><span class="linenos">402</span></a>
</span><span id="AORNet.forward-403"><a href="#AORNet.forward-403"><span class="linenos">403</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="AORNet.forward-404"><a href="#AORNet.forward-404"><span class="linenos">404</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv</span><span class="p">)</span>
</span><span id="AORNet.forward-405"><a href="#AORNet.forward-405"><span class="linenos">405</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="AORNet.forward-406"><a href="#AORNet.forward-406"><span class="linenos">406</span></a>
</span><span id="AORNet.forward-407"><a href="#AORNet.forward-407"><span class="linenos">407</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Perform forward pass of the AORNet model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  Number of iterations.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>Output tensor.</li>
  <li>List of intermediate results.</li>
  </ul>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>torch.nn.modules.module.Module</dt>
                                <dd id="AORNet.dump_patches" class="variable">dump_patches</dd>
                <dd id="AORNet.training" class="variable">training</dd>
                <dd id="AORNet.call_super_init" class="variable">call_super_init</dd>
                <dd id="AORNet.register_buffer" class="function">register_buffer</dd>
                <dd id="AORNet.register_parameter" class="function">register_parameter</dd>
                <dd id="AORNet.add_module" class="function">add_module</dd>
                <dd id="AORNet.register_module" class="function">register_module</dd>
                <dd id="AORNet.get_submodule" class="function">get_submodule</dd>
                <dd id="AORNet.get_parameter" class="function">get_parameter</dd>
                <dd id="AORNet.get_buffer" class="function">get_buffer</dd>
                <dd id="AORNet.get_extra_state" class="function">get_extra_state</dd>
                <dd id="AORNet.set_extra_state" class="function">set_extra_state</dd>
                <dd id="AORNet.apply" class="function">apply</dd>
                <dd id="AORNet.cuda" class="function">cuda</dd>
                <dd id="AORNet.ipu" class="function">ipu</dd>
                <dd id="AORNet.xpu" class="function">xpu</dd>
                <dd id="AORNet.cpu" class="function">cpu</dd>
                <dd id="AORNet.type" class="function">type</dd>
                <dd id="AORNet.float" class="function">float</dd>
                <dd id="AORNet.double" class="function">double</dd>
                <dd id="AORNet.half" class="function">half</dd>
                <dd id="AORNet.bfloat16" class="function">bfloat16</dd>
                <dd id="AORNet.to_empty" class="function">to_empty</dd>
                <dd id="AORNet.to" class="function">to</dd>
                <dd id="AORNet.register_full_backward_pre_hook" class="function">register_full_backward_pre_hook</dd>
                <dd id="AORNet.register_backward_hook" class="function">register_backward_hook</dd>
                <dd id="AORNet.register_full_backward_hook" class="function">register_full_backward_hook</dd>
                <dd id="AORNet.register_forward_pre_hook" class="function">register_forward_pre_hook</dd>
                <dd id="AORNet.register_forward_hook" class="function">register_forward_hook</dd>
                <dd id="AORNet.register_state_dict_pre_hook" class="function">register_state_dict_pre_hook</dd>
                <dd id="AORNet.state_dict" class="function">state_dict</dd>
                <dd id="AORNet.register_load_state_dict_post_hook" class="function">register_load_state_dict_post_hook</dd>
                <dd id="AORNet.load_state_dict" class="function">load_state_dict</dd>
                <dd id="AORNet.parameters" class="function">parameters</dd>
                <dd id="AORNet.named_parameters" class="function">named_parameters</dd>
                <dd id="AORNet.buffers" class="function">buffers</dd>
                <dd id="AORNet.named_buffers" class="function">named_buffers</dd>
                <dd id="AORNet.children" class="function">children</dd>
                <dd id="AORNet.named_children" class="function">named_children</dd>
                <dd id="AORNet.modules" class="function">modules</dd>
                <dd id="AORNet.named_modules" class="function">named_modules</dd>
                <dd id="AORNet.train" class="function">train</dd>
                <dd id="AORNet.eval" class="function">eval</dd>
                <dd id="AORNet.requires_grad_" class="function">requires_grad_</dd>
                <dd id="AORNet.zero_grad" class="function">zero_grad</dd>
                <dd id="AORNet.share_memory" class="function">share_memory</dd>
                <dd id="AORNet.extra_repr" class="function">extra_repr</dd>
                <dd id="AORNet.compile" class="function">compile</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="BaseModel">
                            <input id="BaseModel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">BaseModel</span>:

                <label class="view-source-button" for="BaseModel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseModel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseModel-52"><a href="#BaseModel-52"><span class="linenos"> 52</span></a><span class="k">class</span> <span class="nc">BaseModel</span><span class="p">:</span>
</span><span id="BaseModel-53"><a href="#BaseModel-53"><span class="linenos"> 53</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Base model class for matrix decomposition and initialization.&quot;&quot;&quot;</span>
</span><span id="BaseModel-54"><a href="#BaseModel-54"><span class="linenos"> 54</span></a>
</span><span id="BaseModel-55"><a href="#BaseModel-55"><span class="linenos"> 55</span></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="BaseModel-56"><a href="#BaseModel-56"><span class="linenos"> 56</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimension of the solution.&quot;&quot;&quot;</span>
</span><span id="BaseModel-57"><a href="#BaseModel-57"><span class="linenos"> 57</span></a>
</span><span id="BaseModel-58"><a href="#BaseModel-58"><span class="linenos"> 58</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="BaseModel-59"><a href="#BaseModel-59"><span class="linenos"> 59</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random matrix $H$.&quot;&quot;&quot;</span>
</span><span id="BaseModel-60"><a href="#BaseModel-60"><span class="linenos"> 60</span></a>
</span><span id="BaseModel-61"><a href="#BaseModel-61"><span class="linenos"> 61</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="BaseModel-62"><a href="#BaseModel-62"><span class="linenos"> 62</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="BaseModel-63"><a href="#BaseModel-63"><span class="linenos"> 63</span></a>
</span><span id="BaseModel-64"><a href="#BaseModel-64"><span class="linenos"> 64</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="BaseModel-65"><a href="#BaseModel-65"><span class="linenos"> 65</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution tensor.&quot;&quot;&quot;</span>
</span><span id="BaseModel-66"><a href="#BaseModel-66"><span class="linenos"> 66</span></a>
</span><span id="BaseModel-67"><a href="#BaseModel-67"><span class="linenos"> 67</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="BaseModel-68"><a href="#BaseModel-68"><span class="linenos"> 68</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Original matrix converted to a torch tensor.&quot;&quot;&quot;</span>
</span><span id="BaseModel-69"><a href="#BaseModel-69"><span class="linenos"> 69</span></a>
</span><span id="BaseModel-70"><a href="#BaseModel-70"><span class="linenos"> 70</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="BaseModel-71"><a href="#BaseModel-71"><span class="linenos"> 71</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="BaseModel-72"><a href="#BaseModel-72"><span class="linenos"> 72</span></a>
</span><span id="BaseModel-73"><a href="#BaseModel-73"><span class="linenos"> 73</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="BaseModel-74"><a href="#BaseModel-74"><span class="linenos"> 74</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="BaseModel-75"><a href="#BaseModel-75"><span class="linenos"> 75</span></a>
</span><span id="BaseModel-76"><a href="#BaseModel-76"><span class="linenos"> 76</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="BaseModel-77"><a href="#BaseModel-77"><span class="linenos"> 77</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="BaseModel-78"><a href="#BaseModel-78"><span class="linenos"> 78</span></a>
</span><span id="BaseModel-79"><a href="#BaseModel-79"><span class="linenos"> 79</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="BaseModel-80"><a href="#BaseModel-80"><span class="linenos"> 80</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="BaseModel-81"><a href="#BaseModel-81"><span class="linenos"> 81</span></a>
</span><span id="BaseModel-82"><a href="#BaseModel-82"><span class="linenos"> 82</span></a>    <span class="n">Minv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="BaseModel-83"><a href="#BaseModel-83"><span class="linenos"> 83</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the matrix $D + L$.&quot;&quot;&quot;</span>
</span><span id="BaseModel-84"><a href="#BaseModel-84"><span class="linenos"> 84</span></a>
</span><span id="BaseModel-85"><a href="#BaseModel-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">):</span>
</span><span id="BaseModel-86"><a href="#BaseModel-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the base_model with the given parameters and decompose matrix $A$.</span>
</span><span id="BaseModel-87"><a href="#BaseModel-87"><span class="linenos"> 87</span></a>
</span><span id="BaseModel-88"><a href="#BaseModel-88"><span class="linenos"> 88</span></a><span class="sd">        Args:</span>
</span><span id="BaseModel-89"><a href="#BaseModel-89"><span class="linenos"> 89</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="BaseModel-90"><a href="#BaseModel-90"><span class="linenos"> 90</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="BaseModel-91"><a href="#BaseModel-91"><span class="linenos"> 91</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="BaseModel-92"><a href="#BaseModel-92"><span class="linenos"> 92</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="BaseModel-93"><a href="#BaseModel-93"><span class="linenos"> 93</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="BaseModel-94"><a href="#BaseModel-94"><span class="linenos"> 94</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseModel-95"><a href="#BaseModel-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="BaseModel-96"><a href="#BaseModel-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">h</span>
</span><span id="BaseModel-97"><a href="#BaseModel-97"><span class="linenos"> 97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span>
</span><span id="BaseModel-98"><a href="#BaseModel-98"><span class="linenos"> 98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="BaseModel-99"><a href="#BaseModel-99"><span class="linenos"> 99</span></a>
</span><span id="BaseModel-100"><a href="#BaseModel-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Minv</span> <span class="o">=</span> <span class="n">decompose_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Base model class for matrix decomposition and initialization.</p>
</div>


                            <div id="BaseModel.__init__" class="classattr">
                                        <input id="BaseModel.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">BaseModel</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">+</span><span class="n">_ScalarType_co</span><span class="p">]]</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span></span>)</span>

                <label class="view-source-button" for="BaseModel.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseModel.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseModel.__init__-85"><a href="#BaseModel.__init__-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">):</span>
</span><span id="BaseModel.__init__-86"><a href="#BaseModel.__init__-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the base_model with the given parameters and decompose matrix $A$.</span>
</span><span id="BaseModel.__init__-87"><a href="#BaseModel.__init__-87"><span class="linenos"> 87</span></a>
</span><span id="BaseModel.__init__-88"><a href="#BaseModel.__init__-88"><span class="linenos"> 88</span></a><span class="sd">        Args:</span>
</span><span id="BaseModel.__init__-89"><a href="#BaseModel.__init__-89"><span class="linenos"> 89</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="BaseModel.__init__-90"><a href="#BaseModel.__init__-90"><span class="linenos"> 90</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="BaseModel.__init__-91"><a href="#BaseModel.__init__-91"><span class="linenos"> 91</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="BaseModel.__init__-92"><a href="#BaseModel.__init__-92"><span class="linenos"> 92</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="BaseModel.__init__-93"><a href="#BaseModel.__init__-93"><span class="linenos"> 93</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="BaseModel.__init__-94"><a href="#BaseModel.__init__-94"><span class="linenos"> 94</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseModel.__init__-95"><a href="#BaseModel.__init__-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="BaseModel.__init__-96"><a href="#BaseModel.__init__-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">h</span>
</span><span id="BaseModel.__init__-97"><a href="#BaseModel.__init__-97"><span class="linenos"> 97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span>
</span><span id="BaseModel.__init__-98"><a href="#BaseModel.__init__-98"><span class="linenos"> 98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="BaseModel.__init__-99"><a href="#BaseModel.__init__-99"><span class="linenos"> 99</span></a>
</span><span id="BaseModel.__init__-100"><a href="#BaseModel.__init__-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Minv</span> <span class="o">=</span> <span class="n">decompose_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the base_model with the given parameters and decompose matrix $A$.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n:</strong>  Dimension of the solution.</li>
<li><strong>a:</strong>  Input square matrix to decompose.</li>
<li><strong>h:</strong>  Random matrix $H$.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution tensor.</li>
</ul>
</div>


                            </div>
                            <div id="BaseModel.n" class="classattr">
                                <div class="attr variable">
            <span class="name">n</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#BaseModel.n"></a>
    
            <div class="docstring"><p>Dimension of the solution.</p>
</div>


                            </div>
                            <div id="BaseModel.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#BaseModel.H"></a>
    
            <div class="docstring"><p>Random matrix $H$.</p>
</div>


                            </div>
                            <div id="BaseModel.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#BaseModel.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="BaseModel.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#BaseModel.y"></a>
    
            <div class="docstring"><p>Solution tensor.</p>
</div>


                            </div>
                            <div id="BaseModel.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#BaseModel.A"></a>
    
            <div class="docstring"><p>Original matrix converted to a torch tensor.</p>
</div>


                            </div>
                            <div id="BaseModel.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#BaseModel.D"></a>
    
            <div class="docstring"><p>Diagonal matrix of $A$.</p>
</div>


                            </div>
                            <div id="BaseModel.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#BaseModel.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="BaseModel.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#BaseModel.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="BaseModel.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#BaseModel.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="BaseModel.Minv" class="classattr">
                                <div class="attr variable">
            <span class="name">Minv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#BaseModel.Minv"></a>
    
            <div class="docstring"><p>Inverse of the matrix $D + L$.</p>
</div>


                            </div>
                </section>
                <section id="decompose_matrix">
                            <input id="decompose_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">decompose_matrix</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">+</span><span class="n">_ScalarType_co</span><span class="p">]]</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="decompose_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#decompose_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="decompose_matrix-68"><a href="#decompose_matrix-68"><span class="linenos"> 68</span></a><span class="k">def</span> <span class="nf">decompose_matrix</span><span class="p">(</span>
</span><span id="decompose_matrix-69"><a href="#decompose_matrix-69"><span class="linenos"> 69</span></a>    <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">|</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="decompose_matrix-70"><a href="#decompose_matrix-70"><span class="linenos"> 70</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]:</span>
</span><span id="decompose_matrix-71"><a href="#decompose_matrix-71"><span class="linenos"> 71</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Decompose a given matrix into its diagonal, lower triangular, upper</span>
</span><span id="decompose_matrix-72"><a href="#decompose_matrix-72"><span class="linenos"> 72</span></a><span class="sd">    triangular components and their inverses.</span>
</span><span id="decompose_matrix-73"><a href="#decompose_matrix-73"><span class="linenos"> 73</span></a>
</span><span id="decompose_matrix-74"><a href="#decompose_matrix-74"><span class="linenos"> 74</span></a><span class="sd">    Args:</span>
</span><span id="decompose_matrix-75"><a href="#decompose_matrix-75"><span class="linenos"> 75</span></a><span class="sd">      a: Input square matrix to decompose.</span>
</span><span id="decompose_matrix-76"><a href="#decompose_matrix-76"><span class="linenos"> 76</span></a>
</span><span id="decompose_matrix-77"><a href="#decompose_matrix-77"><span class="linenos"> 77</span></a><span class="sd">    Returns:</span>
</span><span id="decompose_matrix-78"><a href="#decompose_matrix-78"><span class="linenos"> 78</span></a><span class="sd">      A tuple with the following contents:</span>
</span><span id="decompose_matrix-79"><a href="#decompose_matrix-79"><span class="linenos"> 79</span></a><span class="sd">        - $A$: Original matrix converted to a torch tensor.</span>
</span><span id="decompose_matrix-80"><a href="#decompose_matrix-80"><span class="linenos"> 80</span></a><span class="sd">        - $D$: Diagonal matrix of $A$.</span>
</span><span id="decompose_matrix-81"><a href="#decompose_matrix-81"><span class="linenos"> 81</span></a><span class="sd">        - $L$: Lower triangular matrix of $A$.</span>
</span><span id="decompose_matrix-82"><a href="#decompose_matrix-82"><span class="linenos"> 82</span></a><span class="sd">        - $U$: Upper triangular matrix of $A$.</span>
</span><span id="decompose_matrix-83"><a href="#decompose_matrix-83"><span class="linenos"> 83</span></a><span class="sd">        - $D^{-1}$: Inverse of the diagonal matrix $D$.</span>
</span><span id="decompose_matrix-84"><a href="#decompose_matrix-84"><span class="linenos"> 84</span></a><span class="sd">        - $M^{-1}$: Inverse of the matrix $D + L$.</span>
</span><span id="decompose_matrix-85"><a href="#decompose_matrix-85"><span class="linenos"> 85</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="decompose_matrix-86"><a href="#decompose_matrix-86"><span class="linenos"> 86</span></a>    <span class="c1"># Decomposed matrix calculations</span>
</span><span id="decompose_matrix-87"><a href="#decompose_matrix-87"><span class="linenos"> 87</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>  <span class="c1"># Diagonal matrix</span>
</span><span id="decompose_matrix-88"><a href="#decompose_matrix-88"><span class="linenos"> 88</span></a>    <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Lower triangular matrix</span>
</span><span id="decompose_matrix-89"><a href="#decompose_matrix-89"><span class="linenos"> 89</span></a>    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Upper triangular matrix</span>
</span><span id="decompose_matrix-90"><a href="#decompose_matrix-90"><span class="linenos"> 90</span></a>    <span class="n">d_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># Inverse of the diagonal matrix</span>
</span><span id="decompose_matrix-91"><a href="#decompose_matrix-91"><span class="linenos"> 91</span></a>    <span class="n">m_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="n">l</span><span class="p">)</span>  <span class="c1"># Inverse of the matrix (D + L)</span>
</span><span id="decompose_matrix-92"><a href="#decompose_matrix-92"><span class="linenos"> 92</span></a>
</span><span id="decompose_matrix-93"><a href="#decompose_matrix-93"><span class="linenos"> 93</span></a>    <span class="c1"># Convert to Torch tensors and move to device</span>
</span><span id="decompose_matrix-94"><a href="#decompose_matrix-94"><span class="linenos"> 94</span></a>    <span class="n">at</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="decompose_matrix-95"><a href="#decompose_matrix-95"><span class="linenos"> 95</span></a>    <span class="n">dt</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="decompose_matrix-96"><a href="#decompose_matrix-96"><span class="linenos"> 96</span></a>    <span class="n">lt</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="decompose_matrix-97"><a href="#decompose_matrix-97"><span class="linenos"> 97</span></a>    <span class="n">ut</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="decompose_matrix-98"><a href="#decompose_matrix-98"><span class="linenos"> 98</span></a>    <span class="n">dt_inv</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">d_inv</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="decompose_matrix-99"><a href="#decompose_matrix-99"><span class="linenos"> 99</span></a>    <span class="n">mt_inv</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">m_inv</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="decompose_matrix-100"><a href="#decompose_matrix-100"><span class="linenos">100</span></a>
</span><span id="decompose_matrix-101"><a href="#decompose_matrix-101"><span class="linenos">101</span></a>    <span class="k">return</span> <span class="n">at</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">lt</span><span class="p">,</span> <span class="n">ut</span><span class="p">,</span> <span class="n">dt_inv</span><span class="p">,</span> <span class="n">mt_inv</span>
</span></pre></div>


            <div class="docstring"><p>Decompose a given matrix into its diagonal, lower triangular, upper
triangular components and their inverses.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>a:</strong>  Input square matrix to decompose.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>$A$: Original matrix converted to a torch tensor.</li>
  <li>$D$: Diagonal matrix of $A$.</li>
  <li>$L$: Lower triangular matrix of $A$.</li>
  <li>$U$: Upper triangular matrix of $A$.</li>
  <li>$D^{-1}$: Inverse of the diagonal matrix $D$.</li>
  <li>$M^{-1}$: Inverse of the matrix $D + L$.</li>
  </ul>
</blockquote>
</div>


                </section>
                <section id="device">
                    <div class="attr variable">
            <span class="name">device</span>        =
<span class="default_value">device(type=&#39;cpu&#39;)</span>

        
    </div>
    <a class="headerlink" href="#device"></a>
    
    

                </section>
                <section id="evaluate_model">
                            <input id="evaluate_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">evaluate_model</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">model</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">Module</span>,</span><span class="param">	<span class="n">solution</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span>,</span><span class="param">	<span class="n">total_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span>,</span><span class="param">	<span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="evaluate_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#evaluate_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="evaluate_model-51"><a href="#evaluate_model-51"><span class="linenos">51</span></a><span class="k">def</span> <span class="nf">evaluate_model</span><span class="p">(</span>
</span><span id="evaluate_model-52"><a href="#evaluate_model-52"><span class="linenos">52</span></a>    <span class="n">model</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
</span><span id="evaluate_model-53"><a href="#evaluate_model-53"><span class="linenos">53</span></a>    <span class="n">solution</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="evaluate_model-54"><a href="#evaluate_model-54"><span class="linenos">54</span></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="evaluate_model-55"><a href="#evaluate_model-55"><span class="linenos">55</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
</span><span id="evaluate_model-56"><a href="#evaluate_model-56"><span class="linenos">56</span></a>    <span class="n">total_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
</span><span id="evaluate_model-57"><a href="#evaluate_model-57"><span class="linenos">57</span></a>    <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">,</span>
</span><span id="evaluate_model-58"><a href="#evaluate_model-58"><span class="linenos">58</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="evaluate_model-59"><a href="#evaluate_model-59"><span class="linenos">59</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate the model by calculating the mean squared error (MSE) between</span>
</span><span id="evaluate_model-60"><a href="#evaluate_model-60"><span class="linenos">60</span></a><span class="sd">      the solution and the model&#39;s predictions.</span>
</span><span id="evaluate_model-61"><a href="#evaluate_model-61"><span class="linenos">61</span></a>
</span><span id="evaluate_model-62"><a href="#evaluate_model-62"><span class="linenos">62</span></a><span class="sd">    Args:</span>
</span><span id="evaluate_model-63"><a href="#evaluate_model-63"><span class="linenos">63</span></a><span class="sd">      model: The model to be evaluated.</span>
</span><span id="evaluate_model-64"><a href="#evaluate_model-64"><span class="linenos">64</span></a><span class="sd">      solution: The target solution tensor.</span>
</span><span id="evaluate_model-65"><a href="#evaluate_model-65"><span class="linenos">65</span></a><span class="sd">      n: The dimension of the solution.</span>
</span><span id="evaluate_model-66"><a href="#evaluate_model-66"><span class="linenos">66</span></a><span class="sd">      bs: The batch size.</span>
</span><span id="evaluate_model-67"><a href="#evaluate_model-67"><span class="linenos">67</span></a><span class="sd">      total_itr: The total number of iterations for evaluation.</span>
</span><span id="evaluate_model-68"><a href="#evaluate_model-68"><span class="linenos">68</span></a><span class="sd">      device: The device to run the evaluation on.</span>
</span><span id="evaluate_model-69"><a href="#evaluate_model-69"><span class="linenos">69</span></a>
</span><span id="evaluate_model-70"><a href="#evaluate_model-70"><span class="linenos">70</span></a><span class="sd">    Returns:</span>
</span><span id="evaluate_model-71"><a href="#evaluate_model-71"><span class="linenos">71</span></a><span class="sd">      A list of MSE values for each iteration.</span>
</span><span id="evaluate_model-72"><a href="#evaluate_model-72"><span class="linenos">72</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="evaluate_model-73"><a href="#evaluate_model-73"><span class="linenos">73</span></a>    <span class="n">norm_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="evaluate_model-74"><a href="#evaluate_model-74"><span class="linenos">74</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_itr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="evaluate_model-75"><a href="#evaluate_model-75"><span class="linenos">75</span></a>        <span class="n">s_hat</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="evaluate_model-76"><a href="#evaluate_model-76"><span class="linenos">76</span></a>        <span class="n">err</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">-</span> <span class="n">s_hat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="evaluate_model-77"><a href="#evaluate_model-77"><span class="linenos">77</span></a>            <span class="n">n</span> <span class="o">*</span> <span class="n">bs</span>
</span><span id="evaluate_model-78"><a href="#evaluate_model-78"><span class="linenos">78</span></a>        <span class="p">)</span>
</span><span id="evaluate_model-79"><a href="#evaluate_model-79"><span class="linenos">79</span></a>        <span class="n">norm_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
</span><span id="evaluate_model-80"><a href="#evaluate_model-80"><span class="linenos">80</span></a>    <span class="k">return</span> <span class="n">norm_list</span>
</span></pre></div>


            <div class="docstring"><p>Evaluate the model by calculating the mean squared error (MSE) between
  the solution and the model's predictions.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model:</strong>  The model to be evaluated.</li>
<li><strong>solution:</strong>  The target solution tensor.</li>
<li><strong>n:</strong>  The dimension of the solution.</li>
<li><strong>bs:</strong>  The batch size.</li>
<li><strong>total_itr:</strong>  The total number of iterations for evaluation.</li>
<li><strong>device:</strong>  The device to run the evaluation on.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A list of MSE values for each iteration.</p>
</blockquote>
</div>


                </section>
                <section id="generate_A_H_sol">
                            <input id="generate_A_H_sol-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_A_H_sol</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span>,</span><span class="param">	<span class="n">m</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">600</span>,</span><span class="param">	<span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">+</span><span class="n">_ScalarType_co</span><span class="p">]],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="generate_A_H_sol-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_A_H_sol"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_A_H_sol-23"><a href="#generate_A_H_sol-23"><span class="linenos">23</span></a><span class="k">def</span> <span class="nf">generate_A_H_sol</span><span class="p">(</span>
</span><span id="generate_A_H_sol-24"><a href="#generate_A_H_sol-24"><span class="linenos">24</span></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
</span><span id="generate_A_H_sol-25"><a href="#generate_A_H_sol-25"><span class="linenos">25</span></a>    <span class="n">m</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span>
</span><span id="generate_A_H_sol-26"><a href="#generate_A_H_sol-26"><span class="linenos">26</span></a>    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
</span><span id="generate_A_H_sol-27"><a href="#generate_A_H_sol-27"><span class="linenos">27</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="generate_A_H_sol-28"><a href="#generate_A_H_sol-28"><span class="linenos">28</span></a>    <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">,</span>
</span><span id="generate_A_H_sol-29"><a href="#generate_A_H_sol-29"><span class="linenos">29</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]:</span>
</span><span id="generate_A_H_sol-30"><a href="#generate_A_H_sol-30"><span class="linenos">30</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate matrices $A$, $H$, and $W$, as well as the solution and $y$.</span>
</span><span id="generate_A_H_sol-31"><a href="#generate_A_H_sol-31"><span class="linenos">31</span></a>
</span><span id="generate_A_H_sol-32"><a href="#generate_A_H_sol-32"><span class="linenos">32</span></a><span class="sd">    Args:</span>
</span><span id="generate_A_H_sol-33"><a href="#generate_A_H_sol-33"><span class="linenos">33</span></a><span class="sd">      n: Number of rows.</span>
</span><span id="generate_A_H_sol-34"><a href="#generate_A_H_sol-34"><span class="linenos">34</span></a><span class="sd">      m: Number of columns.</span>
</span><span id="generate_A_H_sol-35"><a href="#generate_A_H_sol-35"><span class="linenos">35</span></a><span class="sd">      seed: Seed for random number generation.</span>
</span><span id="generate_A_H_sol-36"><a href="#generate_A_H_sol-36"><span class="linenos">36</span></a><span class="sd">      bs: Batch size.</span>
</span><span id="generate_A_H_sol-37"><a href="#generate_A_H_sol-37"><span class="linenos">37</span></a><span class="sd">      device: Device to run the computations on.</span>
</span><span id="generate_A_H_sol-38"><a href="#generate_A_H_sol-38"><span class="linenos">38</span></a>
</span><span id="generate_A_H_sol-39"><a href="#generate_A_H_sol-39"><span class="linenos">39</span></a><span class="sd">    Returns:</span>
</span><span id="generate_A_H_sol-40"><a href="#generate_A_H_sol-40"><span class="linenos">40</span></a><span class="sd">      A tuple with the following contents:</span>
</span><span id="generate_A_H_sol-41"><a href="#generate_A_H_sol-41"><span class="linenos">41</span></a><span class="sd">        - Matrix $A$ (square matrix) of shape (`n`, `n`)</span>
</span><span id="generate_A_H_sol-42"><a href="#generate_A_H_sol-42"><span class="linenos">42</span></a><span class="sd">        - Matrix $H$ (random matrix) of shape (`n`, `m`)</span>
</span><span id="generate_A_H_sol-43"><a href="#generate_A_H_sol-43"><span class="linenos">43</span></a><span class="sd">        - Matrix $W$ with diagonal eigenvalues of $A$ of shape (`n`, `n`)</span>
</span><span id="generate_A_H_sol-44"><a href="#generate_A_H_sol-44"><span class="linenos">44</span></a><span class="sd">        - Solution tensor of shape (`bs`, `n`)</span>
</span><span id="generate_A_H_sol-45"><a href="#generate_A_H_sol-45"><span class="linenos">45</span></a><span class="sd">        - Tensor $y$ resulting from `solution @ H` of shape (`bs`, `m`)</span>
</span><span id="generate_A_H_sol-46"><a href="#generate_A_H_sol-46"><span class="linenos">46</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="generate_A_H_sol-47"><a href="#generate_A_H_sol-47"><span class="linenos">47</span></a>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</span><span id="generate_A_H_sol-48"><a href="#generate_A_H_sol-48"><span class="linenos">48</span></a>    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
</span><span id="generate_A_H_sol-49"><a href="#generate_A_H_sol-49"><span class="linenos">49</span></a>    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="generate_A_H_sol-50"><a href="#generate_A_H_sol-50"><span class="linenos">50</span></a>    <span class="n">eig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Eigenvalues</span>
</span><span id="generate_A_H_sol-51"><a href="#generate_A_H_sol-51"><span class="linenos">51</span></a>
</span><span id="generate_A_H_sol-52"><a href="#generate_A_H_sol-52"><span class="linenos">52</span></a>    <span class="n">wt</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">eig</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># Define the appropriate &#39;device&#39;</span>
</span><span id="generate_A_H_sol-53"><a href="#generate_A_H_sol-53"><span class="linenos">53</span></a>    <span class="n">ht</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># Define the appropriate &#39;device&#39;</span>
</span><span id="generate_A_H_sol-54"><a href="#generate_A_H_sol-54"><span class="linenos">54</span></a>
</span><span id="generate_A_H_sol-55"><a href="#generate_A_H_sol-55"><span class="linenos">55</span></a>    <span class="nb">print</span><span class="p">(</span>
</span><span id="generate_A_H_sol-56"><a href="#generate_A_H_sol-56"><span class="linenos">56</span></a>        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="generate_A_H_sol-57"><a href="#generate_A_H_sol-57"><span class="linenos">57</span></a><span class="s2">    - Condition number of A: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">eig</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">eig</span><span class="p">)</span><span class="si">}</span>
</span><span id="generate_A_H_sol-58"><a href="#generate_A_H_sol-58"><span class="linenos">58</span></a><span class="s2">    - Min eigenvalue of A: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">eig</span><span class="p">)</span><span class="si">}</span>
</span><span id="generate_A_H_sol-59"><a href="#generate_A_H_sol-59"><span class="linenos">59</span></a><span class="s2">    - Max eigenvalue of A: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">eig</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="generate_A_H_sol-60"><a href="#generate_A_H_sol-60"><span class="linenos">60</span></a>    <span class="p">)</span>
</span><span id="generate_A_H_sol-61"><a href="#generate_A_H_sol-61"><span class="linenos">61</span></a>
</span><span id="generate_A_H_sol-62"><a href="#generate_A_H_sol-62"><span class="linenos">62</span></a>    <span class="n">solution</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
</span><span id="generate_A_H_sol-63"><a href="#generate_A_H_sol-63"><span class="linenos">63</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">solution</span> <span class="o">@</span> <span class="n">ht</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
</span><span id="generate_A_H_sol-64"><a href="#generate_A_H_sol-64"><span class="linenos">64</span></a>
</span><span id="generate_A_H_sol-65"><a href="#generate_A_H_sol-65"><span class="linenos">65</span></a>    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">ht</span><span class="p">,</span> <span class="n">wt</span><span class="p">,</span> <span class="n">solution</span><span class="p">,</span> <span class="n">y</span>
</span></pre></div>


            <div class="docstring"><p>Generate matrices $A$, $H$, and $W$, as well as the solution and $y$.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n:</strong>  Number of rows.</li>
<li><strong>m:</strong>  Number of columns.</li>
<li><strong>seed:</strong>  Seed for random number generation.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>device:</strong>  Device to run the computations on.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>Matrix $A$ (square matrix) of shape (<code>n</code>, <code>n</code>)</li>
  <li>Matrix $H$ (random matrix) of shape (<code>n</code>, <code>m</code>)</li>
  <li>Matrix $W$ with diagonal eigenvalues of $A$ of shape (<code>n</code>, <code>n</code>)</li>
  <li>Solution tensor of shape (<code>bs</code>, <code>n</code>)</li>
  <li>Tensor $y$ resulting from <code>solution @ H</code> of shape (<code>bs</code>, <code>m</code>)</li>
  </ul>
</blockquote>
</div>


                </section>
                <section id="GS">
                            <input id="GS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">GS</span><wbr>(<span class="base"><a href="#BaseModel">deep_unfolding.BaseModel</a></span>):

                <label class="view-source-button" for="GS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GS-103"><a href="#GS-103"><span class="linenos">103</span></a><span class="k">class</span> <span class="nc">GS</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="GS-104"><a href="#GS-104"><span class="linenos">104</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class implementing the Gauss-Seidel algorithm for solving a linear system.&quot;&quot;&quot;</span>
</span><span id="GS-105"><a href="#GS-105"><span class="linenos">105</span></a>
</span><span id="GS-106"><a href="#GS-106"><span class="linenos">106</span></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="GS-107"><a href="#GS-107"><span class="linenos">107</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimension of the solution.&quot;&quot;&quot;</span>
</span><span id="GS-108"><a href="#GS-108"><span class="linenos">108</span></a>
</span><span id="GS-109"><a href="#GS-109"><span class="linenos">109</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="GS-110"><a href="#GS-110"><span class="linenos">110</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random matrix $H$.&quot;&quot;&quot;</span>
</span><span id="GS-111"><a href="#GS-111"><span class="linenos">111</span></a>
</span><span id="GS-112"><a href="#GS-112"><span class="linenos">112</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="GS-113"><a href="#GS-113"><span class="linenos">113</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="GS-114"><a href="#GS-114"><span class="linenos">114</span></a>
</span><span id="GS-115"><a href="#GS-115"><span class="linenos">115</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="GS-116"><a href="#GS-116"><span class="linenos">116</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution tensor.&quot;&quot;&quot;</span>
</span><span id="GS-117"><a href="#GS-117"><span class="linenos">117</span></a>
</span><span id="GS-118"><a href="#GS-118"><span class="linenos">118</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="GS-119"><a href="#GS-119"><span class="linenos">119</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Original matrix converted to a torch tensor.&quot;&quot;&quot;</span>
</span><span id="GS-120"><a href="#GS-120"><span class="linenos">120</span></a>
</span><span id="GS-121"><a href="#GS-121"><span class="linenos">121</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="GS-122"><a href="#GS-122"><span class="linenos">122</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="GS-123"><a href="#GS-123"><span class="linenos">123</span></a>
</span><span id="GS-124"><a href="#GS-124"><span class="linenos">124</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="GS-125"><a href="#GS-125"><span class="linenos">125</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="GS-126"><a href="#GS-126"><span class="linenos">126</span></a>
</span><span id="GS-127"><a href="#GS-127"><span class="linenos">127</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="GS-128"><a href="#GS-128"><span class="linenos">128</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="GS-129"><a href="#GS-129"><span class="linenos">129</span></a>
</span><span id="GS-130"><a href="#GS-130"><span class="linenos">130</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="GS-131"><a href="#GS-131"><span class="linenos">131</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="GS-132"><a href="#GS-132"><span class="linenos">132</span></a>
</span><span id="GS-133"><a href="#GS-133"><span class="linenos">133</span></a>    <span class="n">Minv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="GS-134"><a href="#GS-134"><span class="linenos">134</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the matrix $D + L$.&quot;&quot;&quot;</span>
</span><span id="GS-135"><a href="#GS-135"><span class="linenos">135</span></a>
</span><span id="GS-136"><a href="#GS-136"><span class="linenos">136</span></a>    <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="GS-137"><a href="#GS-137"><span class="linenos">137</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The number of Gauss-Seidel iterations to perform.&quot;&quot;&quot;</span>
</span><span id="GS-138"><a href="#GS-138"><span class="linenos">138</span></a>
</span><span id="GS-139"><a href="#GS-139"><span class="linenos">139</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">):</span>
</span><span id="GS-140"><a href="#GS-140"><span class="linenos">140</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Gauss-Seidel solver.</span>
</span><span id="GS-141"><a href="#GS-141"><span class="linenos">141</span></a>
</span><span id="GS-142"><a href="#GS-142"><span class="linenos">142</span></a><span class="sd">        Args:</span>
</span><span id="GS-143"><a href="#GS-143"><span class="linenos">143</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="GS-144"><a href="#GS-144"><span class="linenos">144</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="GS-145"><a href="#GS-145"><span class="linenos">145</span></a><span class="sd">          h: Random matrix H.</span>
</span><span id="GS-146"><a href="#GS-146"><span class="linenos">146</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="GS-147"><a href="#GS-147"><span class="linenos">147</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="GS-148"><a href="#GS-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GS-149"><a href="#GS-149"><span class="linenos">149</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">GS</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="GS-150"><a href="#GS-150"><span class="linenos">150</span></a>
</span><span id="GS-151"><a href="#GS-151"><span class="linenos">151</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="GS-152"><a href="#GS-152"><span class="linenos">152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the Gauss-Seidel iterations and returns the final solution</span>
</span><span id="GS-153"><a href="#GS-153"><span class="linenos">153</span></a><span class="sd">          and trajectory of solutions.</span>
</span><span id="GS-154"><a href="#GS-154"><span class="linenos">154</span></a>
</span><span id="GS-155"><a href="#GS-155"><span class="linenos">155</span></a><span class="sd">        Args:</span>
</span><span id="GS-156"><a href="#GS-156"><span class="linenos">156</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="GS-157"><a href="#GS-157"><span class="linenos">157</span></a>
</span><span id="GS-158"><a href="#GS-158"><span class="linenos">158</span></a><span class="sd">        Returns:</span>
</span><span id="GS-159"><a href="#GS-159"><span class="linenos">159</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="GS-160"><a href="#GS-160"><span class="linenos">160</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="GS-161"><a href="#GS-161"><span class="linenos">161</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="GS-162"><a href="#GS-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GS-163"><a href="#GS-163"><span class="linenos">163</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="GS-164"><a href="#GS-164"><span class="linenos">164</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="GS-165"><a href="#GS-165"><span class="linenos">165</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="GS-166"><a href="#GS-166"><span class="linenos">166</span></a>
</span><span id="GS-167"><a href="#GS-167"><span class="linenos">167</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># Assuming H is defined</span>
</span><span id="GS-168"><a href="#GS-168"><span class="linenos">168</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>  <span class="c1"># Generate batch initial solution vector</span>
</span><span id="GS-169"><a href="#GS-169"><span class="linenos">169</span></a>
</span><span id="GS-170"><a href="#GS-170"><span class="linenos">170</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="GS-171"><a href="#GS-171"><span class="linenos">171</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span> <span class="o">+</span> <span class="n">yMF</span>
</span><span id="GS-172"><a href="#GS-172"><span class="linenos">172</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Minv</span><span class="p">)</span>
</span><span id="GS-173"><a href="#GS-173"><span class="linenos">173</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="GS-174"><a href="#GS-174"><span class="linenos">174</span></a>
</span><span id="GS-175"><a href="#GS-175"><span class="linenos">175</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Class implementing the Gauss-Seidel algorithm for solving a linear system.</p>
</div>


                            <div id="GS.__init__" class="classattr">
                                        <input id="GS.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">GS</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">+</span><span class="n">_ScalarType_co</span><span class="p">]]</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span></span>)</span>

                <label class="view-source-button" for="GS.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GS.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GS.__init__-139"><a href="#GS.__init__-139"><span class="linenos">139</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">):</span>
</span><span id="GS.__init__-140"><a href="#GS.__init__-140"><span class="linenos">140</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Gauss-Seidel solver.</span>
</span><span id="GS.__init__-141"><a href="#GS.__init__-141"><span class="linenos">141</span></a>
</span><span id="GS.__init__-142"><a href="#GS.__init__-142"><span class="linenos">142</span></a><span class="sd">        Args:</span>
</span><span id="GS.__init__-143"><a href="#GS.__init__-143"><span class="linenos">143</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="GS.__init__-144"><a href="#GS.__init__-144"><span class="linenos">144</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="GS.__init__-145"><a href="#GS.__init__-145"><span class="linenos">145</span></a><span class="sd">          h: Random matrix H.</span>
</span><span id="GS.__init__-146"><a href="#GS.__init__-146"><span class="linenos">146</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="GS.__init__-147"><a href="#GS.__init__-147"><span class="linenos">147</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="GS.__init__-148"><a href="#GS.__init__-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GS.__init__-149"><a href="#GS.__init__-149"><span class="linenos">149</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">GS</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the Gauss-Seidel solver.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n:</strong>  Dimension of the solution.</li>
<li><strong>a:</strong>  Input square matrix to decompose.</li>
<li><strong>h:</strong>  Random matrix H.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution tensor.</li>
</ul>
</div>


                            </div>
                            <div id="GS.n" class="classattr">
                                <div class="attr variable">
            <span class="name">n</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#GS.n"></a>
    
            <div class="docstring"><p>Dimension of the solution.</p>
</div>


                            </div>
                            <div id="GS.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#GS.H"></a>
    
            <div class="docstring"><p>Random matrix $H$.</p>
</div>


                            </div>
                            <div id="GS.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#GS.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="GS.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#GS.y"></a>
    
            <div class="docstring"><p>Solution tensor.</p>
</div>


                            </div>
                            <div id="GS.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#GS.A"></a>
    
            <div class="docstring"><p>Original matrix converted to a torch tensor.</p>
</div>


                            </div>
                            <div id="GS.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#GS.D"></a>
    
            <div class="docstring"><p>Diagonal matrix of $A$.</p>
</div>


                            </div>
                            <div id="GS.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#GS.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="GS.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#GS.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="GS.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#GS.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="GS.Minv" class="classattr">
                                <div class="attr variable">
            <span class="name">Minv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#GS.Minv"></a>
    
            <div class="docstring"><p>Inverse of the matrix $D + L$.</p>
</div>


                            </div>
                            <div id="GS.num_itr" class="classattr">
                                <div class="attr variable">
            <span class="name">num_itr</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#GS.num_itr"></a>
    
            <div class="docstring"><p>The number of Gauss-Seidel iterations to perform.</p>
</div>


                            </div>
                            <div id="GS.iterate" class="classattr">
                                        <input id="GS.iterate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iterate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="GS.iterate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GS.iterate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GS.iterate-151"><a href="#GS.iterate-151"><span class="linenos">151</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="GS.iterate-152"><a href="#GS.iterate-152"><span class="linenos">152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the Gauss-Seidel iterations and returns the final solution</span>
</span><span id="GS.iterate-153"><a href="#GS.iterate-153"><span class="linenos">153</span></a><span class="sd">          and trajectory of solutions.</span>
</span><span id="GS.iterate-154"><a href="#GS.iterate-154"><span class="linenos">154</span></a>
</span><span id="GS.iterate-155"><a href="#GS.iterate-155"><span class="linenos">155</span></a><span class="sd">        Args:</span>
</span><span id="GS.iterate-156"><a href="#GS.iterate-156"><span class="linenos">156</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="GS.iterate-157"><a href="#GS.iterate-157"><span class="linenos">157</span></a>
</span><span id="GS.iterate-158"><a href="#GS.iterate-158"><span class="linenos">158</span></a><span class="sd">        Returns:</span>
</span><span id="GS.iterate-159"><a href="#GS.iterate-159"><span class="linenos">159</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="GS.iterate-160"><a href="#GS.iterate-160"><span class="linenos">160</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="GS.iterate-161"><a href="#GS.iterate-161"><span class="linenos">161</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="GS.iterate-162"><a href="#GS.iterate-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GS.iterate-163"><a href="#GS.iterate-163"><span class="linenos">163</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="GS.iterate-164"><a href="#GS.iterate-164"><span class="linenos">164</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="GS.iterate-165"><a href="#GS.iterate-165"><span class="linenos">165</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="GS.iterate-166"><a href="#GS.iterate-166"><span class="linenos">166</span></a>
</span><span id="GS.iterate-167"><a href="#GS.iterate-167"><span class="linenos">167</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># Assuming H is defined</span>
</span><span id="GS.iterate-168"><a href="#GS.iterate-168"><span class="linenos">168</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>  <span class="c1"># Generate batch initial solution vector</span>
</span><span id="GS.iterate-169"><a href="#GS.iterate-169"><span class="linenos">169</span></a>
</span><span id="GS.iterate-170"><a href="#GS.iterate-170"><span class="linenos">170</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="GS.iterate-171"><a href="#GS.iterate-171"><span class="linenos">171</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span> <span class="o">+</span> <span class="n">yMF</span>
</span><span id="GS.iterate-172"><a href="#GS.iterate-172"><span class="linenos">172</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Minv</span><span class="p">)</span>
</span><span id="GS.iterate-173"><a href="#GS.iterate-173"><span class="linenos">173</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="GS.iterate-174"><a href="#GS.iterate-174"><span class="linenos">174</span></a>
</span><span id="GS.iterate-175"><a href="#GS.iterate-175"><span class="linenos">175</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Performs the Gauss-Seidel iterations and returns the final solution
  and trajectory of solutions.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  The number of iterations to perform.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>The final solution tensor of shape (<code><a href="#GS.bs">bs</a></code>, <code><a href="#GS.n">n</a></code>).</li>
  <li>List containing the trajectory of solutions throughout the iterations.</li>
  </ul>
</blockquote>
</div>


                            </div>
                </section>
                <section id="Jacobi">
                            <input id="Jacobi-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Jacobi</span><wbr>(<span class="base"><a href="#BaseModel">deep_unfolding.BaseModel</a></span>):

                <label class="view-source-button" for="Jacobi-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Jacobi"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Jacobi-250"><a href="#Jacobi-250"><span class="linenos">250</span></a><span class="k">class</span> <span class="nc">Jacobi</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="Jacobi-251"><a href="#Jacobi-251"><span class="linenos">251</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class implementing the Jacobi iteration algorithm for solving a linear system.&quot;&quot;&quot;</span>
</span><span id="Jacobi-252"><a href="#Jacobi-252"><span class="linenos">252</span></a>
</span><span id="Jacobi-253"><a href="#Jacobi-253"><span class="linenos">253</span></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Jacobi-254"><a href="#Jacobi-254"><span class="linenos">254</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimension of the solution.&quot;&quot;&quot;</span>
</span><span id="Jacobi-255"><a href="#Jacobi-255"><span class="linenos">255</span></a>
</span><span id="Jacobi-256"><a href="#Jacobi-256"><span class="linenos">256</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="Jacobi-257"><a href="#Jacobi-257"><span class="linenos">257</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random matrix $H$.&quot;&quot;&quot;</span>
</span><span id="Jacobi-258"><a href="#Jacobi-258"><span class="linenos">258</span></a>
</span><span id="Jacobi-259"><a href="#Jacobi-259"><span class="linenos">259</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Jacobi-260"><a href="#Jacobi-260"><span class="linenos">260</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="Jacobi-261"><a href="#Jacobi-261"><span class="linenos">261</span></a>
</span><span id="Jacobi-262"><a href="#Jacobi-262"><span class="linenos">262</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="Jacobi-263"><a href="#Jacobi-263"><span class="linenos">263</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution tensor.&quot;&quot;&quot;</span>
</span><span id="Jacobi-264"><a href="#Jacobi-264"><span class="linenos">264</span></a>
</span><span id="Jacobi-265"><a href="#Jacobi-265"><span class="linenos">265</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="Jacobi-266"><a href="#Jacobi-266"><span class="linenos">266</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Original matrix converted to a torch tensor.&quot;&quot;&quot;</span>
</span><span id="Jacobi-267"><a href="#Jacobi-267"><span class="linenos">267</span></a>
</span><span id="Jacobi-268"><a href="#Jacobi-268"><span class="linenos">268</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="Jacobi-269"><a href="#Jacobi-269"><span class="linenos">269</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="Jacobi-270"><a href="#Jacobi-270"><span class="linenos">270</span></a>
</span><span id="Jacobi-271"><a href="#Jacobi-271"><span class="linenos">271</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="Jacobi-272"><a href="#Jacobi-272"><span class="linenos">272</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="Jacobi-273"><a href="#Jacobi-273"><span class="linenos">273</span></a>
</span><span id="Jacobi-274"><a href="#Jacobi-274"><span class="linenos">274</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="Jacobi-275"><a href="#Jacobi-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="Jacobi-276"><a href="#Jacobi-276"><span class="linenos">276</span></a>
</span><span id="Jacobi-277"><a href="#Jacobi-277"><span class="linenos">277</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="Jacobi-278"><a href="#Jacobi-278"><span class="linenos">278</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="Jacobi-279"><a href="#Jacobi-279"><span class="linenos">279</span></a>
</span><span id="Jacobi-280"><a href="#Jacobi-280"><span class="linenos">280</span></a>    <span class="n">Minv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="Jacobi-281"><a href="#Jacobi-281"><span class="linenos">281</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the matrix $D + L$.&quot;&quot;&quot;</span>
</span><span id="Jacobi-282"><a href="#Jacobi-282"><span class="linenos">282</span></a>
</span><span id="Jacobi-283"><a href="#Jacobi-283"><span class="linenos">283</span></a>    <span class="n">omega</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="Jacobi-284"><a href="#Jacobi-284"><span class="linenos">284</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Relaxation parameter for Jacobi iterations.&quot;&quot;&quot;</span>
</span><span id="Jacobi-285"><a href="#Jacobi-285"><span class="linenos">285</span></a>
</span><span id="Jacobi-286"><a href="#Jacobi-286"><span class="linenos">286</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Jacobi-287"><a href="#Jacobi-287"><span class="linenos">287</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Jacobi-288"><a href="#Jacobi-288"><span class="linenos">288</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Jacobi-289"><a href="#Jacobi-289"><span class="linenos">289</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
</span><span id="Jacobi-290"><a href="#Jacobi-290"><span class="linenos">290</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="Jacobi-291"><a href="#Jacobi-291"><span class="linenos">291</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Jacobi-292"><a href="#Jacobi-292"><span class="linenos">292</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="Jacobi-293"><a href="#Jacobi-293"><span class="linenos">293</span></a>        <span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="Jacobi-294"><a href="#Jacobi-294"><span class="linenos">294</span></a>    <span class="p">):</span>
</span><span id="Jacobi-295"><a href="#Jacobi-295"><span class="linenos">295</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Jacobi iteration solver.</span>
</span><span id="Jacobi-296"><a href="#Jacobi-296"><span class="linenos">296</span></a>
</span><span id="Jacobi-297"><a href="#Jacobi-297"><span class="linenos">297</span></a><span class="sd">        Args:</span>
</span><span id="Jacobi-298"><a href="#Jacobi-298"><span class="linenos">298</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="Jacobi-299"><a href="#Jacobi-299"><span class="linenos">299</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="Jacobi-300"><a href="#Jacobi-300"><span class="linenos">300</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="Jacobi-301"><a href="#Jacobi-301"><span class="linenos">301</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="Jacobi-302"><a href="#Jacobi-302"><span class="linenos">302</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="Jacobi-303"><a href="#Jacobi-303"><span class="linenos">303</span></a><span class="sd">          omega: Relaxation parameter for Jacobi iterations.</span>
</span><span id="Jacobi-304"><a href="#Jacobi-304"><span class="linenos">304</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Jacobi-305"><a href="#Jacobi-305"><span class="linenos">305</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Jacobi</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Jacobi-306"><a href="#Jacobi-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</span><span id="Jacobi-307"><a href="#Jacobi-307"><span class="linenos">307</span></a>
</span><span id="Jacobi-308"><a href="#Jacobi-308"><span class="linenos">308</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="Jacobi-309"><a href="#Jacobi-309"><span class="linenos">309</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the Jacobi iterations and returns the final solution and</span>
</span><span id="Jacobi-310"><a href="#Jacobi-310"><span class="linenos">310</span></a><span class="sd">          trajectory of solutions.</span>
</span><span id="Jacobi-311"><a href="#Jacobi-311"><span class="linenos">311</span></a>
</span><span id="Jacobi-312"><a href="#Jacobi-312"><span class="linenos">312</span></a><span class="sd">        Args:</span>
</span><span id="Jacobi-313"><a href="#Jacobi-313"><span class="linenos">313</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="Jacobi-314"><a href="#Jacobi-314"><span class="linenos">314</span></a>
</span><span id="Jacobi-315"><a href="#Jacobi-315"><span class="linenos">315</span></a><span class="sd">        Returns:</span>
</span><span id="Jacobi-316"><a href="#Jacobi-316"><span class="linenos">316</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="Jacobi-317"><a href="#Jacobi-317"><span class="linenos">317</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="Jacobi-318"><a href="#Jacobi-318"><span class="linenos">318</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="Jacobi-319"><a href="#Jacobi-319"><span class="linenos">319</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Jacobi-320"><a href="#Jacobi-320"><span class="linenos">320</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Jacobi-321"><a href="#Jacobi-321"><span class="linenos">321</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="Jacobi-322"><a href="#Jacobi-322"><span class="linenos">322</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="Jacobi-323"><a href="#Jacobi-323"><span class="linenos">323</span></a>
</span><span id="Jacobi-324"><a href="#Jacobi-324"><span class="linenos">324</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># Assuming H is defined</span>
</span><span id="Jacobi-325"><a href="#Jacobi-325"><span class="linenos">325</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>  <span class="c1"># Generate batch initial solution vector</span>
</span><span id="Jacobi-326"><a href="#Jacobi-326"><span class="linenos">326</span></a>
</span><span id="Jacobi-327"><a href="#Jacobi-327"><span class="linenos">327</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="Jacobi-328"><a href="#Jacobi-328"><span class="linenos">328</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">))</span>
</span><span id="Jacobi-329"><a href="#Jacobi-329"><span class="linenos">329</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="Jacobi-330"><a href="#Jacobi-330"><span class="linenos">330</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="Jacobi-331"><a href="#Jacobi-331"><span class="linenos">331</span></a>
</span><span id="Jacobi-332"><a href="#Jacobi-332"><span class="linenos">332</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Class implementing the Jacobi iteration algorithm for solving a linear system.</p>
</div>


                            <div id="Jacobi.__init__" class="classattr">
                                        <input id="Jacobi.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Jacobi</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">+</span><span class="n">_ScalarType_co</span><span class="p">]]</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span></span>)</span>

                <label class="view-source-button" for="Jacobi.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Jacobi.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Jacobi.__init__-286"><a href="#Jacobi.__init__-286"><span class="linenos">286</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Jacobi.__init__-287"><a href="#Jacobi.__init__-287"><span class="linenos">287</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Jacobi.__init__-288"><a href="#Jacobi.__init__-288"><span class="linenos">288</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Jacobi.__init__-289"><a href="#Jacobi.__init__-289"><span class="linenos">289</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
</span><span id="Jacobi.__init__-290"><a href="#Jacobi.__init__-290"><span class="linenos">290</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="Jacobi.__init__-291"><a href="#Jacobi.__init__-291"><span class="linenos">291</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Jacobi.__init__-292"><a href="#Jacobi.__init__-292"><span class="linenos">292</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="Jacobi.__init__-293"><a href="#Jacobi.__init__-293"><span class="linenos">293</span></a>        <span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="Jacobi.__init__-294"><a href="#Jacobi.__init__-294"><span class="linenos">294</span></a>    <span class="p">):</span>
</span><span id="Jacobi.__init__-295"><a href="#Jacobi.__init__-295"><span class="linenos">295</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Jacobi iteration solver.</span>
</span><span id="Jacobi.__init__-296"><a href="#Jacobi.__init__-296"><span class="linenos">296</span></a>
</span><span id="Jacobi.__init__-297"><a href="#Jacobi.__init__-297"><span class="linenos">297</span></a><span class="sd">        Args:</span>
</span><span id="Jacobi.__init__-298"><a href="#Jacobi.__init__-298"><span class="linenos">298</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="Jacobi.__init__-299"><a href="#Jacobi.__init__-299"><span class="linenos">299</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="Jacobi.__init__-300"><a href="#Jacobi.__init__-300"><span class="linenos">300</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="Jacobi.__init__-301"><a href="#Jacobi.__init__-301"><span class="linenos">301</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="Jacobi.__init__-302"><a href="#Jacobi.__init__-302"><span class="linenos">302</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="Jacobi.__init__-303"><a href="#Jacobi.__init__-303"><span class="linenos">303</span></a><span class="sd">          omega: Relaxation parameter for Jacobi iterations.</span>
</span><span id="Jacobi.__init__-304"><a href="#Jacobi.__init__-304"><span class="linenos">304</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Jacobi.__init__-305"><a href="#Jacobi.__init__-305"><span class="linenos">305</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Jacobi</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Jacobi.__init__-306"><a href="#Jacobi.__init__-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the Jacobi iteration solver.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n:</strong>  Dimension of the solution.</li>
<li><strong>a:</strong>  Input square matrix to decompose.</li>
<li><strong>h:</strong>  Random matrix $H$.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution tensor.</li>
<li><strong>omega:</strong>  Relaxation parameter for Jacobi iterations.</li>
</ul>
</div>


                            </div>
                            <div id="Jacobi.n" class="classattr">
                                <div class="attr variable">
            <span class="name">n</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Jacobi.n"></a>
    
            <div class="docstring"><p>Dimension of the solution.</p>
</div>


                            </div>
                            <div id="Jacobi.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#Jacobi.H"></a>
    
            <div class="docstring"><p>Random matrix $H$.</p>
</div>


                            </div>
                            <div id="Jacobi.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Jacobi.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="Jacobi.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#Jacobi.y"></a>
    
            <div class="docstring"><p>Solution tensor.</p>
</div>


                            </div>
                            <div id="Jacobi.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#Jacobi.A"></a>
    
            <div class="docstring"><p>Original matrix converted to a torch tensor.</p>
</div>


                            </div>
                            <div id="Jacobi.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#Jacobi.D"></a>
    
            <div class="docstring"><p>Diagonal matrix of $A$.</p>
</div>


                            </div>
                            <div id="Jacobi.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#Jacobi.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="Jacobi.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#Jacobi.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="Jacobi.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#Jacobi.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="Jacobi.Minv" class="classattr">
                                <div class="attr variable">
            <span class="name">Minv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#Jacobi.Minv"></a>
    
            <div class="docstring"><p>Inverse of the matrix $D + L$.</p>
</div>


                            </div>
                            <div id="Jacobi.omega" class="classattr">
                                <div class="attr variable">
            <span class="name">omega</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#Jacobi.omega"></a>
    
            <div class="docstring"><p>Relaxation parameter for Jacobi iterations.</p>
</div>


                            </div>
                            <div id="Jacobi.iterate" class="classattr">
                                        <input id="Jacobi.iterate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iterate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Jacobi.iterate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Jacobi.iterate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Jacobi.iterate-308"><a href="#Jacobi.iterate-308"><span class="linenos">308</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="Jacobi.iterate-309"><a href="#Jacobi.iterate-309"><span class="linenos">309</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the Jacobi iterations and returns the final solution and</span>
</span><span id="Jacobi.iterate-310"><a href="#Jacobi.iterate-310"><span class="linenos">310</span></a><span class="sd">          trajectory of solutions.</span>
</span><span id="Jacobi.iterate-311"><a href="#Jacobi.iterate-311"><span class="linenos">311</span></a>
</span><span id="Jacobi.iterate-312"><a href="#Jacobi.iterate-312"><span class="linenos">312</span></a><span class="sd">        Args:</span>
</span><span id="Jacobi.iterate-313"><a href="#Jacobi.iterate-313"><span class="linenos">313</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="Jacobi.iterate-314"><a href="#Jacobi.iterate-314"><span class="linenos">314</span></a>
</span><span id="Jacobi.iterate-315"><a href="#Jacobi.iterate-315"><span class="linenos">315</span></a><span class="sd">        Returns:</span>
</span><span id="Jacobi.iterate-316"><a href="#Jacobi.iterate-316"><span class="linenos">316</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="Jacobi.iterate-317"><a href="#Jacobi.iterate-317"><span class="linenos">317</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="Jacobi.iterate-318"><a href="#Jacobi.iterate-318"><span class="linenos">318</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="Jacobi.iterate-319"><a href="#Jacobi.iterate-319"><span class="linenos">319</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Jacobi.iterate-320"><a href="#Jacobi.iterate-320"><span class="linenos">320</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Jacobi.iterate-321"><a href="#Jacobi.iterate-321"><span class="linenos">321</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="Jacobi.iterate-322"><a href="#Jacobi.iterate-322"><span class="linenos">322</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="Jacobi.iterate-323"><a href="#Jacobi.iterate-323"><span class="linenos">323</span></a>
</span><span id="Jacobi.iterate-324"><a href="#Jacobi.iterate-324"><span class="linenos">324</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># Assuming H is defined</span>
</span><span id="Jacobi.iterate-325"><a href="#Jacobi.iterate-325"><span class="linenos">325</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>  <span class="c1"># Generate batch initial solution vector</span>
</span><span id="Jacobi.iterate-326"><a href="#Jacobi.iterate-326"><span class="linenos">326</span></a>
</span><span id="Jacobi.iterate-327"><a href="#Jacobi.iterate-327"><span class="linenos">327</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="Jacobi.iterate-328"><a href="#Jacobi.iterate-328"><span class="linenos">328</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">))</span>
</span><span id="Jacobi.iterate-329"><a href="#Jacobi.iterate-329"><span class="linenos">329</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="Jacobi.iterate-330"><a href="#Jacobi.iterate-330"><span class="linenos">330</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="Jacobi.iterate-331"><a href="#Jacobi.iterate-331"><span class="linenos">331</span></a>
</span><span id="Jacobi.iterate-332"><a href="#Jacobi.iterate-332"><span class="linenos">332</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Performs the Jacobi iterations and returns the final solution and
  trajectory of solutions.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  The number of iterations to perform.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>The final solution tensor of shape (<code><a href="#Jacobi.bs">bs</a></code>, <code><a href="#Jacobi.n">n</a></code>).</li>
  <li>List containing the trajectory of solutions throughout the iterations.</li>
  </ul>
</blockquote>
</div>


                            </div>
                </section>
                <section id="model_iterations">
                            <input id="model_iterations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">model_iterations</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">model</span>,</span><span class="param">	<span class="n">solution</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">total_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="model_iterations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#model_iterations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="model_iterations-15"><a href="#model_iterations-15"><span class="linenos">15</span></a><span class="k">def</span> <span class="nf">model_iterations</span><span class="p">(</span>
</span><span id="model_iterations-16"><a href="#model_iterations-16"><span class="linenos">16</span></a>    <span class="n">model</span><span class="p">,</span>
</span><span id="model_iterations-17"><a href="#model_iterations-17"><span class="linenos">17</span></a>    <span class="n">solution</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="model_iterations-18"><a href="#model_iterations-18"><span class="linenos">18</span></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="model_iterations-19"><a href="#model_iterations-19"><span class="linenos">19</span></a>    <span class="n">total_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
</span><span id="model_iterations-20"><a href="#model_iterations-20"><span class="linenos">20</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
</span><span id="model_iterations-21"><a href="#model_iterations-21"><span class="linenos">21</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Tensor</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="model_iterations-22"><a href="#model_iterations-22"><span class="linenos">22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform iterations using the provided model and calculate the error norm</span>
</span><span id="model_iterations-23"><a href="#model_iterations-23"><span class="linenos">23</span></a><span class="sd">      at each iteration.</span>
</span><span id="model_iterations-24"><a href="#model_iterations-24"><span class="linenos">24</span></a>
</span><span id="model_iterations-25"><a href="#model_iterations-25"><span class="linenos">25</span></a><span class="sd">    Args:</span>
</span><span id="model_iterations-26"><a href="#model_iterations-26"><span class="linenos">26</span></a><span class="sd">      total_itr: Total number of iterations to perform.</span>
</span><span id="model_iterations-27"><a href="#model_iterations-27"><span class="linenos">27</span></a><span class="sd">      n: Dimension of the solution.</span>
</span><span id="model_iterations-28"><a href="#model_iterations-28"><span class="linenos">28</span></a><span class="sd">      bs: Batch size.</span>
</span><span id="model_iterations-29"><a href="#model_iterations-29"><span class="linenos">29</span></a><span class="sd">      model: The model instance that provides the iterate method.</span>
</span><span id="model_iterations-30"><a href="#model_iterations-30"><span class="linenos">30</span></a><span class="sd">      solution: The ground truth solution tensor.</span>
</span><span id="model_iterations-31"><a href="#model_iterations-31"><span class="linenos">31</span></a>
</span><span id="model_iterations-32"><a href="#model_iterations-32"><span class="linenos">32</span></a><span class="sd">    Returns:</span>
</span><span id="model_iterations-33"><a href="#model_iterations-33"><span class="linenos">33</span></a><span class="sd">      A tuple with the following contents:</span>
</span><span id="model_iterations-34"><a href="#model_iterations-34"><span class="linenos">34</span></a><span class="sd">        - List of tensors representing the solution estimates at each iteration.</span>
</span><span id="model_iterations-35"><a href="#model_iterations-35"><span class="linenos">35</span></a><span class="sd">        - List of float values representing the normalized error at each iteration.</span>
</span><span id="model_iterations-36"><a href="#model_iterations-36"><span class="linenos">36</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="model_iterations-37"><a href="#model_iterations-37"><span class="linenos">37</span></a>    <span class="n">norm_list_model</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Initialize the iteration list</span>
</span><span id="model_iterations-38"><a href="#model_iterations-38"><span class="linenos">38</span></a>    <span class="n">s_hats</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="model_iterations-39"><a href="#model_iterations-39"><span class="linenos">39</span></a>
</span><span id="model_iterations-40"><a href="#model_iterations-40"><span class="linenos">40</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_itr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="model_iterations-41"><a href="#model_iterations-41"><span class="linenos">41</span></a>        <span class="n">s_hat</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="model_iterations-42"><a href="#model_iterations-42"><span class="linenos">42</span></a>        <span class="n">err</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">-</span> <span class="n">s_hat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="model_iterations-43"><a href="#model_iterations-43"><span class="linenos">43</span></a>            <span class="n">n</span> <span class="o">*</span> <span class="n">bs</span>
</span><span id="model_iterations-44"><a href="#model_iterations-44"><span class="linenos">44</span></a>        <span class="p">)</span>
</span><span id="model_iterations-45"><a href="#model_iterations-45"><span class="linenos">45</span></a>
</span><span id="model_iterations-46"><a href="#model_iterations-46"><span class="linenos">46</span></a>        <span class="n">s_hats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_hat</span><span class="p">)</span>
</span><span id="model_iterations-47"><a href="#model_iterations-47"><span class="linenos">47</span></a>        <span class="n">norm_list_model</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
</span><span id="model_iterations-48"><a href="#model_iterations-48"><span class="linenos">48</span></a>
</span><span id="model_iterations-49"><a href="#model_iterations-49"><span class="linenos">49</span></a>    <span class="k">return</span> <span class="n">s_hats</span><span class="p">,</span> <span class="n">norm_list_model</span>
</span></pre></div>


            <div class="docstring"><p>Perform iterations using the provided model and calculate the error norm
  at each iteration.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>total_itr:</strong>  Total number of iterations to perform.</li>
<li><strong>n:</strong>  Dimension of the solution.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>model:</strong>  The model instance that provides the iterate method.</li>
<li><strong>solution:</strong>  The ground truth solution tensor.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>List of tensors representing the solution estimates at each iteration.</li>
  <li>List of float values representing the normalized error at each iteration.</li>
  </ul>
</blockquote>
</div>


                </section>
                <section id="RI">
                            <input id="RI-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RI</span><wbr>(<span class="base"><a href="#BaseModel">deep_unfolding.BaseModel</a></span>):

                <label class="view-source-button" for="RI-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RI"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RI-178"><a href="#RI-178"><span class="linenos">178</span></a><span class="k">class</span> <span class="nc">RI</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="RI-179"><a href="#RI-179"><span class="linenos">179</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class implementing the Richardson iteration algorithm for solving a linear system.&quot;&quot;&quot;</span>
</span><span id="RI-180"><a href="#RI-180"><span class="linenos">180</span></a>
</span><span id="RI-181"><a href="#RI-181"><span class="linenos">181</span></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="RI-182"><a href="#RI-182"><span class="linenos">182</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimension of the solution.&quot;&quot;&quot;</span>
</span><span id="RI-183"><a href="#RI-183"><span class="linenos">183</span></a>
</span><span id="RI-184"><a href="#RI-184"><span class="linenos">184</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RI-185"><a href="#RI-185"><span class="linenos">185</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random matrix $H$.&quot;&quot;&quot;</span>
</span><span id="RI-186"><a href="#RI-186"><span class="linenos">186</span></a>
</span><span id="RI-187"><a href="#RI-187"><span class="linenos">187</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="RI-188"><a href="#RI-188"><span class="linenos">188</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="RI-189"><a href="#RI-189"><span class="linenos">189</span></a>
</span><span id="RI-190"><a href="#RI-190"><span class="linenos">190</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RI-191"><a href="#RI-191"><span class="linenos">191</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution tensor.&quot;&quot;&quot;</span>
</span><span id="RI-192"><a href="#RI-192"><span class="linenos">192</span></a>
</span><span id="RI-193"><a href="#RI-193"><span class="linenos">193</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RI-194"><a href="#RI-194"><span class="linenos">194</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Original matrix converted to a torch tensor.&quot;&quot;&quot;</span>
</span><span id="RI-195"><a href="#RI-195"><span class="linenos">195</span></a>
</span><span id="RI-196"><a href="#RI-196"><span class="linenos">196</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RI-197"><a href="#RI-197"><span class="linenos">197</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="RI-198"><a href="#RI-198"><span class="linenos">198</span></a>
</span><span id="RI-199"><a href="#RI-199"><span class="linenos">199</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RI-200"><a href="#RI-200"><span class="linenos">200</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="RI-201"><a href="#RI-201"><span class="linenos">201</span></a>
</span><span id="RI-202"><a href="#RI-202"><span class="linenos">202</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RI-203"><a href="#RI-203"><span class="linenos">203</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="RI-204"><a href="#RI-204"><span class="linenos">204</span></a>
</span><span id="RI-205"><a href="#RI-205"><span class="linenos">205</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RI-206"><a href="#RI-206"><span class="linenos">206</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="RI-207"><a href="#RI-207"><span class="linenos">207</span></a>
</span><span id="RI-208"><a href="#RI-208"><span class="linenos">208</span></a>    <span class="n">Minv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RI-209"><a href="#RI-209"><span class="linenos">209</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the matrix $D + L$.&quot;&quot;&quot;</span>
</span><span id="RI-210"><a href="#RI-210"><span class="linenos">210</span></a>
</span><span id="RI-211"><a href="#RI-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">):</span>
</span><span id="RI-212"><a href="#RI-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Richardson iteration solver.</span>
</span><span id="RI-213"><a href="#RI-213"><span class="linenos">213</span></a>
</span><span id="RI-214"><a href="#RI-214"><span class="linenos">214</span></a><span class="sd">        Args:</span>
</span><span id="RI-215"><a href="#RI-215"><span class="linenos">215</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="RI-216"><a href="#RI-216"><span class="linenos">216</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="RI-217"><a href="#RI-217"><span class="linenos">217</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="RI-218"><a href="#RI-218"><span class="linenos">218</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="RI-219"><a href="#RI-219"><span class="linenos">219</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="RI-220"><a href="#RI-220"><span class="linenos">220</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RI-221"><a href="#RI-221"><span class="linenos">221</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">RI</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="RI-222"><a href="#RI-222"><span class="linenos">222</span></a>
</span><span id="RI-223"><a href="#RI-223"><span class="linenos">223</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="RI-224"><a href="#RI-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the Richardson iterations and returns the final solution and</span>
</span><span id="RI-225"><a href="#RI-225"><span class="linenos">225</span></a><span class="sd">          trajectory of solutions.</span>
</span><span id="RI-226"><a href="#RI-226"><span class="linenos">226</span></a>
</span><span id="RI-227"><a href="#RI-227"><span class="linenos">227</span></a><span class="sd">        Args:</span>
</span><span id="RI-228"><a href="#RI-228"><span class="linenos">228</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="RI-229"><a href="#RI-229"><span class="linenos">229</span></a>
</span><span id="RI-230"><a href="#RI-230"><span class="linenos">230</span></a><span class="sd">        Returns:</span>
</span><span id="RI-231"><a href="#RI-231"><span class="linenos">231</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="RI-232"><a href="#RI-232"><span class="linenos">232</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="RI-233"><a href="#RI-233"><span class="linenos">233</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="RI-234"><a href="#RI-234"><span class="linenos">234</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RI-235"><a href="#RI-235"><span class="linenos">235</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="RI-236"><a href="#RI-236"><span class="linenos">236</span></a>        <span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
</span><span id="RI-237"><a href="#RI-237"><span class="linenos">237</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RI-238"><a href="#RI-238"><span class="linenos">238</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="RI-239"><a href="#RI-239"><span class="linenos">239</span></a>
</span><span id="RI-240"><a href="#RI-240"><span class="linenos">240</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># Assuming H is defined</span>
</span><span id="RI-241"><a href="#RI-241"><span class="linenos">241</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>  <span class="c1"># Generate batch initial solution vector</span>
</span><span id="RI-242"><a href="#RI-242"><span class="linenos">242</span></a>
</span><span id="RI-243"><a href="#RI-243"><span class="linenos">243</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="RI-244"><a href="#RI-244"><span class="linenos">244</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="p">(</span><span class="n">yMF</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)))</span>
</span><span id="RI-245"><a href="#RI-245"><span class="linenos">245</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="RI-246"><a href="#RI-246"><span class="linenos">246</span></a>
</span><span id="RI-247"><a href="#RI-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Class implementing the Richardson iteration algorithm for solving a linear system.</p>
</div>


                            <div id="RI.__init__" class="classattr">
                                        <input id="RI.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">RI</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">+</span><span class="n">_ScalarType_co</span><span class="p">]]</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span></span>)</span>

                <label class="view-source-button" for="RI.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RI.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RI.__init__-211"><a href="#RI.__init__-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">):</span>
</span><span id="RI.__init__-212"><a href="#RI.__init__-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Richardson iteration solver.</span>
</span><span id="RI.__init__-213"><a href="#RI.__init__-213"><span class="linenos">213</span></a>
</span><span id="RI.__init__-214"><a href="#RI.__init__-214"><span class="linenos">214</span></a><span class="sd">        Args:</span>
</span><span id="RI.__init__-215"><a href="#RI.__init__-215"><span class="linenos">215</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="RI.__init__-216"><a href="#RI.__init__-216"><span class="linenos">216</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="RI.__init__-217"><a href="#RI.__init__-217"><span class="linenos">217</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="RI.__init__-218"><a href="#RI.__init__-218"><span class="linenos">218</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="RI.__init__-219"><a href="#RI.__init__-219"><span class="linenos">219</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="RI.__init__-220"><a href="#RI.__init__-220"><span class="linenos">220</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RI.__init__-221"><a href="#RI.__init__-221"><span class="linenos">221</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">RI</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the Richardson iteration solver.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n:</strong>  Dimension of the solution.</li>
<li><strong>a:</strong>  Input square matrix to decompose.</li>
<li><strong>h:</strong>  Random matrix $H$.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution tensor.</li>
</ul>
</div>


                            </div>
                            <div id="RI.n" class="classattr">
                                <div class="attr variable">
            <span class="name">n</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#RI.n"></a>
    
            <div class="docstring"><p>Dimension of the solution.</p>
</div>


                            </div>
                            <div id="RI.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RI.H"></a>
    
            <div class="docstring"><p>Random matrix $H$.</p>
</div>


                            </div>
                            <div id="RI.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#RI.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="RI.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RI.y"></a>
    
            <div class="docstring"><p>Solution tensor.</p>
</div>


                            </div>
                            <div id="RI.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RI.A"></a>
    
            <div class="docstring"><p>Original matrix converted to a torch tensor.</p>
</div>


                            </div>
                            <div id="RI.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RI.D"></a>
    
            <div class="docstring"><p>Diagonal matrix of $A$.</p>
</div>


                            </div>
                            <div id="RI.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RI.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="RI.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RI.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="RI.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RI.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="RI.Minv" class="classattr">
                                <div class="attr variable">
            <span class="name">Minv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RI.Minv"></a>
    
            <div class="docstring"><p>Inverse of the matrix $D + L$.</p>
</div>


                            </div>
                            <div id="RI.iterate" class="classattr">
                                        <input id="RI.iterate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iterate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="RI.iterate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RI.iterate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RI.iterate-223"><a href="#RI.iterate-223"><span class="linenos">223</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="RI.iterate-224"><a href="#RI.iterate-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the Richardson iterations and returns the final solution and</span>
</span><span id="RI.iterate-225"><a href="#RI.iterate-225"><span class="linenos">225</span></a><span class="sd">          trajectory of solutions.</span>
</span><span id="RI.iterate-226"><a href="#RI.iterate-226"><span class="linenos">226</span></a>
</span><span id="RI.iterate-227"><a href="#RI.iterate-227"><span class="linenos">227</span></a><span class="sd">        Args:</span>
</span><span id="RI.iterate-228"><a href="#RI.iterate-228"><span class="linenos">228</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="RI.iterate-229"><a href="#RI.iterate-229"><span class="linenos">229</span></a>
</span><span id="RI.iterate-230"><a href="#RI.iterate-230"><span class="linenos">230</span></a><span class="sd">        Returns:</span>
</span><span id="RI.iterate-231"><a href="#RI.iterate-231"><span class="linenos">231</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="RI.iterate-232"><a href="#RI.iterate-232"><span class="linenos">232</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="RI.iterate-233"><a href="#RI.iterate-233"><span class="linenos">233</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="RI.iterate-234"><a href="#RI.iterate-234"><span class="linenos">234</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RI.iterate-235"><a href="#RI.iterate-235"><span class="linenos">235</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="RI.iterate-236"><a href="#RI.iterate-236"><span class="linenos">236</span></a>        <span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
</span><span id="RI.iterate-237"><a href="#RI.iterate-237"><span class="linenos">237</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RI.iterate-238"><a href="#RI.iterate-238"><span class="linenos">238</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="RI.iterate-239"><a href="#RI.iterate-239"><span class="linenos">239</span></a>
</span><span id="RI.iterate-240"><a href="#RI.iterate-240"><span class="linenos">240</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># Assuming H is defined</span>
</span><span id="RI.iterate-241"><a href="#RI.iterate-241"><span class="linenos">241</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>  <span class="c1"># Generate batch initial solution vector</span>
</span><span id="RI.iterate-242"><a href="#RI.iterate-242"><span class="linenos">242</span></a>
</span><span id="RI.iterate-243"><a href="#RI.iterate-243"><span class="linenos">243</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="RI.iterate-244"><a href="#RI.iterate-244"><span class="linenos">244</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="p">(</span><span class="n">yMF</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)))</span>
</span><span id="RI.iterate-245"><a href="#RI.iterate-245"><span class="linenos">245</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="RI.iterate-246"><a href="#RI.iterate-246"><span class="linenos">246</span></a>
</span><span id="RI.iterate-247"><a href="#RI.iterate-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Performs the Richardson iterations and returns the final solution and
  trajectory of solutions.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  The number of iterations to perform.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>The final solution tensor of shape (<code><a href="#RI.bs">bs</a></code>, <code><a href="#RI.n">n</a></code>).</li>
  <li>List containing the trajectory of solutions throughout the iterations.</li>
  </ul>
</blockquote>
</div>


                            </div>
                </section>
                <section id="RINet">
                            <input id="RINet-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RINet</span><wbr>(<span class="base">torch.nn.modules.module.Module</span>):

                <label class="view-source-button" for="RINet-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RINet"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RINet-410"><a href="#RINet-410"><span class="linenos">410</span></a><span class="k">class</span> <span class="nc">RINet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span id="RINet-411"><a href="#RINet-411"><span class="linenos">411</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Deep unfolded Richardson iteration.&quot;&quot;&quot;</span>
</span><span id="RINet-412"><a href="#RINet-412"><span class="linenos">412</span></a>
</span><span id="RINet-413"><a href="#RINet-413"><span class="linenos">413</span></a>    <span class="n">inv_omega</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span>
</span><span id="RINet-414"><a href="#RINet-414"><span class="linenos">414</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the relaxation parameter omega.&quot;&quot;&quot;</span>
</span><span id="RINet-415"><a href="#RINet-415"><span class="linenos">415</span></a>
</span><span id="RINet-416"><a href="#RINet-416"><span class="linenos">416</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RINet-417"><a href="#RINet-417"><span class="linenos">417</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix $A$ of the linear system.&quot;&quot;&quot;</span>
</span><span id="RINet-418"><a href="#RINet-418"><span class="linenos">418</span></a>
</span><span id="RINet-419"><a href="#RINet-419"><span class="linenos">419</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RINet-420"><a href="#RINet-420"><span class="linenos">420</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="RINet-421"><a href="#RINet-421"><span class="linenos">421</span></a>
</span><span id="RINet-422"><a href="#RINet-422"><span class="linenos">422</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RINet-423"><a href="#RINet-423"><span class="linenos">423</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix $L$.&quot;&quot;&quot;</span>
</span><span id="RINet-424"><a href="#RINet-424"><span class="linenos">424</span></a>
</span><span id="RINet-425"><a href="#RINet-425"><span class="linenos">425</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RINet-426"><a href="#RINet-426"><span class="linenos">426</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix $U$.&quot;&quot;&quot;</span>
</span><span id="RINet-427"><a href="#RINet-427"><span class="linenos">427</span></a>
</span><span id="RINet-428"><a href="#RINet-428"><span class="linenos">428</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RINet-429"><a href="#RINet-429"><span class="linenos">429</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix $H$.&quot;&quot;&quot;</span>
</span><span id="RINet-430"><a href="#RINet-430"><span class="linenos">430</span></a>
</span><span id="RINet-431"><a href="#RINet-431"><span class="linenos">431</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RINet-432"><a href="#RINet-432"><span class="linenos">432</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="RINet-433"><a href="#RINet-433"><span class="linenos">433</span></a>
</span><span id="RINet-434"><a href="#RINet-434"><span class="linenos">434</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="RINet-435"><a href="#RINet-435"><span class="linenos">435</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="RINet-436"><a href="#RINet-436"><span class="linenos">436</span></a>
</span><span id="RINet-437"><a href="#RINet-437"><span class="linenos">437</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="RINet-438"><a href="#RINet-438"><span class="linenos">438</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution of the linear equation.&quot;&quot;&quot;</span>
</span><span id="RINet-439"><a href="#RINet-439"><span class="linenos">439</span></a>
</span><span id="RINet-440"><a href="#RINet-440"><span class="linenos">440</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="RINet-441"><a href="#RINet-441"><span class="linenos">441</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="RINet-442"><a href="#RINet-442"><span class="linenos">442</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="RINet-443"><a href="#RINet-443"><span class="linenos">443</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="RINet-444"><a href="#RINet-444"><span class="linenos">444</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="RINet-445"><a href="#RINet-445"><span class="linenos">445</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="RINet-446"><a href="#RINet-446"><span class="linenos">446</span></a>        <span class="n">init_val_RINet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="RINet-447"><a href="#RINet-447"><span class="linenos">447</span></a>        <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">,</span>
</span><span id="RINet-448"><a href="#RINet-448"><span class="linenos">448</span></a>    <span class="p">):</span>
</span><span id="RINet-449"><a href="#RINet-449"><span class="linenos">449</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the RINet model.</span>
</span><span id="RINet-450"><a href="#RINet-450"><span class="linenos">450</span></a>
</span><span id="RINet-451"><a href="#RINet-451"><span class="linenos">451</span></a><span class="sd">        Args:</span>
</span><span id="RINet-452"><a href="#RINet-452"><span class="linenos">452</span></a><span class="sd">          a: Matrix $A$ of the linear system.</span>
</span><span id="RINet-453"><a href="#RINet-453"><span class="linenos">453</span></a><span class="sd">          h: Matrix $H$.</span>
</span><span id="RINet-454"><a href="#RINet-454"><span class="linenos">454</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="RINet-455"><a href="#RINet-455"><span class="linenos">455</span></a><span class="sd">          y: Solution of the linear equation.</span>
</span><span id="RINet-456"><a href="#RINet-456"><span class="linenos">456</span></a><span class="sd">          init_val_RINet: Initial value for `inv_omega`.</span>
</span><span id="RINet-457"><a href="#RINet-457"><span class="linenos">457</span></a><span class="sd">          device: Device to run the model on (&#39;cpu&#39; or &#39;cuda&#39;).</span>
</span><span id="RINet-458"><a href="#RINet-458"><span class="linenos">458</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RINet-459"><a href="#RINet-459"><span class="linenos">459</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">RINet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="RINet-460"><a href="#RINet-460"><span class="linenos">460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
</span><span id="RINet-461"><a href="#RINet-461"><span class="linenos">461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_val_RINet</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>
</span><span id="RINet-462"><a href="#RINet-462"><span class="linenos">462</span></a>
</span><span id="RINet-463"><a href="#RINet-463"><span class="linenos">463</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">decompose_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="RINet-464"><a href="#RINet-464"><span class="linenos">464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet-465"><a href="#RINet-465"><span class="linenos">465</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet-466"><a href="#RINet-466"><span class="linenos">466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet-467"><a href="#RINet-467"><span class="linenos">467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet-468"><a href="#RINet-468"><span class="linenos">468</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet-469"><a href="#RINet-469"><span class="linenos">469</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet-470"><a href="#RINet-470"><span class="linenos">470</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span>
</span><span id="RINet-471"><a href="#RINet-471"><span class="linenos">471</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet-472"><a href="#RINet-472"><span class="linenos">472</span></a>
</span><span id="RINet-473"><a href="#RINet-473"><span class="linenos">473</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]:</span>
</span><span id="RINet-474"><a href="#RINet-474"><span class="linenos">474</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform forward pass of the RINet model.</span>
</span><span id="RINet-475"><a href="#RINet-475"><span class="linenos">475</span></a>
</span><span id="RINet-476"><a href="#RINet-476"><span class="linenos">476</span></a><span class="sd">        Args:</span>
</span><span id="RINet-477"><a href="#RINet-477"><span class="linenos">477</span></a><span class="sd">          num_itr: Number of iterations.</span>
</span><span id="RINet-478"><a href="#RINet-478"><span class="linenos">478</span></a>
</span><span id="RINet-479"><a href="#RINet-479"><span class="linenos">479</span></a><span class="sd">        Returns:</span>
</span><span id="RINet-480"><a href="#RINet-480"><span class="linenos">480</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="RINet-481"><a href="#RINet-481"><span class="linenos">481</span></a><span class="sd">            - Output tensor.</span>
</span><span id="RINet-482"><a href="#RINet-482"><span class="linenos">482</span></a><span class="sd">            - List of intermediate results.</span>
</span><span id="RINet-483"><a href="#RINet-483"><span class="linenos">483</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RINet-484"><a href="#RINet-484"><span class="linenos">484</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="RINet-485"><a href="#RINet-485"><span class="linenos">485</span></a>
</span><span id="RINet-486"><a href="#RINet-486"><span class="linenos">486</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet-487"><a href="#RINet-487"><span class="linenos">487</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="RINet-488"><a href="#RINet-488"><span class="linenos">488</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="RINet-489"><a href="#RINet-489"><span class="linenos">489</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="RINet-490"><a href="#RINet-490"><span class="linenos">490</span></a>
</span><span id="RINet-491"><a href="#RINet-491"><span class="linenos">491</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="RINet-492"><a href="#RINet-492"><span class="linenos">492</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">*</span> <span class="p">(</span><span class="n">yMF</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">))</span>
</span><span id="RINet-493"><a href="#RINet-493"><span class="linenos">493</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="RINet-494"><a href="#RINet-494"><span class="linenos">494</span></a>
</span><span id="RINet-495"><a href="#RINet-495"><span class="linenos">495</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Deep unfolded Richardson iteration.</p>
</div>


                            <div id="RINet.__init__" class="classattr">
                                        <input id="RINet.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">RINet</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">init_val_RINet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span></span>)</span>

                <label class="view-source-button" for="RINet.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RINet.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RINet.__init__-440"><a href="#RINet.__init__-440"><span class="linenos">440</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="RINet.__init__-441"><a href="#RINet.__init__-441"><span class="linenos">441</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="RINet.__init__-442"><a href="#RINet.__init__-442"><span class="linenos">442</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="RINet.__init__-443"><a href="#RINet.__init__-443"><span class="linenos">443</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="RINet.__init__-444"><a href="#RINet.__init__-444"><span class="linenos">444</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="RINet.__init__-445"><a href="#RINet.__init__-445"><span class="linenos">445</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="RINet.__init__-446"><a href="#RINet.__init__-446"><span class="linenos">446</span></a>        <span class="n">init_val_RINet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="RINet.__init__-447"><a href="#RINet.__init__-447"><span class="linenos">447</span></a>        <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">,</span>
</span><span id="RINet.__init__-448"><a href="#RINet.__init__-448"><span class="linenos">448</span></a>    <span class="p">):</span>
</span><span id="RINet.__init__-449"><a href="#RINet.__init__-449"><span class="linenos">449</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the RINet model.</span>
</span><span id="RINet.__init__-450"><a href="#RINet.__init__-450"><span class="linenos">450</span></a>
</span><span id="RINet.__init__-451"><a href="#RINet.__init__-451"><span class="linenos">451</span></a><span class="sd">        Args:</span>
</span><span id="RINet.__init__-452"><a href="#RINet.__init__-452"><span class="linenos">452</span></a><span class="sd">          a: Matrix $A$ of the linear system.</span>
</span><span id="RINet.__init__-453"><a href="#RINet.__init__-453"><span class="linenos">453</span></a><span class="sd">          h: Matrix $H$.</span>
</span><span id="RINet.__init__-454"><a href="#RINet.__init__-454"><span class="linenos">454</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="RINet.__init__-455"><a href="#RINet.__init__-455"><span class="linenos">455</span></a><span class="sd">          y: Solution of the linear equation.</span>
</span><span id="RINet.__init__-456"><a href="#RINet.__init__-456"><span class="linenos">456</span></a><span class="sd">          init_val_RINet: Initial value for `inv_omega`.</span>
</span><span id="RINet.__init__-457"><a href="#RINet.__init__-457"><span class="linenos">457</span></a><span class="sd">          device: Device to run the model on (&#39;cpu&#39; or &#39;cuda&#39;).</span>
</span><span id="RINet.__init__-458"><a href="#RINet.__init__-458"><span class="linenos">458</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RINet.__init__-459"><a href="#RINet.__init__-459"><span class="linenos">459</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">RINet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="RINet.__init__-460"><a href="#RINet.__init__-460"><span class="linenos">460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
</span><span id="RINet.__init__-461"><a href="#RINet.__init__-461"><span class="linenos">461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_val_RINet</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>
</span><span id="RINet.__init__-462"><a href="#RINet.__init__-462"><span class="linenos">462</span></a>
</span><span id="RINet.__init__-463"><a href="#RINet.__init__-463"><span class="linenos">463</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">decompose_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="RINet.__init__-464"><a href="#RINet.__init__-464"><span class="linenos">464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet.__init__-465"><a href="#RINet.__init__-465"><span class="linenos">465</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet.__init__-466"><a href="#RINet.__init__-466"><span class="linenos">466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet.__init__-467"><a href="#RINet.__init__-467"><span class="linenos">467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet.__init__-468"><a href="#RINet.__init__-468"><span class="linenos">468</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet.__init__-469"><a href="#RINet.__init__-469"><span class="linenos">469</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet.__init__-470"><a href="#RINet.__init__-470"><span class="linenos">470</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span>
</span><span id="RINet.__init__-471"><a href="#RINet.__init__-471"><span class="linenos">471</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the RINet model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>a:</strong>  Matrix $A$ of the linear system.</li>
<li><strong>h:</strong>  Matrix $H$.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution of the linear equation.</li>
<li><strong>init_val_RINet:</strong>  Initial value for <code><a href="#RINet.inv_omega">inv_omega</a></code>.</li>
<li><strong>device:</strong>  Device to run the model on ('cpu' or 'cuda').</li>
</ul>
</div>


                            </div>
                            <div id="RINet.inv_omega" class="classattr">
                                <div class="attr variable">
            <span class="name">inv_omega</span><span class="annotation">: torch.nn.parameter.Parameter</span>

        
    </div>
    <a class="headerlink" href="#RINet.inv_omega"></a>
    
            <div class="docstring"><p>Inverse of the relaxation parameter omega.</p>
</div>


                            </div>
                            <div id="RINet.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RINet.A"></a>
    
            <div class="docstring"><p>Matrix $A$ of the linear system.</p>
</div>


                            </div>
                            <div id="RINet.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RINet.D"></a>
    
            <div class="docstring"><p>Diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="RINet.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RINet.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix $L$.</p>
</div>


                            </div>
                            <div id="RINet.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RINet.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix $U$.</p>
</div>


                            </div>
                            <div id="RINet.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RINet.H"></a>
    
            <div class="docstring"><p>Matrix $H$.</p>
</div>


                            </div>
                            <div id="RINet.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RINet.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="RINet.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#RINet.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="RINet.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#RINet.y"></a>
    
            <div class="docstring"><p>Solution of the linear equation.</p>
</div>


                            </div>
                            <div id="RINet.device" class="classattr">
                                <div class="attr variable">
            <span class="name">device</span>

        
    </div>
    <a class="headerlink" href="#RINet.device"></a>
    
    

                            </div>
                            <div id="RINet.forward" class="classattr">
                                        <input id="RINet.forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">forward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="RINet.forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RINet.forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RINet.forward-473"><a href="#RINet.forward-473"><span class="linenos">473</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]:</span>
</span><span id="RINet.forward-474"><a href="#RINet.forward-474"><span class="linenos">474</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform forward pass of the RINet model.</span>
</span><span id="RINet.forward-475"><a href="#RINet.forward-475"><span class="linenos">475</span></a>
</span><span id="RINet.forward-476"><a href="#RINet.forward-476"><span class="linenos">476</span></a><span class="sd">        Args:</span>
</span><span id="RINet.forward-477"><a href="#RINet.forward-477"><span class="linenos">477</span></a><span class="sd">          num_itr: Number of iterations.</span>
</span><span id="RINet.forward-478"><a href="#RINet.forward-478"><span class="linenos">478</span></a>
</span><span id="RINet.forward-479"><a href="#RINet.forward-479"><span class="linenos">479</span></a><span class="sd">        Returns:</span>
</span><span id="RINet.forward-480"><a href="#RINet.forward-480"><span class="linenos">480</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="RINet.forward-481"><a href="#RINet.forward-481"><span class="linenos">481</span></a><span class="sd">            - Output tensor.</span>
</span><span id="RINet.forward-482"><a href="#RINet.forward-482"><span class="linenos">482</span></a><span class="sd">            - List of intermediate results.</span>
</span><span id="RINet.forward-483"><a href="#RINet.forward-483"><span class="linenos">483</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RINet.forward-484"><a href="#RINet.forward-484"><span class="linenos">484</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="RINet.forward-485"><a href="#RINet.forward-485"><span class="linenos">485</span></a>
</span><span id="RINet.forward-486"><a href="#RINet.forward-486"><span class="linenos">486</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="RINet.forward-487"><a href="#RINet.forward-487"><span class="linenos">487</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="RINet.forward-488"><a href="#RINet.forward-488"><span class="linenos">488</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="RINet.forward-489"><a href="#RINet.forward-489"><span class="linenos">489</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="RINet.forward-490"><a href="#RINet.forward-490"><span class="linenos">490</span></a>
</span><span id="RINet.forward-491"><a href="#RINet.forward-491"><span class="linenos">491</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="RINet.forward-492"><a href="#RINet.forward-492"><span class="linenos">492</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">*</span> <span class="p">(</span><span class="n">yMF</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">))</span>
</span><span id="RINet.forward-493"><a href="#RINet.forward-493"><span class="linenos">493</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="RINet.forward-494"><a href="#RINet.forward-494"><span class="linenos">494</span></a>
</span><span id="RINet.forward-495"><a href="#RINet.forward-495"><span class="linenos">495</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Perform forward pass of the RINet model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  Number of iterations.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>Output tensor.</li>
  <li>List of intermediate results.</li>
  </ul>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>torch.nn.modules.module.Module</dt>
                                <dd id="RINet.dump_patches" class="variable">dump_patches</dd>
                <dd id="RINet.training" class="variable">training</dd>
                <dd id="RINet.call_super_init" class="variable">call_super_init</dd>
                <dd id="RINet.register_buffer" class="function">register_buffer</dd>
                <dd id="RINet.register_parameter" class="function">register_parameter</dd>
                <dd id="RINet.add_module" class="function">add_module</dd>
                <dd id="RINet.register_module" class="function">register_module</dd>
                <dd id="RINet.get_submodule" class="function">get_submodule</dd>
                <dd id="RINet.get_parameter" class="function">get_parameter</dd>
                <dd id="RINet.get_buffer" class="function">get_buffer</dd>
                <dd id="RINet.get_extra_state" class="function">get_extra_state</dd>
                <dd id="RINet.set_extra_state" class="function">set_extra_state</dd>
                <dd id="RINet.apply" class="function">apply</dd>
                <dd id="RINet.cuda" class="function">cuda</dd>
                <dd id="RINet.ipu" class="function">ipu</dd>
                <dd id="RINet.xpu" class="function">xpu</dd>
                <dd id="RINet.cpu" class="function">cpu</dd>
                <dd id="RINet.type" class="function">type</dd>
                <dd id="RINet.float" class="function">float</dd>
                <dd id="RINet.double" class="function">double</dd>
                <dd id="RINet.half" class="function">half</dd>
                <dd id="RINet.bfloat16" class="function">bfloat16</dd>
                <dd id="RINet.to_empty" class="function">to_empty</dd>
                <dd id="RINet.to" class="function">to</dd>
                <dd id="RINet.register_full_backward_pre_hook" class="function">register_full_backward_pre_hook</dd>
                <dd id="RINet.register_backward_hook" class="function">register_backward_hook</dd>
                <dd id="RINet.register_full_backward_hook" class="function">register_full_backward_hook</dd>
                <dd id="RINet.register_forward_pre_hook" class="function">register_forward_pre_hook</dd>
                <dd id="RINet.register_forward_hook" class="function">register_forward_hook</dd>
                <dd id="RINet.register_state_dict_pre_hook" class="function">register_state_dict_pre_hook</dd>
                <dd id="RINet.state_dict" class="function">state_dict</dd>
                <dd id="RINet.register_load_state_dict_post_hook" class="function">register_load_state_dict_post_hook</dd>
                <dd id="RINet.load_state_dict" class="function">load_state_dict</dd>
                <dd id="RINet.parameters" class="function">parameters</dd>
                <dd id="RINet.named_parameters" class="function">named_parameters</dd>
                <dd id="RINet.buffers" class="function">buffers</dd>
                <dd id="RINet.named_buffers" class="function">named_buffers</dd>
                <dd id="RINet.children" class="function">children</dd>
                <dd id="RINet.named_children" class="function">named_children</dd>
                <dd id="RINet.modules" class="function">modules</dd>
                <dd id="RINet.named_modules" class="function">named_modules</dd>
                <dd id="RINet.train" class="function">train</dd>
                <dd id="RINet.eval" class="function">eval</dd>
                <dd id="RINet.requires_grad_" class="function">requires_grad_</dd>
                <dd id="RINet.zero_grad" class="function">zero_grad</dd>
                <dd id="RINet.share_memory" class="function">share_memory</dd>
                <dd id="RINet.extra_repr" class="function">extra_repr</dd>
                <dd id="RINet.compile" class="function">compile</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="SOR">
                            <input id="SOR-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SOR</span><wbr>(<span class="base"><a href="#BaseModel">deep_unfolding.BaseModel</a></span>):

                <label class="view-source-button" for="SOR-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SOR"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SOR-335"><a href="#SOR-335"><span class="linenos">335</span></a><span class="k">class</span> <span class="nc">SOR</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="SOR-336"><a href="#SOR-336"><span class="linenos">336</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class implementing the Successive Over-Relaxation (SOR) algorithm for</span>
</span><span id="SOR-337"><a href="#SOR-337"><span class="linenos">337</span></a><span class="sd">    solving a linear system.&quot;&quot;&quot;</span>
</span><span id="SOR-338"><a href="#SOR-338"><span class="linenos">338</span></a>
</span><span id="SOR-339"><a href="#SOR-339"><span class="linenos">339</span></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SOR-340"><a href="#SOR-340"><span class="linenos">340</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimension of the solution.&quot;&quot;&quot;</span>
</span><span id="SOR-341"><a href="#SOR-341"><span class="linenos">341</span></a>
</span><span id="SOR-342"><a href="#SOR-342"><span class="linenos">342</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SOR-343"><a href="#SOR-343"><span class="linenos">343</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random matrix $H$.&quot;&quot;&quot;</span>
</span><span id="SOR-344"><a href="#SOR-344"><span class="linenos">344</span></a>
</span><span id="SOR-345"><a href="#SOR-345"><span class="linenos">345</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SOR-346"><a href="#SOR-346"><span class="linenos">346</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="SOR-347"><a href="#SOR-347"><span class="linenos">347</span></a>
</span><span id="SOR-348"><a href="#SOR-348"><span class="linenos">348</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SOR-349"><a href="#SOR-349"><span class="linenos">349</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution tensor.&quot;&quot;&quot;</span>
</span><span id="SOR-350"><a href="#SOR-350"><span class="linenos">350</span></a>
</span><span id="SOR-351"><a href="#SOR-351"><span class="linenos">351</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SOR-352"><a href="#SOR-352"><span class="linenos">352</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Original matrix converted to a torch tensor.&quot;&quot;&quot;</span>
</span><span id="SOR-353"><a href="#SOR-353"><span class="linenos">353</span></a>
</span><span id="SOR-354"><a href="#SOR-354"><span class="linenos">354</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SOR-355"><a href="#SOR-355"><span class="linenos">355</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="SOR-356"><a href="#SOR-356"><span class="linenos">356</span></a>
</span><span id="SOR-357"><a href="#SOR-357"><span class="linenos">357</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SOR-358"><a href="#SOR-358"><span class="linenos">358</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="SOR-359"><a href="#SOR-359"><span class="linenos">359</span></a>
</span><span id="SOR-360"><a href="#SOR-360"><span class="linenos">360</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SOR-361"><a href="#SOR-361"><span class="linenos">361</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="SOR-362"><a href="#SOR-362"><span class="linenos">362</span></a>
</span><span id="SOR-363"><a href="#SOR-363"><span class="linenos">363</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SOR-364"><a href="#SOR-364"><span class="linenos">364</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="SOR-365"><a href="#SOR-365"><span class="linenos">365</span></a>
</span><span id="SOR-366"><a href="#SOR-366"><span class="linenos">366</span></a>    <span class="n">Minv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SOR-367"><a href="#SOR-367"><span class="linenos">367</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the matrix $D + L$.&quot;&quot;&quot;</span>
</span><span id="SOR-368"><a href="#SOR-368"><span class="linenos">368</span></a>
</span><span id="SOR-369"><a href="#SOR-369"><span class="linenos">369</span></a>    <span class="n">omega</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SOR-370"><a href="#SOR-370"><span class="linenos">370</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Relaxation parameter for SOR iterations.&quot;&quot;&quot;</span>
</span><span id="SOR-371"><a href="#SOR-371"><span class="linenos">371</span></a>
</span><span id="SOR-372"><a href="#SOR-372"><span class="linenos">372</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SOR-373"><a href="#SOR-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SOR-374"><a href="#SOR-374"><span class="linenos">374</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SOR-375"><a href="#SOR-375"><span class="linenos">375</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
</span><span id="SOR-376"><a href="#SOR-376"><span class="linenos">376</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SOR-377"><a href="#SOR-377"><span class="linenos">377</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SOR-378"><a href="#SOR-378"><span class="linenos">378</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SOR-379"><a href="#SOR-379"><span class="linenos">379</span></a>        <span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.8</span><span class="p">,</span>
</span><span id="SOR-380"><a href="#SOR-380"><span class="linenos">380</span></a>    <span class="p">):</span>
</span><span id="SOR-381"><a href="#SOR-381"><span class="linenos">381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the SOR solver.</span>
</span><span id="SOR-382"><a href="#SOR-382"><span class="linenos">382</span></a>
</span><span id="SOR-383"><a href="#SOR-383"><span class="linenos">383</span></a><span class="sd">        Args:</span>
</span><span id="SOR-384"><a href="#SOR-384"><span class="linenos">384</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="SOR-385"><a href="#SOR-385"><span class="linenos">385</span></a><span class="sd">          A: Input square matrix to decompose.</span>
</span><span id="SOR-386"><a href="#SOR-386"><span class="linenos">386</span></a><span class="sd">          H: Random matrix $H$.</span>
</span><span id="SOR-387"><a href="#SOR-387"><span class="linenos">387</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="SOR-388"><a href="#SOR-388"><span class="linenos">388</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="SOR-389"><a href="#SOR-389"><span class="linenos">389</span></a><span class="sd">          omega: Relaxation parameter for SOR iterations.</span>
</span><span id="SOR-390"><a href="#SOR-390"><span class="linenos">390</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SOR-391"><a href="#SOR-391"><span class="linenos">391</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">SOR</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="SOR-392"><a href="#SOR-392"><span class="linenos">392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</span><span id="SOR-393"><a href="#SOR-393"><span class="linenos">393</span></a>
</span><span id="SOR-394"><a href="#SOR-394"><span class="linenos">394</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="SOR-395"><a href="#SOR-395"><span class="linenos">395</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the SOR iterations and returns the final solution and</span>
</span><span id="SOR-396"><a href="#SOR-396"><span class="linenos">396</span></a><span class="sd">          trajectory of solutions.</span>
</span><span id="SOR-397"><a href="#SOR-397"><span class="linenos">397</span></a>
</span><span id="SOR-398"><a href="#SOR-398"><span class="linenos">398</span></a><span class="sd">        Args:</span>
</span><span id="SOR-399"><a href="#SOR-399"><span class="linenos">399</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="SOR-400"><a href="#SOR-400"><span class="linenos">400</span></a>
</span><span id="SOR-401"><a href="#SOR-401"><span class="linenos">401</span></a><span class="sd">        Returns:</span>
</span><span id="SOR-402"><a href="#SOR-402"><span class="linenos">402</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="SOR-403"><a href="#SOR-403"><span class="linenos">403</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="SOR-404"><a href="#SOR-404"><span class="linenos">404</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="SOR-405"><a href="#SOR-405"><span class="linenos">405</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SOR-406"><a href="#SOR-406"><span class="linenos">406</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SOR-407"><a href="#SOR-407"><span class="linenos">407</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SOR-408"><a href="#SOR-408"><span class="linenos">408</span></a>
</span><span id="SOR-409"><a href="#SOR-409"><span class="linenos">409</span></a>        <span class="n">inv_omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">)</span>
</span><span id="SOR-410"><a href="#SOR-410"><span class="linenos">410</span></a>        <span class="n">m_inv_sor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">inv_omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">))</span>
</span><span id="SOR-411"><a href="#SOR-411"><span class="linenos">411</span></a>
</span><span id="SOR-412"><a href="#SOR-412"><span class="linenos">412</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SOR-413"><a href="#SOR-413"><span class="linenos">413</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SOR-414"><a href="#SOR-414"><span class="linenos">414</span></a>
</span><span id="SOR-415"><a href="#SOR-415"><span class="linenos">415</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="SOR-416"><a href="#SOR-416"><span class="linenos">416</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="SOR-417"><a href="#SOR-417"><span class="linenos">417</span></a>
</span><span id="SOR-418"><a href="#SOR-418"><span class="linenos">418</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="SOR-419"><a href="#SOR-419"><span class="linenos">419</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="n">inv_omega</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">inv_omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span>
</span><span id="SOR-420"><a href="#SOR-420"><span class="linenos">420</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv_sor</span><span class="p">,</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span>
</span><span id="SOR-421"><a href="#SOR-421"><span class="linenos">421</span></a>                <span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv_sor</span>
</span><span id="SOR-422"><a href="#SOR-422"><span class="linenos">422</span></a>            <span class="p">)</span>
</span><span id="SOR-423"><a href="#SOR-423"><span class="linenos">423</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SOR-424"><a href="#SOR-424"><span class="linenos">424</span></a>
</span><span id="SOR-425"><a href="#SOR-425"><span class="linenos">425</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Class implementing the Successive Over-Relaxation (SOR) algorithm for
solving a linear system.</p>
</div>


                            <div id="SOR.__init__" class="classattr">
                                        <input id="SOR.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SOR</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">+</span><span class="n">_ScalarType_co</span><span class="p">]]</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.8</span></span>)</span>

                <label class="view-source-button" for="SOR.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SOR.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SOR.__init__-372"><a href="#SOR.__init__-372"><span class="linenos">372</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SOR.__init__-373"><a href="#SOR.__init__-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SOR.__init__-374"><a href="#SOR.__init__-374"><span class="linenos">374</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SOR.__init__-375"><a href="#SOR.__init__-375"><span class="linenos">375</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
</span><span id="SOR.__init__-376"><a href="#SOR.__init__-376"><span class="linenos">376</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SOR.__init__-377"><a href="#SOR.__init__-377"><span class="linenos">377</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SOR.__init__-378"><a href="#SOR.__init__-378"><span class="linenos">378</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SOR.__init__-379"><a href="#SOR.__init__-379"><span class="linenos">379</span></a>        <span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.8</span><span class="p">,</span>
</span><span id="SOR.__init__-380"><a href="#SOR.__init__-380"><span class="linenos">380</span></a>    <span class="p">):</span>
</span><span id="SOR.__init__-381"><a href="#SOR.__init__-381"><span class="linenos">381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the SOR solver.</span>
</span><span id="SOR.__init__-382"><a href="#SOR.__init__-382"><span class="linenos">382</span></a>
</span><span id="SOR.__init__-383"><a href="#SOR.__init__-383"><span class="linenos">383</span></a><span class="sd">        Args:</span>
</span><span id="SOR.__init__-384"><a href="#SOR.__init__-384"><span class="linenos">384</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="SOR.__init__-385"><a href="#SOR.__init__-385"><span class="linenos">385</span></a><span class="sd">          A: Input square matrix to decompose.</span>
</span><span id="SOR.__init__-386"><a href="#SOR.__init__-386"><span class="linenos">386</span></a><span class="sd">          H: Random matrix $H$.</span>
</span><span id="SOR.__init__-387"><a href="#SOR.__init__-387"><span class="linenos">387</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="SOR.__init__-388"><a href="#SOR.__init__-388"><span class="linenos">388</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="SOR.__init__-389"><a href="#SOR.__init__-389"><span class="linenos">389</span></a><span class="sd">          omega: Relaxation parameter for SOR iterations.</span>
</span><span id="SOR.__init__-390"><a href="#SOR.__init__-390"><span class="linenos">390</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SOR.__init__-391"><a href="#SOR.__init__-391"><span class="linenos">391</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">SOR</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="SOR.__init__-392"><a href="#SOR.__init__-392"><span class="linenos">392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the SOR solver.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n:</strong>  Dimension of the solution.</li>
<li><strong>A:</strong>  Input square matrix to decompose.</li>
<li><strong>H:</strong>  Random matrix $H$.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution tensor.</li>
<li><strong>omega:</strong>  Relaxation parameter for SOR iterations.</li>
</ul>
</div>


                            </div>
                            <div id="SOR.n" class="classattr">
                                <div class="attr variable">
            <span class="name">n</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#SOR.n"></a>
    
            <div class="docstring"><p>Dimension of the solution.</p>
</div>


                            </div>
                            <div id="SOR.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SOR.H"></a>
    
            <div class="docstring"><p>Random matrix $H$.</p>
</div>


                            </div>
                            <div id="SOR.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#SOR.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="SOR.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SOR.y"></a>
    
            <div class="docstring"><p>Solution tensor.</p>
</div>


                            </div>
                            <div id="SOR.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SOR.A"></a>
    
            <div class="docstring"><p>Original matrix converted to a torch tensor.</p>
</div>


                            </div>
                            <div id="SOR.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SOR.D"></a>
    
            <div class="docstring"><p>Diagonal matrix of $A$.</p>
</div>


                            </div>
                            <div id="SOR.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SOR.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="SOR.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SOR.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="SOR.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SOR.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="SOR.Minv" class="classattr">
                                <div class="attr variable">
            <span class="name">Minv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SOR.Minv"></a>
    
            <div class="docstring"><p>Inverse of the matrix $D + L$.</p>
</div>


                            </div>
                            <div id="SOR.omega" class="classattr">
                                <div class="attr variable">
            <span class="name">omega</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SOR.omega"></a>
    
            <div class="docstring"><p>Relaxation parameter for SOR iterations.</p>
</div>


                            </div>
                            <div id="SOR.iterate" class="classattr">
                                        <input id="SOR.iterate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iterate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="SOR.iterate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SOR.iterate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SOR.iterate-394"><a href="#SOR.iterate-394"><span class="linenos">394</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="SOR.iterate-395"><a href="#SOR.iterate-395"><span class="linenos">395</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the SOR iterations and returns the final solution and</span>
</span><span id="SOR.iterate-396"><a href="#SOR.iterate-396"><span class="linenos">396</span></a><span class="sd">          trajectory of solutions.</span>
</span><span id="SOR.iterate-397"><a href="#SOR.iterate-397"><span class="linenos">397</span></a>
</span><span id="SOR.iterate-398"><a href="#SOR.iterate-398"><span class="linenos">398</span></a><span class="sd">        Args:</span>
</span><span id="SOR.iterate-399"><a href="#SOR.iterate-399"><span class="linenos">399</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="SOR.iterate-400"><a href="#SOR.iterate-400"><span class="linenos">400</span></a>
</span><span id="SOR.iterate-401"><a href="#SOR.iterate-401"><span class="linenos">401</span></a><span class="sd">        Returns:</span>
</span><span id="SOR.iterate-402"><a href="#SOR.iterate-402"><span class="linenos">402</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="SOR.iterate-403"><a href="#SOR.iterate-403"><span class="linenos">403</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="SOR.iterate-404"><a href="#SOR.iterate-404"><span class="linenos">404</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="SOR.iterate-405"><a href="#SOR.iterate-405"><span class="linenos">405</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SOR.iterate-406"><a href="#SOR.iterate-406"><span class="linenos">406</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SOR.iterate-407"><a href="#SOR.iterate-407"><span class="linenos">407</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SOR.iterate-408"><a href="#SOR.iterate-408"><span class="linenos">408</span></a>
</span><span id="SOR.iterate-409"><a href="#SOR.iterate-409"><span class="linenos">409</span></a>        <span class="n">inv_omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">)</span>
</span><span id="SOR.iterate-410"><a href="#SOR.iterate-410"><span class="linenos">410</span></a>        <span class="n">m_inv_sor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">inv_omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">))</span>
</span><span id="SOR.iterate-411"><a href="#SOR.iterate-411"><span class="linenos">411</span></a>
</span><span id="SOR.iterate-412"><a href="#SOR.iterate-412"><span class="linenos">412</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SOR.iterate-413"><a href="#SOR.iterate-413"><span class="linenos">413</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SOR.iterate-414"><a href="#SOR.iterate-414"><span class="linenos">414</span></a>
</span><span id="SOR.iterate-415"><a href="#SOR.iterate-415"><span class="linenos">415</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="SOR.iterate-416"><a href="#SOR.iterate-416"><span class="linenos">416</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="SOR.iterate-417"><a href="#SOR.iterate-417"><span class="linenos">417</span></a>
</span><span id="SOR.iterate-418"><a href="#SOR.iterate-418"><span class="linenos">418</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="SOR.iterate-419"><a href="#SOR.iterate-419"><span class="linenos">419</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="n">inv_omega</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">inv_omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span>
</span><span id="SOR.iterate-420"><a href="#SOR.iterate-420"><span class="linenos">420</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv_sor</span><span class="p">,</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span>
</span><span id="SOR.iterate-421"><a href="#SOR.iterate-421"><span class="linenos">421</span></a>                <span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv_sor</span>
</span><span id="SOR.iterate-422"><a href="#SOR.iterate-422"><span class="linenos">422</span></a>            <span class="p">)</span>
</span><span id="SOR.iterate-423"><a href="#SOR.iterate-423"><span class="linenos">423</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SOR.iterate-424"><a href="#SOR.iterate-424"><span class="linenos">424</span></a>
</span><span id="SOR.iterate-425"><a href="#SOR.iterate-425"><span class="linenos">425</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Performs the SOR iterations and returns the final solution and
  trajectory of solutions.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  The number of iterations to perform.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>The final solution tensor of shape (<code><a href="#SOR.bs">bs</a></code>, <code><a href="#SOR.n">n</a></code>).</li>
  <li>List containing the trajectory of solutions throughout the iterations.</li>
  </ul>
</blockquote>
</div>


                            </div>
                </section>
                <section id="SORCheby">
                            <input id="SORCheby-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SORCheby</span><wbr>(<span class="base"><a href="#BaseModel">deep_unfolding.BaseModel</a></span>):

                <label class="view-source-button" for="SORCheby-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SORCheby"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SORCheby-428"><a href="#SORCheby-428"><span class="linenos">428</span></a><span class="k">class</span> <span class="nc">SORCheby</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="SORCheby-429"><a href="#SORCheby-429"><span class="linenos">429</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class implementing the SOR-Chebyshev algorithm for solving a linear system.&quot;&quot;&quot;</span>
</span><span id="SORCheby-430"><a href="#SORCheby-430"><span class="linenos">430</span></a>
</span><span id="SORCheby-431"><a href="#SORCheby-431"><span class="linenos">431</span></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SORCheby-432"><a href="#SORCheby-432"><span class="linenos">432</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimension of the solution.&quot;&quot;&quot;</span>
</span><span id="SORCheby-433"><a href="#SORCheby-433"><span class="linenos">433</span></a>
</span><span id="SORCheby-434"><a href="#SORCheby-434"><span class="linenos">434</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORCheby-435"><a href="#SORCheby-435"><span class="linenos">435</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random matrix $H$.&quot;&quot;&quot;</span>
</span><span id="SORCheby-436"><a href="#SORCheby-436"><span class="linenos">436</span></a>
</span><span id="SORCheby-437"><a href="#SORCheby-437"><span class="linenos">437</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SORCheby-438"><a href="#SORCheby-438"><span class="linenos">438</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="SORCheby-439"><a href="#SORCheby-439"><span class="linenos">439</span></a>
</span><span id="SORCheby-440"><a href="#SORCheby-440"><span class="linenos">440</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORCheby-441"><a href="#SORCheby-441"><span class="linenos">441</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution tensor.&quot;&quot;&quot;</span>
</span><span id="SORCheby-442"><a href="#SORCheby-442"><span class="linenos">442</span></a>
</span><span id="SORCheby-443"><a href="#SORCheby-443"><span class="linenos">443</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORCheby-444"><a href="#SORCheby-444"><span class="linenos">444</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Original matrix converted to a torch tensor.&quot;&quot;&quot;</span>
</span><span id="SORCheby-445"><a href="#SORCheby-445"><span class="linenos">445</span></a>
</span><span id="SORCheby-446"><a href="#SORCheby-446"><span class="linenos">446</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORCheby-447"><a href="#SORCheby-447"><span class="linenos">447</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="SORCheby-448"><a href="#SORCheby-448"><span class="linenos">448</span></a>
</span><span id="SORCheby-449"><a href="#SORCheby-449"><span class="linenos">449</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORCheby-450"><a href="#SORCheby-450"><span class="linenos">450</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="SORCheby-451"><a href="#SORCheby-451"><span class="linenos">451</span></a>
</span><span id="SORCheby-452"><a href="#SORCheby-452"><span class="linenos">452</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORCheby-453"><a href="#SORCheby-453"><span class="linenos">453</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix of $A$.&quot;&quot;&quot;</span>
</span><span id="SORCheby-454"><a href="#SORCheby-454"><span class="linenos">454</span></a>
</span><span id="SORCheby-455"><a href="#SORCheby-455"><span class="linenos">455</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORCheby-456"><a href="#SORCheby-456"><span class="linenos">456</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="SORCheby-457"><a href="#SORCheby-457"><span class="linenos">457</span></a>
</span><span id="SORCheby-458"><a href="#SORCheby-458"><span class="linenos">458</span></a>    <span class="n">Minv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORCheby-459"><a href="#SORCheby-459"><span class="linenos">459</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the matrix $D + L$.&quot;&quot;&quot;</span>
</span><span id="SORCheby-460"><a href="#SORCheby-460"><span class="linenos">460</span></a>
</span><span id="SORCheby-461"><a href="#SORCheby-461"><span class="linenos">461</span></a>    <span class="n">omega</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORCheby-462"><a href="#SORCheby-462"><span class="linenos">462</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Relaxation parameter for SOR iterations.&quot;&quot;&quot;</span>
</span><span id="SORCheby-463"><a href="#SORCheby-463"><span class="linenos">463</span></a>
</span><span id="SORCheby-464"><a href="#SORCheby-464"><span class="linenos">464</span></a>    <span class="n">omegaa</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORCheby-465"><a href="#SORCheby-465"><span class="linenos">465</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Acceleration parameter for SOR-Chebyshev iterations.&quot;&quot;&quot;</span>
</span><span id="SORCheby-466"><a href="#SORCheby-466"><span class="linenos">466</span></a>
</span><span id="SORCheby-467"><a href="#SORCheby-467"><span class="linenos">467</span></a>    <span class="n">gamma</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORCheby-468"><a href="#SORCheby-468"><span class="linenos">468</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Damping factor for SOR-Chebyshev iterations.&quot;&quot;&quot;</span>
</span><span id="SORCheby-469"><a href="#SORCheby-469"><span class="linenos">469</span></a>
</span><span id="SORCheby-470"><a href="#SORCheby-470"><span class="linenos">470</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SORCheby-471"><a href="#SORCheby-471"><span class="linenos">471</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SORCheby-472"><a href="#SORCheby-472"><span class="linenos">472</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SORCheby-473"><a href="#SORCheby-473"><span class="linenos">473</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
</span><span id="SORCheby-474"><a href="#SORCheby-474"><span class="linenos">474</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORCheby-475"><a href="#SORCheby-475"><span class="linenos">475</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SORCheby-476"><a href="#SORCheby-476"><span class="linenos">476</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORCheby-477"><a href="#SORCheby-477"><span class="linenos">477</span></a>        <span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.8</span><span class="p">,</span>
</span><span id="SORCheby-478"><a href="#SORCheby-478"><span class="linenos">478</span></a>        <span class="n">omegaa</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="SORCheby-479"><a href="#SORCheby-479"><span class="linenos">479</span></a>        <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="SORCheby-480"><a href="#SORCheby-480"><span class="linenos">480</span></a>    <span class="p">):</span>
</span><span id="SORCheby-481"><a href="#SORCheby-481"><span class="linenos">481</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the SOR-Chebyshev solver.</span>
</span><span id="SORCheby-482"><a href="#SORCheby-482"><span class="linenos">482</span></a>
</span><span id="SORCheby-483"><a href="#SORCheby-483"><span class="linenos">483</span></a><span class="sd">        Args:</span>
</span><span id="SORCheby-484"><a href="#SORCheby-484"><span class="linenos">484</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="SORCheby-485"><a href="#SORCheby-485"><span class="linenos">485</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="SORCheby-486"><a href="#SORCheby-486"><span class="linenos">486</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="SORCheby-487"><a href="#SORCheby-487"><span class="linenos">487</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="SORCheby-488"><a href="#SORCheby-488"><span class="linenos">488</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="SORCheby-489"><a href="#SORCheby-489"><span class="linenos">489</span></a><span class="sd">          omega: Relaxation parameter for SOR iterations.</span>
</span><span id="SORCheby-490"><a href="#SORCheby-490"><span class="linenos">490</span></a><span class="sd">          omegaa: Acceleration parameter for SOR-Chebyshev iterations.</span>
</span><span id="SORCheby-491"><a href="#SORCheby-491"><span class="linenos">491</span></a><span class="sd">          gamma: Damping factor for SOR-Chebyshev iterations.</span>
</span><span id="SORCheby-492"><a href="#SORCheby-492"><span class="linenos">492</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORCheby-493"><a href="#SORCheby-493"><span class="linenos">493</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">SORCheby</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="SORCheby-494"><a href="#SORCheby-494"><span class="linenos">494</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</span><span id="SORCheby-495"><a href="#SORCheby-495"><span class="linenos">495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omegaa</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omegaa</span><span class="p">)</span>
</span><span id="SORCheby-496"><a href="#SORCheby-496"><span class="linenos">496</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span>
</span><span id="SORCheby-497"><a href="#SORCheby-497"><span class="linenos">497</span></a>
</span><span id="SORCheby-498"><a href="#SORCheby-498"><span class="linenos">498</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="SORCheby-499"><a href="#SORCheby-499"><span class="linenos">499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the SOR-Chebyshev iterations and returns the final solution</span>
</span><span id="SORCheby-500"><a href="#SORCheby-500"><span class="linenos">500</span></a><span class="sd">          and trajectory of solutions.</span>
</span><span id="SORCheby-501"><a href="#SORCheby-501"><span class="linenos">501</span></a>
</span><span id="SORCheby-502"><a href="#SORCheby-502"><span class="linenos">502</span></a><span class="sd">        Args:</span>
</span><span id="SORCheby-503"><a href="#SORCheby-503"><span class="linenos">503</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="SORCheby-504"><a href="#SORCheby-504"><span class="linenos">504</span></a>
</span><span id="SORCheby-505"><a href="#SORCheby-505"><span class="linenos">505</span></a><span class="sd">        Returns:</span>
</span><span id="SORCheby-506"><a href="#SORCheby-506"><span class="linenos">506</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="SORCheby-507"><a href="#SORCheby-507"><span class="linenos">507</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="SORCheby-508"><a href="#SORCheby-508"><span class="linenos">508</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="SORCheby-509"><a href="#SORCheby-509"><span class="linenos">509</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORCheby-510"><a href="#SORCheby-510"><span class="linenos">510</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SORCheby-511"><a href="#SORCheby-511"><span class="linenos">511</span></a>
</span><span id="SORCheby-512"><a href="#SORCheby-512"><span class="linenos">512</span></a>        <span class="n">inv_omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">)</span>
</span><span id="SORCheby-513"><a href="#SORCheby-513"><span class="linenos">513</span></a>        <span class="n">m_inv_sor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">inv_omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">))</span>
</span><span id="SORCheby-514"><a href="#SORCheby-514"><span class="linenos">514</span></a>
</span><span id="SORCheby-515"><a href="#SORCheby-515"><span class="linenos">515</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORCheby-516"><a href="#SORCheby-516"><span class="linenos">516</span></a>        <span class="n">s_new</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORCheby-517"><a href="#SORCheby-517"><span class="linenos">517</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SORCheby-518"><a href="#SORCheby-518"><span class="linenos">518</span></a>
</span><span id="SORCheby-519"><a href="#SORCheby-519"><span class="linenos">519</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="SORCheby-520"><a href="#SORCheby-520"><span class="linenos">520</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="SORCheby-521"><a href="#SORCheby-521"><span class="linenos">521</span></a>
</span><span id="SORCheby-522"><a href="#SORCheby-522"><span class="linenos">522</span></a>        <span class="n">s_present</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="SORCheby-523"><a href="#SORCheby-523"><span class="linenos">523</span></a>        <span class="n">s_old</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">s_present</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORCheby-524"><a href="#SORCheby-524"><span class="linenos">524</span></a>
</span><span id="SORCheby-525"><a href="#SORCheby-525"><span class="linenos">525</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="SORCheby-526"><a href="#SORCheby-526"><span class="linenos">526</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="n">inv_omega</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">inv_omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span>
</span><span id="SORCheby-527"><a href="#SORCheby-527"><span class="linenos">527</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv_sor</span><span class="p">,</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span>
</span><span id="SORCheby-528"><a href="#SORCheby-528"><span class="linenos">528</span></a>                <span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv_sor</span>
</span><span id="SORCheby-529"><a href="#SORCheby-529"><span class="linenos">529</span></a>            <span class="p">)</span>
</span><span id="SORCheby-530"><a href="#SORCheby-530"><span class="linenos">530</span></a>
</span><span id="SORCheby-531"><a href="#SORCheby-531"><span class="linenos">531</span></a>            <span class="n">s_new</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SORCheby-532"><a href="#SORCheby-532"><span class="linenos">532</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">omegaa</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">s_present</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s_present</span> <span class="o">-</span> <span class="n">s_old</span><span class="p">))</span>
</span><span id="SORCheby-533"><a href="#SORCheby-533"><span class="linenos">533</span></a>                <span class="o">+</span> <span class="n">s_old</span>
</span><span id="SORCheby-534"><a href="#SORCheby-534"><span class="linenos">534</span></a>            <span class="p">)</span>
</span><span id="SORCheby-535"><a href="#SORCheby-535"><span class="linenos">535</span></a>            <span class="n">s_old</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="SORCheby-536"><a href="#SORCheby-536"><span class="linenos">536</span></a>            <span class="n">s_present</span> <span class="o">=</span> <span class="n">s_new</span>
</span><span id="SORCheby-537"><a href="#SORCheby-537"><span class="linenos">537</span></a>
</span><span id="SORCheby-538"><a href="#SORCheby-538"><span class="linenos">538</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_new</span><span class="p">)</span>
</span><span id="SORCheby-539"><a href="#SORCheby-539"><span class="linenos">539</span></a>
</span><span id="SORCheby-540"><a href="#SORCheby-540"><span class="linenos">540</span></a>        <span class="k">return</span> <span class="n">s_new</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Class implementing the SOR-Chebyshev algorithm for solving a linear system.</p>
</div>


                            <div id="SORCheby.__init__" class="classattr">
                                        <input id="SORCheby.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SORCheby</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">+</span><span class="n">_ScalarType_co</span><span class="p">]]</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.8</span>,</span><span class="param">	<span class="n">omegaa</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span>,</span><span class="param">	<span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span></span>)</span>

                <label class="view-source-button" for="SORCheby.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SORCheby.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SORCheby.__init__-470"><a href="#SORCheby.__init__-470"><span class="linenos">470</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SORCheby.__init__-471"><a href="#SORCheby.__init__-471"><span class="linenos">471</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SORCheby.__init__-472"><a href="#SORCheby.__init__-472"><span class="linenos">472</span></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SORCheby.__init__-473"><a href="#SORCheby.__init__-473"><span class="linenos">473</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
</span><span id="SORCheby.__init__-474"><a href="#SORCheby.__init__-474"><span class="linenos">474</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORCheby.__init__-475"><a href="#SORCheby.__init__-475"><span class="linenos">475</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SORCheby.__init__-476"><a href="#SORCheby.__init__-476"><span class="linenos">476</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORCheby.__init__-477"><a href="#SORCheby.__init__-477"><span class="linenos">477</span></a>        <span class="n">omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.8</span><span class="p">,</span>
</span><span id="SORCheby.__init__-478"><a href="#SORCheby.__init__-478"><span class="linenos">478</span></a>        <span class="n">omegaa</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="SORCheby.__init__-479"><a href="#SORCheby.__init__-479"><span class="linenos">479</span></a>        <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="SORCheby.__init__-480"><a href="#SORCheby.__init__-480"><span class="linenos">480</span></a>    <span class="p">):</span>
</span><span id="SORCheby.__init__-481"><a href="#SORCheby.__init__-481"><span class="linenos">481</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the SOR-Chebyshev solver.</span>
</span><span id="SORCheby.__init__-482"><a href="#SORCheby.__init__-482"><span class="linenos">482</span></a>
</span><span id="SORCheby.__init__-483"><a href="#SORCheby.__init__-483"><span class="linenos">483</span></a><span class="sd">        Args:</span>
</span><span id="SORCheby.__init__-484"><a href="#SORCheby.__init__-484"><span class="linenos">484</span></a><span class="sd">          n: Dimension of the solution.</span>
</span><span id="SORCheby.__init__-485"><a href="#SORCheby.__init__-485"><span class="linenos">485</span></a><span class="sd">          a: Input square matrix to decompose.</span>
</span><span id="SORCheby.__init__-486"><a href="#SORCheby.__init__-486"><span class="linenos">486</span></a><span class="sd">          h: Random matrix $H$.</span>
</span><span id="SORCheby.__init__-487"><a href="#SORCheby.__init__-487"><span class="linenos">487</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="SORCheby.__init__-488"><a href="#SORCheby.__init__-488"><span class="linenos">488</span></a><span class="sd">          y: Solution tensor.</span>
</span><span id="SORCheby.__init__-489"><a href="#SORCheby.__init__-489"><span class="linenos">489</span></a><span class="sd">          omega: Relaxation parameter for SOR iterations.</span>
</span><span id="SORCheby.__init__-490"><a href="#SORCheby.__init__-490"><span class="linenos">490</span></a><span class="sd">          omegaa: Acceleration parameter for SOR-Chebyshev iterations.</span>
</span><span id="SORCheby.__init__-491"><a href="#SORCheby.__init__-491"><span class="linenos">491</span></a><span class="sd">          gamma: Damping factor for SOR-Chebyshev iterations.</span>
</span><span id="SORCheby.__init__-492"><a href="#SORCheby.__init__-492"><span class="linenos">492</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORCheby.__init__-493"><a href="#SORCheby.__init__-493"><span class="linenos">493</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">SORCheby</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="SORCheby.__init__-494"><a href="#SORCheby.__init__-494"><span class="linenos">494</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</span><span id="SORCheby.__init__-495"><a href="#SORCheby.__init__-495"><span class="linenos">495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omegaa</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">omegaa</span><span class="p">)</span>
</span><span id="SORCheby.__init__-496"><a href="#SORCheby.__init__-496"><span class="linenos">496</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the SOR-Chebyshev solver.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n:</strong>  Dimension of the solution.</li>
<li><strong>a:</strong>  Input square matrix to decompose.</li>
<li><strong>h:</strong>  Random matrix $H$.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution tensor.</li>
<li><strong>omega:</strong>  Relaxation parameter for SOR iterations.</li>
<li><strong>omegaa:</strong>  Acceleration parameter for SOR-Chebyshev iterations.</li>
<li><strong>gamma:</strong>  Damping factor for SOR-Chebyshev iterations.</li>
</ul>
</div>


                            </div>
                            <div id="SORCheby.n" class="classattr">
                                <div class="attr variable">
            <span class="name">n</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.n"></a>
    
            <div class="docstring"><p>Dimension of the solution.</p>
</div>


                            </div>
                            <div id="SORCheby.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.H"></a>
    
            <div class="docstring"><p>Random matrix $H$.</p>
</div>


                            </div>
                            <div id="SORCheby.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="SORCheby.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.y"></a>
    
            <div class="docstring"><p>Solution tensor.</p>
</div>


                            </div>
                            <div id="SORCheby.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.A"></a>
    
            <div class="docstring"><p>Original matrix converted to a torch tensor.</p>
</div>


                            </div>
                            <div id="SORCheby.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.D"></a>
    
            <div class="docstring"><p>Diagonal matrix of $A$.</p>
</div>


                            </div>
                            <div id="SORCheby.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="SORCheby.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix of $A$.</p>
</div>


                            </div>
                            <div id="SORCheby.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="SORCheby.Minv" class="classattr">
                                <div class="attr variable">
            <span class="name">Minv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.Minv"></a>
    
            <div class="docstring"><p>Inverse of the matrix $D + L$.</p>
</div>


                            </div>
                            <div id="SORCheby.omega" class="classattr">
                                <div class="attr variable">
            <span class="name">omega</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.omega"></a>
    
            <div class="docstring"><p>Relaxation parameter for SOR iterations.</p>
</div>


                            </div>
                            <div id="SORCheby.omegaa" class="classattr">
                                <div class="attr variable">
            <span class="name">omegaa</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.omegaa"></a>
    
            <div class="docstring"><p>Acceleration parameter for SOR-Chebyshev iterations.</p>
</div>


                            </div>
                            <div id="SORCheby.gamma" class="classattr">
                                <div class="attr variable">
            <span class="name">gamma</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORCheby.gamma"></a>
    
            <div class="docstring"><p>Damping factor for SOR-Chebyshev iterations.</p>
</div>


                            </div>
                            <div id="SORCheby.iterate" class="classattr">
                                        <input id="SORCheby.iterate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iterate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="SORCheby.iterate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SORCheby.iterate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SORCheby.iterate-498"><a href="#SORCheby.iterate-498"><span class="linenos">498</span></a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="SORCheby.iterate-499"><a href="#SORCheby.iterate-499"><span class="linenos">499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the SOR-Chebyshev iterations and returns the final solution</span>
</span><span id="SORCheby.iterate-500"><a href="#SORCheby.iterate-500"><span class="linenos">500</span></a><span class="sd">          and trajectory of solutions.</span>
</span><span id="SORCheby.iterate-501"><a href="#SORCheby.iterate-501"><span class="linenos">501</span></a>
</span><span id="SORCheby.iterate-502"><a href="#SORCheby.iterate-502"><span class="linenos">502</span></a><span class="sd">        Args:</span>
</span><span id="SORCheby.iterate-503"><a href="#SORCheby.iterate-503"><span class="linenos">503</span></a><span class="sd">          num_itr: The number of iterations to perform.</span>
</span><span id="SORCheby.iterate-504"><a href="#SORCheby.iterate-504"><span class="linenos">504</span></a>
</span><span id="SORCheby.iterate-505"><a href="#SORCheby.iterate-505"><span class="linenos">505</span></a><span class="sd">        Returns:</span>
</span><span id="SORCheby.iterate-506"><a href="#SORCheby.iterate-506"><span class="linenos">506</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="SORCheby.iterate-507"><a href="#SORCheby.iterate-507"><span class="linenos">507</span></a><span class="sd">            - The final solution tensor of shape (`bs`, `n`).</span>
</span><span id="SORCheby.iterate-508"><a href="#SORCheby.iterate-508"><span class="linenos">508</span></a><span class="sd">            - List containing the trajectory of solutions throughout the iterations.</span>
</span><span id="SORCheby.iterate-509"><a href="#SORCheby.iterate-509"><span class="linenos">509</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORCheby.iterate-510"><a href="#SORCheby.iterate-510"><span class="linenos">510</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SORCheby.iterate-511"><a href="#SORCheby.iterate-511"><span class="linenos">511</span></a>
</span><span id="SORCheby.iterate-512"><a href="#SORCheby.iterate-512"><span class="linenos">512</span></a>        <span class="n">inv_omega</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">)</span>
</span><span id="SORCheby.iterate-513"><a href="#SORCheby.iterate-513"><span class="linenos">513</span></a>        <span class="n">m_inv_sor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">inv_omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">))</span>
</span><span id="SORCheby.iterate-514"><a href="#SORCheby.iterate-514"><span class="linenos">514</span></a>
</span><span id="SORCheby.iterate-515"><a href="#SORCheby.iterate-515"><span class="linenos">515</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORCheby.iterate-516"><a href="#SORCheby.iterate-516"><span class="linenos">516</span></a>        <span class="n">s_new</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORCheby.iterate-517"><a href="#SORCheby.iterate-517"><span class="linenos">517</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SORCheby.iterate-518"><a href="#SORCheby.iterate-518"><span class="linenos">518</span></a>
</span><span id="SORCheby.iterate-519"><a href="#SORCheby.iterate-519"><span class="linenos">519</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="SORCheby.iterate-520"><a href="#SORCheby.iterate-520"><span class="linenos">520</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="SORCheby.iterate-521"><a href="#SORCheby.iterate-521"><span class="linenos">521</span></a>
</span><span id="SORCheby.iterate-522"><a href="#SORCheby.iterate-522"><span class="linenos">522</span></a>        <span class="n">s_present</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="SORCheby.iterate-523"><a href="#SORCheby.iterate-523"><span class="linenos">523</span></a>        <span class="n">s_old</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">s_present</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORCheby.iterate-524"><a href="#SORCheby.iterate-524"><span class="linenos">524</span></a>
</span><span id="SORCheby.iterate-525"><a href="#SORCheby.iterate-525"><span class="linenos">525</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="SORCheby.iterate-526"><a href="#SORCheby.iterate-526"><span class="linenos">526</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">((</span><span class="n">inv_omega</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">inv_omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span>
</span><span id="SORCheby.iterate-527"><a href="#SORCheby.iterate-527"><span class="linenos">527</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">m_inv_sor</span><span class="p">,</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span>
</span><span id="SORCheby.iterate-528"><a href="#SORCheby.iterate-528"><span class="linenos">528</span></a>                <span class="n">yMF</span><span class="p">,</span> <span class="n">m_inv_sor</span>
</span><span id="SORCheby.iterate-529"><a href="#SORCheby.iterate-529"><span class="linenos">529</span></a>            <span class="p">)</span>
</span><span id="SORCheby.iterate-530"><a href="#SORCheby.iterate-530"><span class="linenos">530</span></a>
</span><span id="SORCheby.iterate-531"><a href="#SORCheby.iterate-531"><span class="linenos">531</span></a>            <span class="n">s_new</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SORCheby.iterate-532"><a href="#SORCheby.iterate-532"><span class="linenos">532</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">omegaa</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">s_present</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s_present</span> <span class="o">-</span> <span class="n">s_old</span><span class="p">))</span>
</span><span id="SORCheby.iterate-533"><a href="#SORCheby.iterate-533"><span class="linenos">533</span></a>                <span class="o">+</span> <span class="n">s_old</span>
</span><span id="SORCheby.iterate-534"><a href="#SORCheby.iterate-534"><span class="linenos">534</span></a>            <span class="p">)</span>
</span><span id="SORCheby.iterate-535"><a href="#SORCheby.iterate-535"><span class="linenos">535</span></a>            <span class="n">s_old</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="SORCheby.iterate-536"><a href="#SORCheby.iterate-536"><span class="linenos">536</span></a>            <span class="n">s_present</span> <span class="o">=</span> <span class="n">s_new</span>
</span><span id="SORCheby.iterate-537"><a href="#SORCheby.iterate-537"><span class="linenos">537</span></a>
</span><span id="SORCheby.iterate-538"><a href="#SORCheby.iterate-538"><span class="linenos">538</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_new</span><span class="p">)</span>
</span><span id="SORCheby.iterate-539"><a href="#SORCheby.iterate-539"><span class="linenos">539</span></a>
</span><span id="SORCheby.iterate-540"><a href="#SORCheby.iterate-540"><span class="linenos">540</span></a>        <span class="k">return</span> <span class="n">s_new</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Performs the SOR-Chebyshev iterations and returns the final solution
  and trajectory of solutions.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  The number of iterations to perform.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>The final solution tensor of shape (<code><a href="#SORCheby.bs">bs</a></code>, <code><a href="#SORCheby.n">n</a></code>).</li>
  <li>List containing the trajectory of solutions throughout the iterations.</li>
  </ul>
</blockquote>
</div>


                            </div>
                </section>
                <section id="SORChebyNet">
                            <input id="SORChebyNet-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SORChebyNet</span><wbr>(<span class="base">torch.nn.modules.module.Module</span>):

                <label class="view-source-button" for="SORChebyNet-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SORChebyNet"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SORChebyNet-177"><a href="#SORChebyNet-177"><span class="linenos">177</span></a><span class="k">class</span> <span class="nc">SORChebyNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span id="SORChebyNet-178"><a href="#SORChebyNet-178"><span class="linenos">178</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Deep unfolded SOR with Chebyshev acceleration.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-179"><a href="#SORChebyNet-179"><span class="linenos">179</span></a>
</span><span id="SORChebyNet-180"><a href="#SORChebyNet-180"><span class="linenos">180</span></a>    <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span>
</span><span id="SORChebyNet-181"><a href="#SORChebyNet-181"><span class="linenos">181</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Device to run the model on.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-182"><a href="#SORChebyNet-182"><span class="linenos">182</span></a>
</span><span id="SORChebyNet-183"><a href="#SORChebyNet-183"><span class="linenos">183</span></a>    <span class="n">gamma</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span>
</span><span id="SORChebyNet-184"><a href="#SORChebyNet-184"><span class="linenos">184</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gamma parameter for each iteration.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-185"><a href="#SORChebyNet-185"><span class="linenos">185</span></a>
</span><span id="SORChebyNet-186"><a href="#SORChebyNet-186"><span class="linenos">186</span></a>    <span class="n">omega</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span>
</span><span id="SORChebyNet-187"><a href="#SORChebyNet-187"><span class="linenos">187</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Omega parameter for each iteration.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-188"><a href="#SORChebyNet-188"><span class="linenos">188</span></a>
</span><span id="SORChebyNet-189"><a href="#SORChebyNet-189"><span class="linenos">189</span></a>    <span class="n">inv_omega</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span>
</span><span id="SORChebyNet-190"><a href="#SORChebyNet-190"><span class="linenos">190</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the relaxation parameter omega.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-191"><a href="#SORChebyNet-191"><span class="linenos">191</span></a>
</span><span id="SORChebyNet-192"><a href="#SORChebyNet-192"><span class="linenos">192</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORChebyNet-193"><a href="#SORChebyNet-193"><span class="linenos">193</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix $A$ of the linear system.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-194"><a href="#SORChebyNet-194"><span class="linenos">194</span></a>
</span><span id="SORChebyNet-195"><a href="#SORChebyNet-195"><span class="linenos">195</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORChebyNet-196"><a href="#SORChebyNet-196"><span class="linenos">196</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-197"><a href="#SORChebyNet-197"><span class="linenos">197</span></a>
</span><span id="SORChebyNet-198"><a href="#SORChebyNet-198"><span class="linenos">198</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORChebyNet-199"><a href="#SORChebyNet-199"><span class="linenos">199</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix $L$.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-200"><a href="#SORChebyNet-200"><span class="linenos">200</span></a>
</span><span id="SORChebyNet-201"><a href="#SORChebyNet-201"><span class="linenos">201</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORChebyNet-202"><a href="#SORChebyNet-202"><span class="linenos">202</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix $U$.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-203"><a href="#SORChebyNet-203"><span class="linenos">203</span></a>
</span><span id="SORChebyNet-204"><a href="#SORChebyNet-204"><span class="linenos">204</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORChebyNet-205"><a href="#SORChebyNet-205"><span class="linenos">205</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix $H$.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-206"><a href="#SORChebyNet-206"><span class="linenos">206</span></a>
</span><span id="SORChebyNet-207"><a href="#SORChebyNet-207"><span class="linenos">207</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORChebyNet-208"><a href="#SORChebyNet-208"><span class="linenos">208</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-209"><a href="#SORChebyNet-209"><span class="linenos">209</span></a>
</span><span id="SORChebyNet-210"><a href="#SORChebyNet-210"><span class="linenos">210</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SORChebyNet-211"><a href="#SORChebyNet-211"><span class="linenos">211</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-212"><a href="#SORChebyNet-212"><span class="linenos">212</span></a>
</span><span id="SORChebyNet-213"><a href="#SORChebyNet-213"><span class="linenos">213</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORChebyNet-214"><a href="#SORChebyNet-214"><span class="linenos">214</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution of the linear equation.&quot;&quot;&quot;</span>
</span><span id="SORChebyNet-215"><a href="#SORChebyNet-215"><span class="linenos">215</span></a>
</span><span id="SORChebyNet-216"><a href="#SORChebyNet-216"><span class="linenos">216</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SORChebyNet-217"><a href="#SORChebyNet-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SORChebyNet-218"><a href="#SORChebyNet-218"><span class="linenos">218</span></a>        <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SORChebyNet-219"><a href="#SORChebyNet-219"><span class="linenos">219</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORChebyNet-220"><a href="#SORChebyNet-220"><span class="linenos">220</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORChebyNet-221"><a href="#SORChebyNet-221"><span class="linenos">221</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SORChebyNet-222"><a href="#SORChebyNet-222"><span class="linenos">222</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORChebyNet-223"><a href="#SORChebyNet-223"><span class="linenos">223</span></a>        <span class="n">init_val_SOR_CHEBY_Net_omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
</span><span id="SORChebyNet-224"><a href="#SORChebyNet-224"><span class="linenos">224</span></a>        <span class="n">init_val_SOR_CHEBY_Net_gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="SORChebyNet-225"><a href="#SORChebyNet-225"><span class="linenos">225</span></a>        <span class="n">init_val_SOR_CHEBY_Net_alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
</span><span id="SORChebyNet-226"><a href="#SORChebyNet-226"><span class="linenos">226</span></a>        <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">,</span>
</span><span id="SORChebyNet-227"><a href="#SORChebyNet-227"><span class="linenos">227</span></a>    <span class="p">):</span>
</span><span id="SORChebyNet-228"><a href="#SORChebyNet-228"><span class="linenos">228</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the SOR_CHEBY_Net model.</span>
</span><span id="SORChebyNet-229"><a href="#SORChebyNet-229"><span class="linenos">229</span></a>
</span><span id="SORChebyNet-230"><a href="#SORChebyNet-230"><span class="linenos">230</span></a><span class="sd">        Args:</span>
</span><span id="SORChebyNet-231"><a href="#SORChebyNet-231"><span class="linenos">231</span></a><span class="sd">          num_itr: Number of iterations.</span>
</span><span id="SORChebyNet-232"><a href="#SORChebyNet-232"><span class="linenos">232</span></a><span class="sd">          a: Matrix $A$ of the linear system.</span>
</span><span id="SORChebyNet-233"><a href="#SORChebyNet-233"><span class="linenos">233</span></a><span class="sd">          h: Matrix $H$.</span>
</span><span id="SORChebyNet-234"><a href="#SORChebyNet-234"><span class="linenos">234</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="SORChebyNet-235"><a href="#SORChebyNet-235"><span class="linenos">235</span></a><span class="sd">          y: Solution of the linear equation.</span>
</span><span id="SORChebyNet-236"><a href="#SORChebyNet-236"><span class="linenos">236</span></a><span class="sd">          init_val_SOR_CHEBY_Net_omega: Initial value for `omega`.</span>
</span><span id="SORChebyNet-237"><a href="#SORChebyNet-237"><span class="linenos">237</span></a><span class="sd">          init_val_SOR_CHEBY_Net_gamma: Initial value for `gamma`.</span>
</span><span id="SORChebyNet-238"><a href="#SORChebyNet-238"><span class="linenos">238</span></a><span class="sd">          init_val_SOR_CHEBY_Net_alpha: Initial value for `inv_omega`.</span>
</span><span id="SORChebyNet-239"><a href="#SORChebyNet-239"><span class="linenos">239</span></a><span class="sd">          device: Device to run the model on (&#39;cpu&#39; or &#39;cuda&#39;).</span>
</span><span id="SORChebyNet-240"><a href="#SORChebyNet-240"><span class="linenos">240</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORChebyNet-241"><a href="#SORChebyNet-241"><span class="linenos">241</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">SORChebyNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="SORChebyNet-242"><a href="#SORChebyNet-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
</span><span id="SORChebyNet-243"><a href="#SORChebyNet-243"><span class="linenos">243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span>
</span><span id="SORChebyNet-244"><a href="#SORChebyNet-244"><span class="linenos">244</span></a>            <span class="n">init_val_SOR_CHEBY_Net_gamma</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_itr</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet-245"><a href="#SORChebyNet-245"><span class="linenos">245</span></a>        <span class="p">)</span>
</span><span id="SORChebyNet-246"><a href="#SORChebyNet-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span>
</span><span id="SORChebyNet-247"><a href="#SORChebyNet-247"><span class="linenos">247</span></a>            <span class="n">init_val_SOR_CHEBY_Net_omega</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_itr</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet-248"><a href="#SORChebyNet-248"><span class="linenos">248</span></a>        <span class="p">)</span>
</span><span id="SORChebyNet-249"><a href="#SORChebyNet-249"><span class="linenos">249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span>
</span><span id="SORChebyNet-250"><a href="#SORChebyNet-250"><span class="linenos">250</span></a>            <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_val_SOR_CHEBY_Net_alpha</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet-251"><a href="#SORChebyNet-251"><span class="linenos">251</span></a>        <span class="p">)</span>
</span><span id="SORChebyNet-252"><a href="#SORChebyNet-252"><span class="linenos">252</span></a>
</span><span id="SORChebyNet-253"><a href="#SORChebyNet-253"><span class="linenos">253</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">decompose_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="SORChebyNet-254"><a href="#SORChebyNet-254"><span class="linenos">254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span>
</span><span id="SORChebyNet-255"><a href="#SORChebyNet-255"><span class="linenos">255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet-256"><a href="#SORChebyNet-256"><span class="linenos">256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet-257"><a href="#SORChebyNet-257"><span class="linenos">257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet-258"><a href="#SORChebyNet-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet-259"><a href="#SORChebyNet-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet-260"><a href="#SORChebyNet-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span>
</span><span id="SORChebyNet-261"><a href="#SORChebyNet-261"><span class="linenos">261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet-262"><a href="#SORChebyNet-262"><span class="linenos">262</span></a>
</span><span id="SORChebyNet-263"><a href="#SORChebyNet-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]:</span>
</span><span id="SORChebyNet-264"><a href="#SORChebyNet-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform forward pass of the SOR_CHEBY_Net model.</span>
</span><span id="SORChebyNet-265"><a href="#SORChebyNet-265"><span class="linenos">265</span></a>
</span><span id="SORChebyNet-266"><a href="#SORChebyNet-266"><span class="linenos">266</span></a><span class="sd">        Args:</span>
</span><span id="SORChebyNet-267"><a href="#SORChebyNet-267"><span class="linenos">267</span></a><span class="sd">          num_itr: Number of iterations.</span>
</span><span id="SORChebyNet-268"><a href="#SORChebyNet-268"><span class="linenos">268</span></a>
</span><span id="SORChebyNet-269"><a href="#SORChebyNet-269"><span class="linenos">269</span></a><span class="sd">        Returns:</span>
</span><span id="SORChebyNet-270"><a href="#SORChebyNet-270"><span class="linenos">270</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="SORChebyNet-271"><a href="#SORChebyNet-271"><span class="linenos">271</span></a><span class="sd">            - Output tensor.</span>
</span><span id="SORChebyNet-272"><a href="#SORChebyNet-272"><span class="linenos">272</span></a><span class="sd">            - List of intermediate results.</span>
</span><span id="SORChebyNet-273"><a href="#SORChebyNet-273"><span class="linenos">273</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORChebyNet-274"><a href="#SORChebyNet-274"><span class="linenos">274</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SORChebyNet-275"><a href="#SORChebyNet-275"><span class="linenos">275</span></a>
</span><span id="SORChebyNet-276"><a href="#SORChebyNet-276"><span class="linenos">276</span></a>        <span class="n">m_inv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="SORChebyNet-277"><a href="#SORChebyNet-277"><span class="linenos">277</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># modif to size(0)</span>
</span><span id="SORChebyNet-278"><a href="#SORChebyNet-278"><span class="linenos">278</span></a>        <span class="n">s_new</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="SORChebyNet-279"><a href="#SORChebyNet-279"><span class="linenos">279</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span>
</span><span id="SORChebyNet-280"><a href="#SORChebyNet-280"><span class="linenos">280</span></a>        <span class="p">)</span>  <span class="c1"># modif to size(0)</span>
</span><span id="SORChebyNet-281"><a href="#SORChebyNet-281"><span class="linenos">281</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SORChebyNet-282"><a href="#SORChebyNet-282"><span class="linenos">282</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="SORChebyNet-283"><a href="#SORChebyNet-283"><span class="linenos">283</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="SORChebyNet-284"><a href="#SORChebyNet-284"><span class="linenos">284</span></a>        <span class="n">s_present</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="SORChebyNet-285"><a href="#SORChebyNet-285"><span class="linenos">285</span></a>        <span class="n">s_old</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">s_present</span><span class="p">)</span>
</span><span id="SORChebyNet-286"><a href="#SORChebyNet-286"><span class="linenos">286</span></a>
</span><span id="SORChebyNet-287"><a href="#SORChebyNet-287"><span class="linenos">287</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="SORChebyNet-288"><a href="#SORChebyNet-288"><span class="linenos">288</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span> <span class="o">+</span> <span class="n">yMF</span>
</span><span id="SORChebyNet-289"><a href="#SORChebyNet-289"><span class="linenos">289</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">m_inv</span><span class="p">)</span>
</span><span id="SORChebyNet-290"><a href="#SORChebyNet-290"><span class="linenos">290</span></a>
</span><span id="SORChebyNet-291"><a href="#SORChebyNet-291"><span class="linenos">291</span></a>            <span class="n">s_new</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SORChebyNet-292"><a href="#SORChebyNet-292"><span class="linenos">292</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">s_present</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s_present</span> <span class="o">-</span> <span class="n">s_old</span><span class="p">))</span>
</span><span id="SORChebyNet-293"><a href="#SORChebyNet-293"><span class="linenos">293</span></a>                <span class="o">+</span> <span class="n">s_old</span>
</span><span id="SORChebyNet-294"><a href="#SORChebyNet-294"><span class="linenos">294</span></a>            <span class="p">)</span>
</span><span id="SORChebyNet-295"><a href="#SORChebyNet-295"><span class="linenos">295</span></a>            <span class="n">s_old</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="SORChebyNet-296"><a href="#SORChebyNet-296"><span class="linenos">296</span></a>            <span class="n">s_present</span> <span class="o">=</span> <span class="n">s_new</span>
</span><span id="SORChebyNet-297"><a href="#SORChebyNet-297"><span class="linenos">297</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_new</span><span class="p">)</span>
</span><span id="SORChebyNet-298"><a href="#SORChebyNet-298"><span class="linenos">298</span></a>
</span><span id="SORChebyNet-299"><a href="#SORChebyNet-299"><span class="linenos">299</span></a>        <span class="k">return</span> <span class="n">s_new</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Deep unfolded SOR with Chebyshev acceleration.</p>
</div>


                            <div id="SORChebyNet.__init__" class="classattr">
                                        <input id="SORChebyNet.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SORChebyNet</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">init_val_SOR_CHEBY_Net_omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span>,</span><span class="param">	<span class="n">init_val_SOR_CHEBY_Net_gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span>,</span><span class="param">	<span class="n">init_val_SOR_CHEBY_Net_alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span>,</span><span class="param">	<span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span></span>)</span>

                <label class="view-source-button" for="SORChebyNet.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SORChebyNet.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SORChebyNet.__init__-216"><a href="#SORChebyNet.__init__-216"><span class="linenos">216</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SORChebyNet.__init__-217"><a href="#SORChebyNet.__init__-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SORChebyNet.__init__-218"><a href="#SORChebyNet.__init__-218"><span class="linenos">218</span></a>        <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SORChebyNet.__init__-219"><a href="#SORChebyNet.__init__-219"><span class="linenos">219</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORChebyNet.__init__-220"><a href="#SORChebyNet.__init__-220"><span class="linenos">220</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORChebyNet.__init__-221"><a href="#SORChebyNet.__init__-221"><span class="linenos">221</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SORChebyNet.__init__-222"><a href="#SORChebyNet.__init__-222"><span class="linenos">222</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORChebyNet.__init__-223"><a href="#SORChebyNet.__init__-223"><span class="linenos">223</span></a>        <span class="n">init_val_SOR_CHEBY_Net_omega</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
</span><span id="SORChebyNet.__init__-224"><a href="#SORChebyNet.__init__-224"><span class="linenos">224</span></a>        <span class="n">init_val_SOR_CHEBY_Net_gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="SORChebyNet.__init__-225"><a href="#SORChebyNet.__init__-225"><span class="linenos">225</span></a>        <span class="n">init_val_SOR_CHEBY_Net_alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
</span><span id="SORChebyNet.__init__-226"><a href="#SORChebyNet.__init__-226"><span class="linenos">226</span></a>        <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">,</span>
</span><span id="SORChebyNet.__init__-227"><a href="#SORChebyNet.__init__-227"><span class="linenos">227</span></a>    <span class="p">):</span>
</span><span id="SORChebyNet.__init__-228"><a href="#SORChebyNet.__init__-228"><span class="linenos">228</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the SOR_CHEBY_Net model.</span>
</span><span id="SORChebyNet.__init__-229"><a href="#SORChebyNet.__init__-229"><span class="linenos">229</span></a>
</span><span id="SORChebyNet.__init__-230"><a href="#SORChebyNet.__init__-230"><span class="linenos">230</span></a><span class="sd">        Args:</span>
</span><span id="SORChebyNet.__init__-231"><a href="#SORChebyNet.__init__-231"><span class="linenos">231</span></a><span class="sd">          num_itr: Number of iterations.</span>
</span><span id="SORChebyNet.__init__-232"><a href="#SORChebyNet.__init__-232"><span class="linenos">232</span></a><span class="sd">          a: Matrix $A$ of the linear system.</span>
</span><span id="SORChebyNet.__init__-233"><a href="#SORChebyNet.__init__-233"><span class="linenos">233</span></a><span class="sd">          h: Matrix $H$.</span>
</span><span id="SORChebyNet.__init__-234"><a href="#SORChebyNet.__init__-234"><span class="linenos">234</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="SORChebyNet.__init__-235"><a href="#SORChebyNet.__init__-235"><span class="linenos">235</span></a><span class="sd">          y: Solution of the linear equation.</span>
</span><span id="SORChebyNet.__init__-236"><a href="#SORChebyNet.__init__-236"><span class="linenos">236</span></a><span class="sd">          init_val_SOR_CHEBY_Net_omega: Initial value for `omega`.</span>
</span><span id="SORChebyNet.__init__-237"><a href="#SORChebyNet.__init__-237"><span class="linenos">237</span></a><span class="sd">          init_val_SOR_CHEBY_Net_gamma: Initial value for `gamma`.</span>
</span><span id="SORChebyNet.__init__-238"><a href="#SORChebyNet.__init__-238"><span class="linenos">238</span></a><span class="sd">          init_val_SOR_CHEBY_Net_alpha: Initial value for `inv_omega`.</span>
</span><span id="SORChebyNet.__init__-239"><a href="#SORChebyNet.__init__-239"><span class="linenos">239</span></a><span class="sd">          device: Device to run the model on (&#39;cpu&#39; or &#39;cuda&#39;).</span>
</span><span id="SORChebyNet.__init__-240"><a href="#SORChebyNet.__init__-240"><span class="linenos">240</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORChebyNet.__init__-241"><a href="#SORChebyNet.__init__-241"><span class="linenos">241</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">SORChebyNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="SORChebyNet.__init__-242"><a href="#SORChebyNet.__init__-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
</span><span id="SORChebyNet.__init__-243"><a href="#SORChebyNet.__init__-243"><span class="linenos">243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span>
</span><span id="SORChebyNet.__init__-244"><a href="#SORChebyNet.__init__-244"><span class="linenos">244</span></a>            <span class="n">init_val_SOR_CHEBY_Net_gamma</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_itr</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet.__init__-245"><a href="#SORChebyNet.__init__-245"><span class="linenos">245</span></a>        <span class="p">)</span>
</span><span id="SORChebyNet.__init__-246"><a href="#SORChebyNet.__init__-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span>
</span><span id="SORChebyNet.__init__-247"><a href="#SORChebyNet.__init__-247"><span class="linenos">247</span></a>            <span class="n">init_val_SOR_CHEBY_Net_omega</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_itr</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet.__init__-248"><a href="#SORChebyNet.__init__-248"><span class="linenos">248</span></a>        <span class="p">)</span>
</span><span id="SORChebyNet.__init__-249"><a href="#SORChebyNet.__init__-249"><span class="linenos">249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span>
</span><span id="SORChebyNet.__init__-250"><a href="#SORChebyNet.__init__-250"><span class="linenos">250</span></a>            <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_val_SOR_CHEBY_Net_alpha</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet.__init__-251"><a href="#SORChebyNet.__init__-251"><span class="linenos">251</span></a>        <span class="p">)</span>
</span><span id="SORChebyNet.__init__-252"><a href="#SORChebyNet.__init__-252"><span class="linenos">252</span></a>
</span><span id="SORChebyNet.__init__-253"><a href="#SORChebyNet.__init__-253"><span class="linenos">253</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">decompose_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="SORChebyNet.__init__-254"><a href="#SORChebyNet.__init__-254"><span class="linenos">254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span>
</span><span id="SORChebyNet.__init__-255"><a href="#SORChebyNet.__init__-255"><span class="linenos">255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet.__init__-256"><a href="#SORChebyNet.__init__-256"><span class="linenos">256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet.__init__-257"><a href="#SORChebyNet.__init__-257"><span class="linenos">257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet.__init__-258"><a href="#SORChebyNet.__init__-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet.__init__-259"><a href="#SORChebyNet.__init__-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORChebyNet.__init__-260"><a href="#SORChebyNet.__init__-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span>
</span><span id="SORChebyNet.__init__-261"><a href="#SORChebyNet.__init__-261"><span class="linenos">261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the SOR_CHEBY_Net model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  Number of iterations.</li>
<li><strong>a:</strong>  Matrix $A$ of the linear system.</li>
<li><strong>h:</strong>  Matrix $H$.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution of the linear equation.</li>
<li><strong>init_val_SOR_CHEBY_Net_omega:</strong>  Initial value for <code><a href="#SORChebyNet.omega">omega</a></code>.</li>
<li><strong>init_val_SOR_CHEBY_Net_gamma:</strong>  Initial value for <code><a href="#SORChebyNet.gamma">gamma</a></code>.</li>
<li><strong>init_val_SOR_CHEBY_Net_alpha:</strong>  Initial value for <code><a href="#SORChebyNet.inv_omega">inv_omega</a></code>.</li>
<li><strong>device:</strong>  Device to run the model on ('cpu' or 'cuda').</li>
</ul>
</div>


                            </div>
                            <div id="SORChebyNet.device" class="classattr">
                                <div class="attr variable">
            <span class="name">device</span><span class="annotation">: torch.device</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.device"></a>
    
            <div class="docstring"><p>Device to run the model on.</p>
</div>


                            </div>
                            <div id="SORChebyNet.gamma" class="classattr">
                                <div class="attr variable">
            <span class="name">gamma</span><span class="annotation">: torch.nn.parameter.Parameter</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.gamma"></a>
    
            <div class="docstring"><p>Gamma parameter for each iteration.</p>
</div>


                            </div>
                            <div id="SORChebyNet.omega" class="classattr">
                                <div class="attr variable">
            <span class="name">omega</span><span class="annotation">: torch.nn.parameter.Parameter</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.omega"></a>
    
            <div class="docstring"><p>Omega parameter for each iteration.</p>
</div>


                            </div>
                            <div id="SORChebyNet.inv_omega" class="classattr">
                                <div class="attr variable">
            <span class="name">inv_omega</span><span class="annotation">: torch.nn.parameter.Parameter</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.inv_omega"></a>
    
            <div class="docstring"><p>Inverse of the relaxation parameter omega.</p>
</div>


                            </div>
                            <div id="SORChebyNet.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.A"></a>
    
            <div class="docstring"><p>Matrix $A$ of the linear system.</p>
</div>


                            </div>
                            <div id="SORChebyNet.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.D"></a>
    
            <div class="docstring"><p>Diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="SORChebyNet.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix $L$.</p>
</div>


                            </div>
                            <div id="SORChebyNet.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix $U$.</p>
</div>


                            </div>
                            <div id="SORChebyNet.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.H"></a>
    
            <div class="docstring"><p>Matrix $H$.</p>
</div>


                            </div>
                            <div id="SORChebyNet.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="SORChebyNet.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="SORChebyNet.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORChebyNet.y"></a>
    
            <div class="docstring"><p>Solution of the linear equation.</p>
</div>


                            </div>
                            <div id="SORChebyNet.forward" class="classattr">
                                        <input id="SORChebyNet.forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">forward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SORChebyNet.forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SORChebyNet.forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SORChebyNet.forward-263"><a href="#SORChebyNet.forward-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]:</span>
</span><span id="SORChebyNet.forward-264"><a href="#SORChebyNet.forward-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform forward pass of the SOR_CHEBY_Net model.</span>
</span><span id="SORChebyNet.forward-265"><a href="#SORChebyNet.forward-265"><span class="linenos">265</span></a>
</span><span id="SORChebyNet.forward-266"><a href="#SORChebyNet.forward-266"><span class="linenos">266</span></a><span class="sd">        Args:</span>
</span><span id="SORChebyNet.forward-267"><a href="#SORChebyNet.forward-267"><span class="linenos">267</span></a><span class="sd">          num_itr: Number of iterations.</span>
</span><span id="SORChebyNet.forward-268"><a href="#SORChebyNet.forward-268"><span class="linenos">268</span></a>
</span><span id="SORChebyNet.forward-269"><a href="#SORChebyNet.forward-269"><span class="linenos">269</span></a><span class="sd">        Returns:</span>
</span><span id="SORChebyNet.forward-270"><a href="#SORChebyNet.forward-270"><span class="linenos">270</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="SORChebyNet.forward-271"><a href="#SORChebyNet.forward-271"><span class="linenos">271</span></a><span class="sd">            - Output tensor.</span>
</span><span id="SORChebyNet.forward-272"><a href="#SORChebyNet.forward-272"><span class="linenos">272</span></a><span class="sd">            - List of intermediate results.</span>
</span><span id="SORChebyNet.forward-273"><a href="#SORChebyNet.forward-273"><span class="linenos">273</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORChebyNet.forward-274"><a href="#SORChebyNet.forward-274"><span class="linenos">274</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SORChebyNet.forward-275"><a href="#SORChebyNet.forward-275"><span class="linenos">275</span></a>
</span><span id="SORChebyNet.forward-276"><a href="#SORChebyNet.forward-276"><span class="linenos">276</span></a>        <span class="n">m_inv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="SORChebyNet.forward-277"><a href="#SORChebyNet.forward-277"><span class="linenos">277</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># modif to size(0)</span>
</span><span id="SORChebyNet.forward-278"><a href="#SORChebyNet.forward-278"><span class="linenos">278</span></a>        <span class="n">s_new</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="SORChebyNet.forward-279"><a href="#SORChebyNet.forward-279"><span class="linenos">279</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span>
</span><span id="SORChebyNet.forward-280"><a href="#SORChebyNet.forward-280"><span class="linenos">280</span></a>        <span class="p">)</span>  <span class="c1"># modif to size(0)</span>
</span><span id="SORChebyNet.forward-281"><a href="#SORChebyNet.forward-281"><span class="linenos">281</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SORChebyNet.forward-282"><a href="#SORChebyNet.forward-282"><span class="linenos">282</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="SORChebyNet.forward-283"><a href="#SORChebyNet.forward-283"><span class="linenos">283</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="SORChebyNet.forward-284"><a href="#SORChebyNet.forward-284"><span class="linenos">284</span></a>        <span class="n">s_present</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="SORChebyNet.forward-285"><a href="#SORChebyNet.forward-285"><span class="linenos">285</span></a>        <span class="n">s_old</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">s_present</span><span class="p">)</span>
</span><span id="SORChebyNet.forward-286"><a href="#SORChebyNet.forward-286"><span class="linenos">286</span></a>
</span><span id="SORChebyNet.forward-287"><a href="#SORChebyNet.forward-287"><span class="linenos">287</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="SORChebyNet.forward-288"><a href="#SORChebyNet.forward-288"><span class="linenos">288</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span> <span class="o">+</span> <span class="n">yMF</span>
</span><span id="SORChebyNet.forward-289"><a href="#SORChebyNet.forward-289"><span class="linenos">289</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">m_inv</span><span class="p">)</span>
</span><span id="SORChebyNet.forward-290"><a href="#SORChebyNet.forward-290"><span class="linenos">290</span></a>
</span><span id="SORChebyNet.forward-291"><a href="#SORChebyNet.forward-291"><span class="linenos">291</span></a>            <span class="n">s_new</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SORChebyNet.forward-292"><a href="#SORChebyNet.forward-292"><span class="linenos">292</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">s_present</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s_present</span> <span class="o">-</span> <span class="n">s_old</span><span class="p">))</span>
</span><span id="SORChebyNet.forward-293"><a href="#SORChebyNet.forward-293"><span class="linenos">293</span></a>                <span class="o">+</span> <span class="n">s_old</span>
</span><span id="SORChebyNet.forward-294"><a href="#SORChebyNet.forward-294"><span class="linenos">294</span></a>            <span class="p">)</span>
</span><span id="SORChebyNet.forward-295"><a href="#SORChebyNet.forward-295"><span class="linenos">295</span></a>            <span class="n">s_old</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="SORChebyNet.forward-296"><a href="#SORChebyNet.forward-296"><span class="linenos">296</span></a>            <span class="n">s_present</span> <span class="o">=</span> <span class="n">s_new</span>
</span><span id="SORChebyNet.forward-297"><a href="#SORChebyNet.forward-297"><span class="linenos">297</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_new</span><span class="p">)</span>
</span><span id="SORChebyNet.forward-298"><a href="#SORChebyNet.forward-298"><span class="linenos">298</span></a>
</span><span id="SORChebyNet.forward-299"><a href="#SORChebyNet.forward-299"><span class="linenos">299</span></a>        <span class="k">return</span> <span class="n">s_new</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Perform forward pass of the SOR_CHEBY_Net model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  Number of iterations.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>Output tensor.</li>
  <li>List of intermediate results.</li>
  </ul>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>torch.nn.modules.module.Module</dt>
                                <dd id="SORChebyNet.dump_patches" class="variable">dump_patches</dd>
                <dd id="SORChebyNet.training" class="variable">training</dd>
                <dd id="SORChebyNet.call_super_init" class="variable">call_super_init</dd>
                <dd id="SORChebyNet.register_buffer" class="function">register_buffer</dd>
                <dd id="SORChebyNet.register_parameter" class="function">register_parameter</dd>
                <dd id="SORChebyNet.add_module" class="function">add_module</dd>
                <dd id="SORChebyNet.register_module" class="function">register_module</dd>
                <dd id="SORChebyNet.get_submodule" class="function">get_submodule</dd>
                <dd id="SORChebyNet.get_parameter" class="function">get_parameter</dd>
                <dd id="SORChebyNet.get_buffer" class="function">get_buffer</dd>
                <dd id="SORChebyNet.get_extra_state" class="function">get_extra_state</dd>
                <dd id="SORChebyNet.set_extra_state" class="function">set_extra_state</dd>
                <dd id="SORChebyNet.apply" class="function">apply</dd>
                <dd id="SORChebyNet.cuda" class="function">cuda</dd>
                <dd id="SORChebyNet.ipu" class="function">ipu</dd>
                <dd id="SORChebyNet.xpu" class="function">xpu</dd>
                <dd id="SORChebyNet.cpu" class="function">cpu</dd>
                <dd id="SORChebyNet.type" class="function">type</dd>
                <dd id="SORChebyNet.float" class="function">float</dd>
                <dd id="SORChebyNet.double" class="function">double</dd>
                <dd id="SORChebyNet.half" class="function">half</dd>
                <dd id="SORChebyNet.bfloat16" class="function">bfloat16</dd>
                <dd id="SORChebyNet.to_empty" class="function">to_empty</dd>
                <dd id="SORChebyNet.to" class="function">to</dd>
                <dd id="SORChebyNet.register_full_backward_pre_hook" class="function">register_full_backward_pre_hook</dd>
                <dd id="SORChebyNet.register_backward_hook" class="function">register_backward_hook</dd>
                <dd id="SORChebyNet.register_full_backward_hook" class="function">register_full_backward_hook</dd>
                <dd id="SORChebyNet.register_forward_pre_hook" class="function">register_forward_pre_hook</dd>
                <dd id="SORChebyNet.register_forward_hook" class="function">register_forward_hook</dd>
                <dd id="SORChebyNet.register_state_dict_pre_hook" class="function">register_state_dict_pre_hook</dd>
                <dd id="SORChebyNet.state_dict" class="function">state_dict</dd>
                <dd id="SORChebyNet.register_load_state_dict_post_hook" class="function">register_load_state_dict_post_hook</dd>
                <dd id="SORChebyNet.load_state_dict" class="function">load_state_dict</dd>
                <dd id="SORChebyNet.parameters" class="function">parameters</dd>
                <dd id="SORChebyNet.named_parameters" class="function">named_parameters</dd>
                <dd id="SORChebyNet.buffers" class="function">buffers</dd>
                <dd id="SORChebyNet.named_buffers" class="function">named_buffers</dd>
                <dd id="SORChebyNet.children" class="function">children</dd>
                <dd id="SORChebyNet.named_children" class="function">named_children</dd>
                <dd id="SORChebyNet.modules" class="function">modules</dd>
                <dd id="SORChebyNet.named_modules" class="function">named_modules</dd>
                <dd id="SORChebyNet.train" class="function">train</dd>
                <dd id="SORChebyNet.eval" class="function">eval</dd>
                <dd id="SORChebyNet.requires_grad_" class="function">requires_grad_</dd>
                <dd id="SORChebyNet.zero_grad" class="function">zero_grad</dd>
                <dd id="SORChebyNet.share_memory" class="function">share_memory</dd>
                <dd id="SORChebyNet.extra_repr" class="function">extra_repr</dd>
                <dd id="SORChebyNet.compile" class="function">compile</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="SORNet">
                            <input id="SORNet-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SORNet</span><wbr>(<span class="base">torch.nn.modules.module.Module</span>):

                <label class="view-source-button" for="SORNet-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SORNet"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SORNet-83"><a href="#SORNet-83"><span class="linenos"> 83</span></a><span class="k">class</span> <span class="nc">SORNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span id="SORNet-84"><a href="#SORNet-84"><span class="linenos"> 84</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Deep unfolded SOR with a constant step size.&quot;&quot;&quot;</span>
</span><span id="SORNet-85"><a href="#SORNet-85"><span class="linenos"> 85</span></a>
</span><span id="SORNet-86"><a href="#SORNet-86"><span class="linenos"> 86</span></a>    <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span>
</span><span id="SORNet-87"><a href="#SORNet-87"><span class="linenos"> 87</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Device to run the model on.&quot;&quot;&quot;</span>
</span><span id="SORNet-88"><a href="#SORNet-88"><span class="linenos"> 88</span></a>
</span><span id="SORNet-89"><a href="#SORNet-89"><span class="linenos"> 89</span></a>    <span class="n">inv_omega</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span>
</span><span id="SORNet-90"><a href="#SORNet-90"><span class="linenos"> 90</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the relaxation parameter omega.&quot;&quot;&quot;</span>
</span><span id="SORNet-91"><a href="#SORNet-91"><span class="linenos"> 91</span></a>
</span><span id="SORNet-92"><a href="#SORNet-92"><span class="linenos"> 92</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORNet-93"><a href="#SORNet-93"><span class="linenos"> 93</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix $A$ of the linear system.&quot;&quot;&quot;</span>
</span><span id="SORNet-94"><a href="#SORNet-94"><span class="linenos"> 94</span></a>
</span><span id="SORNet-95"><a href="#SORNet-95"><span class="linenos"> 95</span></a>    <span class="n">D</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORNet-96"><a href="#SORNet-96"><span class="linenos"> 96</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="SORNet-97"><a href="#SORNet-97"><span class="linenos"> 97</span></a>
</span><span id="SORNet-98"><a href="#SORNet-98"><span class="linenos"> 98</span></a>    <span class="n">L</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORNet-99"><a href="#SORNet-99"><span class="linenos"> 99</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lower triangular matrix $L$.&quot;&quot;&quot;</span>
</span><span id="SORNet-100"><a href="#SORNet-100"><span class="linenos">100</span></a>
</span><span id="SORNet-101"><a href="#SORNet-101"><span class="linenos">101</span></a>    <span class="n">U</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORNet-102"><a href="#SORNet-102"><span class="linenos">102</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Upper triangular matrix $U$.&quot;&quot;&quot;</span>
</span><span id="SORNet-103"><a href="#SORNet-103"><span class="linenos">103</span></a>
</span><span id="SORNet-104"><a href="#SORNet-104"><span class="linenos">104</span></a>    <span class="n">H</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORNet-105"><a href="#SORNet-105"><span class="linenos">105</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix $H$.&quot;&quot;&quot;</span>
</span><span id="SORNet-106"><a href="#SORNet-106"><span class="linenos">106</span></a>
</span><span id="SORNet-107"><a href="#SORNet-107"><span class="linenos">107</span></a>    <span class="n">Dinv</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORNet-108"><a href="#SORNet-108"><span class="linenos">108</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse of the diagonal matrix $D$.&quot;&quot;&quot;</span>
</span><span id="SORNet-109"><a href="#SORNet-109"><span class="linenos">109</span></a>
</span><span id="SORNet-110"><a href="#SORNet-110"><span class="linenos">110</span></a>    <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SORNet-111"><a href="#SORNet-111"><span class="linenos">111</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch size.&quot;&quot;&quot;</span>
</span><span id="SORNet-112"><a href="#SORNet-112"><span class="linenos">112</span></a>
</span><span id="SORNet-113"><a href="#SORNet-113"><span class="linenos">113</span></a>    <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span>
</span><span id="SORNet-114"><a href="#SORNet-114"><span class="linenos">114</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solution of the linear equation.&quot;&quot;&quot;</span>
</span><span id="SORNet-115"><a href="#SORNet-115"><span class="linenos">115</span></a>
</span><span id="SORNet-116"><a href="#SORNet-116"><span class="linenos">116</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SORNet-117"><a href="#SORNet-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SORNet-118"><a href="#SORNet-118"><span class="linenos">118</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORNet-119"><a href="#SORNet-119"><span class="linenos">119</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORNet-120"><a href="#SORNet-120"><span class="linenos">120</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SORNet-121"><a href="#SORNet-121"><span class="linenos">121</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORNet-122"><a href="#SORNet-122"><span class="linenos">122</span></a>        <span class="n">init_val_SORNet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.1</span><span class="p">,</span>
</span><span id="SORNet-123"><a href="#SORNet-123"><span class="linenos">123</span></a>        <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">,</span>
</span><span id="SORNet-124"><a href="#SORNet-124"><span class="linenos">124</span></a>    <span class="p">):</span>
</span><span id="SORNet-125"><a href="#SORNet-125"><span class="linenos">125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the SORNet model.</span>
</span><span id="SORNet-126"><a href="#SORNet-126"><span class="linenos">126</span></a>
</span><span id="SORNet-127"><a href="#SORNet-127"><span class="linenos">127</span></a><span class="sd">        Args:</span>
</span><span id="SORNet-128"><a href="#SORNet-128"><span class="linenos">128</span></a><span class="sd">          a: Matrix $A$ of the linear system.</span>
</span><span id="SORNet-129"><a href="#SORNet-129"><span class="linenos">129</span></a><span class="sd">          h: Matrix $H$.</span>
</span><span id="SORNet-130"><a href="#SORNet-130"><span class="linenos">130</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="SORNet-131"><a href="#SORNet-131"><span class="linenos">131</span></a><span class="sd">          y: Solution of the linear equation.</span>
</span><span id="SORNet-132"><a href="#SORNet-132"><span class="linenos">132</span></a><span class="sd">          init_val_SORNet: Initial value for `inv_omega`.</span>
</span><span id="SORNet-133"><a href="#SORNet-133"><span class="linenos">133</span></a><span class="sd">          device: Device to run the model on (&#39;cpu&#39; or &#39;cuda&#39;).</span>
</span><span id="SORNet-134"><a href="#SORNet-134"><span class="linenos">134</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORNet-135"><a href="#SORNet-135"><span class="linenos">135</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">SORNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="SORNet-136"><a href="#SORNet-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
</span><span id="SORNet-137"><a href="#SORNet-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_val_SORNet</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>
</span><span id="SORNet-138"><a href="#SORNet-138"><span class="linenos">138</span></a>
</span><span id="SORNet-139"><a href="#SORNet-139"><span class="linenos">139</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">decompose_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="SORNet-140"><a href="#SORNet-140"><span class="linenos">140</span></a>
</span><span id="SORNet-141"><a href="#SORNet-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet-142"><a href="#SORNet-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet-143"><a href="#SORNet-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet-144"><a href="#SORNet-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet-145"><a href="#SORNet-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet-146"><a href="#SORNet-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet-147"><a href="#SORNet-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span>
</span><span id="SORNet-148"><a href="#SORNet-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet-149"><a href="#SORNet-149"><span class="linenos">149</span></a>
</span><span id="SORNet-150"><a href="#SORNet-150"><span class="linenos">150</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]:</span>
</span><span id="SORNet-151"><a href="#SORNet-151"><span class="linenos">151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform forward pass of the SORNet model.</span>
</span><span id="SORNet-152"><a href="#SORNet-152"><span class="linenos">152</span></a>
</span><span id="SORNet-153"><a href="#SORNet-153"><span class="linenos">153</span></a><span class="sd">        Args:</span>
</span><span id="SORNet-154"><a href="#SORNet-154"><span class="linenos">154</span></a><span class="sd">          num_itr: Number of iterations.</span>
</span><span id="SORNet-155"><a href="#SORNet-155"><span class="linenos">155</span></a>
</span><span id="SORNet-156"><a href="#SORNet-156"><span class="linenos">156</span></a><span class="sd">        Returns:</span>
</span><span id="SORNet-157"><a href="#SORNet-157"><span class="linenos">157</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="SORNet-158"><a href="#SORNet-158"><span class="linenos">158</span></a><span class="sd">            - Output tensor.</span>
</span><span id="SORNet-159"><a href="#SORNet-159"><span class="linenos">159</span></a><span class="sd">            - List of intermediate results.</span>
</span><span id="SORNet-160"><a href="#SORNet-160"><span class="linenos">160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORNet-161"><a href="#SORNet-161"><span class="linenos">161</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SORNet-162"><a href="#SORNet-162"><span class="linenos">162</span></a>
</span><span id="SORNet-163"><a href="#SORNet-163"><span class="linenos">163</span></a>        <span class="n">m_inv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="SORNet-164"><a href="#SORNet-164"><span class="linenos">164</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet-165"><a href="#SORNet-165"><span class="linenos">165</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SORNet-166"><a href="#SORNet-166"><span class="linenos">166</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="SORNet-167"><a href="#SORNet-167"><span class="linenos">167</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="SORNet-168"><a href="#SORNet-168"><span class="linenos">168</span></a>
</span><span id="SORNet-169"><a href="#SORNet-169"><span class="linenos">169</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="SORNet-170"><a href="#SORNet-170"><span class="linenos">170</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span> <span class="o">+</span> <span class="n">yMF</span>
</span><span id="SORNet-171"><a href="#SORNet-171"><span class="linenos">171</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">m_inv</span><span class="p">)</span>
</span><span id="SORNet-172"><a href="#SORNet-172"><span class="linenos">172</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SORNet-173"><a href="#SORNet-173"><span class="linenos">173</span></a>
</span><span id="SORNet-174"><a href="#SORNet-174"><span class="linenos">174</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Deep unfolded SOR with a constant step size.</p>
</div>


                            <div id="SORNet.__init__" class="classattr">
                                        <input id="SORNet.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SORNet</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">bs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">init_val_SORNet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.1</span>,</span><span class="param">	<span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span></span>)</span>

                <label class="view-source-button" for="SORNet.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SORNet.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SORNet.__init__-116"><a href="#SORNet.__init__-116"><span class="linenos">116</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SORNet.__init__-117"><a href="#SORNet.__init__-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SORNet.__init__-118"><a href="#SORNet.__init__-118"><span class="linenos">118</span></a>        <span class="n">a</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORNet.__init__-119"><a href="#SORNet.__init__-119"><span class="linenos">119</span></a>        <span class="n">h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORNet.__init__-120"><a href="#SORNet.__init__-120"><span class="linenos">120</span></a>        <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="SORNet.__init__-121"><a href="#SORNet.__init__-121"><span class="linenos">121</span></a>        <span class="n">y</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="SORNet.__init__-122"><a href="#SORNet.__init__-122"><span class="linenos">122</span></a>        <span class="n">init_val_SORNet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.1</span><span class="p">,</span>
</span><span id="SORNet.__init__-123"><a href="#SORNet.__init__-123"><span class="linenos">123</span></a>        <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">,</span>
</span><span id="SORNet.__init__-124"><a href="#SORNet.__init__-124"><span class="linenos">124</span></a>    <span class="p">):</span>
</span><span id="SORNet.__init__-125"><a href="#SORNet.__init__-125"><span class="linenos">125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the SORNet model.</span>
</span><span id="SORNet.__init__-126"><a href="#SORNet.__init__-126"><span class="linenos">126</span></a>
</span><span id="SORNet.__init__-127"><a href="#SORNet.__init__-127"><span class="linenos">127</span></a><span class="sd">        Args:</span>
</span><span id="SORNet.__init__-128"><a href="#SORNet.__init__-128"><span class="linenos">128</span></a><span class="sd">          a: Matrix $A$ of the linear system.</span>
</span><span id="SORNet.__init__-129"><a href="#SORNet.__init__-129"><span class="linenos">129</span></a><span class="sd">          h: Matrix $H$.</span>
</span><span id="SORNet.__init__-130"><a href="#SORNet.__init__-130"><span class="linenos">130</span></a><span class="sd">          bs: Batch size.</span>
</span><span id="SORNet.__init__-131"><a href="#SORNet.__init__-131"><span class="linenos">131</span></a><span class="sd">          y: Solution of the linear equation.</span>
</span><span id="SORNet.__init__-132"><a href="#SORNet.__init__-132"><span class="linenos">132</span></a><span class="sd">          init_val_SORNet: Initial value for `inv_omega`.</span>
</span><span id="SORNet.__init__-133"><a href="#SORNet.__init__-133"><span class="linenos">133</span></a><span class="sd">          device: Device to run the model on (&#39;cpu&#39; or &#39;cuda&#39;).</span>
</span><span id="SORNet.__init__-134"><a href="#SORNet.__init__-134"><span class="linenos">134</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORNet.__init__-135"><a href="#SORNet.__init__-135"><span class="linenos">135</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">SORNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="SORNet.__init__-136"><a href="#SORNet.__init__-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
</span><span id="SORNet.__init__-137"><a href="#SORNet.__init__-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_val_SORNet</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>
</span><span id="SORNet.__init__-138"><a href="#SORNet.__init__-138"><span class="linenos">138</span></a>
</span><span id="SORNet.__init__-139"><a href="#SORNet.__init__-139"><span class="linenos">139</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">decompose_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="SORNet.__init__-140"><a href="#SORNet.__init__-140"><span class="linenos">140</span></a>
</span><span id="SORNet.__init__-141"><a href="#SORNet.__init__-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet.__init__-142"><a href="#SORNet.__init__-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet.__init__-143"><a href="#SORNet.__init__-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet.__init__-144"><a href="#SORNet.__init__-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet.__init__-145"><a href="#SORNet.__init__-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet.__init__-146"><a href="#SORNet.__init__-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet.__init__-147"><a href="#SORNet.__init__-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span>
</span><span id="SORNet.__init__-148"><a href="#SORNet.__init__-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the SORNet model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>a:</strong>  Matrix $A$ of the linear system.</li>
<li><strong>h:</strong>  Matrix $H$.</li>
<li><strong>bs:</strong>  Batch size.</li>
<li><strong>y:</strong>  Solution of the linear equation.</li>
<li><strong>init_val_SORNet:</strong>  Initial value for <code><a href="#SORNet.inv_omega">inv_omega</a></code>.</li>
<li><strong>device:</strong>  Device to run the model on ('cpu' or 'cuda').</li>
</ul>
</div>


                            </div>
                            <div id="SORNet.device" class="classattr">
                                <div class="attr variable">
            <span class="name">device</span><span class="annotation">: torch.device</span>

        
    </div>
    <a class="headerlink" href="#SORNet.device"></a>
    
            <div class="docstring"><p>Device to run the model on.</p>
</div>


                            </div>
                            <div id="SORNet.inv_omega" class="classattr">
                                <div class="attr variable">
            <span class="name">inv_omega</span><span class="annotation">: torch.nn.parameter.Parameter</span>

        
    </div>
    <a class="headerlink" href="#SORNet.inv_omega"></a>
    
            <div class="docstring"><p>Inverse of the relaxation parameter omega.</p>
</div>


                            </div>
                            <div id="SORNet.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORNet.A"></a>
    
            <div class="docstring"><p>Matrix $A$ of the linear system.</p>
</div>


                            </div>
                            <div id="SORNet.D" class="classattr">
                                <div class="attr variable">
            <span class="name">D</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORNet.D"></a>
    
            <div class="docstring"><p>Diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="SORNet.L" class="classattr">
                                <div class="attr variable">
            <span class="name">L</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORNet.L"></a>
    
            <div class="docstring"><p>Lower triangular matrix $L$.</p>
</div>


                            </div>
                            <div id="SORNet.U" class="classattr">
                                <div class="attr variable">
            <span class="name">U</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORNet.U"></a>
    
            <div class="docstring"><p>Upper triangular matrix $U$.</p>
</div>


                            </div>
                            <div id="SORNet.H" class="classattr">
                                <div class="attr variable">
            <span class="name">H</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORNet.H"></a>
    
            <div class="docstring"><p>Matrix $H$.</p>
</div>


                            </div>
                            <div id="SORNet.Dinv" class="classattr">
                                <div class="attr variable">
            <span class="name">Dinv</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORNet.Dinv"></a>
    
            <div class="docstring"><p>Inverse of the diagonal matrix $D$.</p>
</div>


                            </div>
                            <div id="SORNet.bs" class="classattr">
                                <div class="attr variable">
            <span class="name">bs</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#SORNet.bs"></a>
    
            <div class="docstring"><p>Batch size.</p>
</div>


                            </div>
                            <div id="SORNet.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span><span class="annotation">: torch.Tensor</span>

        
    </div>
    <a class="headerlink" href="#SORNet.y"></a>
    
            <div class="docstring"><p>Solution of the linear equation.</p>
</div>


                            </div>
                            <div id="SORNet.forward" class="classattr">
                                        <input id="SORNet.forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">forward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="SORNet.forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SORNet.forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SORNet.forward-150"><a href="#SORNet.forward-150"><span class="linenos">150</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]:</span>
</span><span id="SORNet.forward-151"><a href="#SORNet.forward-151"><span class="linenos">151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform forward pass of the SORNet model.</span>
</span><span id="SORNet.forward-152"><a href="#SORNet.forward-152"><span class="linenos">152</span></a>
</span><span id="SORNet.forward-153"><a href="#SORNet.forward-153"><span class="linenos">153</span></a><span class="sd">        Args:</span>
</span><span id="SORNet.forward-154"><a href="#SORNet.forward-154"><span class="linenos">154</span></a><span class="sd">          num_itr: Number of iterations.</span>
</span><span id="SORNet.forward-155"><a href="#SORNet.forward-155"><span class="linenos">155</span></a>
</span><span id="SORNet.forward-156"><a href="#SORNet.forward-156"><span class="linenos">156</span></a><span class="sd">        Returns:</span>
</span><span id="SORNet.forward-157"><a href="#SORNet.forward-157"><span class="linenos">157</span></a><span class="sd">          A tuple with the following contents:</span>
</span><span id="SORNet.forward-158"><a href="#SORNet.forward-158"><span class="linenos">158</span></a><span class="sd">            - Output tensor.</span>
</span><span id="SORNet.forward-159"><a href="#SORNet.forward-159"><span class="linenos">159</span></a><span class="sd">            - List of intermediate results.</span>
</span><span id="SORNet.forward-160"><a href="#SORNet.forward-160"><span class="linenos">160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SORNet.forward-161"><a href="#SORNet.forward-161"><span class="linenos">161</span></a>        <span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SORNet.forward-162"><a href="#SORNet.forward-162"><span class="linenos">162</span></a>
</span><span id="SORNet.forward-163"><a href="#SORNet.forward-163"><span class="linenos">163</span></a>        <span class="n">m_inv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span><span id="SORNet.forward-164"><a href="#SORNet.forward-164"><span class="linenos">164</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="SORNet.forward-165"><a href="#SORNet.forward-165"><span class="linenos">165</span></a>        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SORNet.forward-166"><a href="#SORNet.forward-166"><span class="linenos">166</span></a>        <span class="n">yMF</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="SORNet.forward-167"><a href="#SORNet.forward-167"><span class="linenos">167</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">yMF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dinv</span><span class="p">)</span>
</span><span id="SORNet.forward-168"><a href="#SORNet.forward-168"><span class="linenos">168</span></a>
</span><span id="SORNet.forward-169"><a href="#SORNet.forward-169"><span class="linenos">169</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_itr</span><span class="p">):</span>
</span><span id="SORNet.forward-170"><a href="#SORNet.forward-170"><span class="linenos">170</span></a>            <span class="n">temp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv_omega</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span> <span class="o">+</span> <span class="n">yMF</span>
</span><span id="SORNet.forward-171"><a href="#SORNet.forward-171"><span class="linenos">171</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">m_inv</span><span class="p">)</span>
</span><span id="SORNet.forward-172"><a href="#SORNet.forward-172"><span class="linenos">172</span></a>            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="SORNet.forward-173"><a href="#SORNet.forward-173"><span class="linenos">173</span></a>
</span><span id="SORNet.forward-174"><a href="#SORNet.forward-174"><span class="linenos">174</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">traj</span>
</span></pre></div>


            <div class="docstring"><p>Perform forward pass of the SORNet model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>num_itr:</strong>  Number of iterations.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple with the following contents:</p>
  
  <ul>
  <li>Output tensor.</li>
  <li>List of intermediate results.</li>
  </ul>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>torch.nn.modules.module.Module</dt>
                                <dd id="SORNet.dump_patches" class="variable">dump_patches</dd>
                <dd id="SORNet.training" class="variable">training</dd>
                <dd id="SORNet.call_super_init" class="variable">call_super_init</dd>
                <dd id="SORNet.register_buffer" class="function">register_buffer</dd>
                <dd id="SORNet.register_parameter" class="function">register_parameter</dd>
                <dd id="SORNet.add_module" class="function">add_module</dd>
                <dd id="SORNet.register_module" class="function">register_module</dd>
                <dd id="SORNet.get_submodule" class="function">get_submodule</dd>
                <dd id="SORNet.get_parameter" class="function">get_parameter</dd>
                <dd id="SORNet.get_buffer" class="function">get_buffer</dd>
                <dd id="SORNet.get_extra_state" class="function">get_extra_state</dd>
                <dd id="SORNet.set_extra_state" class="function">set_extra_state</dd>
                <dd id="SORNet.apply" class="function">apply</dd>
                <dd id="SORNet.cuda" class="function">cuda</dd>
                <dd id="SORNet.ipu" class="function">ipu</dd>
                <dd id="SORNet.xpu" class="function">xpu</dd>
                <dd id="SORNet.cpu" class="function">cpu</dd>
                <dd id="SORNet.type" class="function">type</dd>
                <dd id="SORNet.float" class="function">float</dd>
                <dd id="SORNet.double" class="function">double</dd>
                <dd id="SORNet.half" class="function">half</dd>
                <dd id="SORNet.bfloat16" class="function">bfloat16</dd>
                <dd id="SORNet.to_empty" class="function">to_empty</dd>
                <dd id="SORNet.to" class="function">to</dd>
                <dd id="SORNet.register_full_backward_pre_hook" class="function">register_full_backward_pre_hook</dd>
                <dd id="SORNet.register_backward_hook" class="function">register_backward_hook</dd>
                <dd id="SORNet.register_full_backward_hook" class="function">register_full_backward_hook</dd>
                <dd id="SORNet.register_forward_pre_hook" class="function">register_forward_pre_hook</dd>
                <dd id="SORNet.register_forward_hook" class="function">register_forward_hook</dd>
                <dd id="SORNet.register_state_dict_pre_hook" class="function">register_state_dict_pre_hook</dd>
                <dd id="SORNet.state_dict" class="function">state_dict</dd>
                <dd id="SORNet.register_load_state_dict_post_hook" class="function">register_load_state_dict_post_hook</dd>
                <dd id="SORNet.load_state_dict" class="function">load_state_dict</dd>
                <dd id="SORNet.parameters" class="function">parameters</dd>
                <dd id="SORNet.named_parameters" class="function">named_parameters</dd>
                <dd id="SORNet.buffers" class="function">buffers</dd>
                <dd id="SORNet.named_buffers" class="function">named_buffers</dd>
                <dd id="SORNet.children" class="function">children</dd>
                <dd id="SORNet.named_children" class="function">named_children</dd>
                <dd id="SORNet.modules" class="function">modules</dd>
                <dd id="SORNet.named_modules" class="function">named_modules</dd>
                <dd id="SORNet.train" class="function">train</dd>
                <dd id="SORNet.eval" class="function">eval</dd>
                <dd id="SORNet.requires_grad_" class="function">requires_grad_</dd>
                <dd id="SORNet.zero_grad" class="function">zero_grad</dd>
                <dd id="SORNet.share_memory" class="function">share_memory</dd>
                <dd id="SORNet.extra_repr" class="function">extra_repr</dd>
                <dd id="SORNet.compile" class="function">compile</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="train_model">
                            <input id="train_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">train_model</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">model</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">Module</span>,</span><span class="param">	<span class="n">optimizer</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">Optimizer</span>,</span><span class="param">	<span class="n">loss_func</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">Module</span>,</span><span class="param">	<span class="n">solution</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>,</span><span class="param">	<span class="n">total_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span>,</span><span class="param">	<span class="n">num_batch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="train_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#train_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="train_model-15"><a href="#train_model-15"><span class="linenos">15</span></a><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span>
</span><span id="train_model-16"><a href="#train_model-16"><span class="linenos">16</span></a>    <span class="n">model</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
</span><span id="train_model-17"><a href="#train_model-17"><span class="linenos">17</span></a>    <span class="n">optimizer</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">,</span>
</span><span id="train_model-18"><a href="#train_model-18"><span class="linenos">18</span></a>    <span class="n">loss_func</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
</span><span id="train_model-19"><a href="#train_model-19"><span class="linenos">19</span></a>    <span class="n">solution</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
</span><span id="train_model-20"><a href="#train_model-20"><span class="linenos">20</span></a>    <span class="n">total_itr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
</span><span id="train_model-21"><a href="#train_model-21"><span class="linenos">21</span></a>    <span class="n">num_batch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
</span><span id="train_model-22"><a href="#train_model-22"><span class="linenos">22</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="train_model-23"><a href="#train_model-23"><span class="linenos">23</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Train the given model using the specified optimizer and loss function.</span>
</span><span id="train_model-24"><a href="#train_model-24"><span class="linenos">24</span></a>
</span><span id="train_model-25"><a href="#train_model-25"><span class="linenos">25</span></a><span class="sd">    Args:</span>
</span><span id="train_model-26"><a href="#train_model-26"><span class="linenos">26</span></a><span class="sd">      model: The model to be trained.</span>
</span><span id="train_model-27"><a href="#train_model-27"><span class="linenos">27</span></a><span class="sd">      optimizer: The optimizer to use for training.</span>
</span><span id="train_model-28"><a href="#train_model-28"><span class="linenos">28</span></a><span class="sd">      loss_func: The loss function to use for training.</span>
</span><span id="train_model-29"><a href="#train_model-29"><span class="linenos">29</span></a><span class="sd">      total_itr: The total number of iterations (generations) for training.</span>
</span><span id="train_model-30"><a href="#train_model-30"><span class="linenos">30</span></a><span class="sd">      solution: The target solution tensor.</span>
</span><span id="train_model-31"><a href="#train_model-31"><span class="linenos">31</span></a><span class="sd">      num_batch: The number of batches per iteration.</span>
</span><span id="train_model-32"><a href="#train_model-32"><span class="linenos">32</span></a>
</span><span id="train_model-33"><a href="#train_model-33"><span class="linenos">33</span></a><span class="sd">    Returns:</span>
</span><span id="train_model-34"><a href="#train_model-34"><span class="linenos">34</span></a><span class="sd">      The trained model and the list of loss values per iteration.</span>
</span><span id="train_model-35"><a href="#train_model-35"><span class="linenos">35</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="train_model-36"><a href="#train_model-36"><span class="linenos">36</span></a>    <span class="n">loss_gen</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="train_model-37"><a href="#train_model-37"><span class="linenos">37</span></a>    <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_itr</span><span class="p">):</span>
</span><span id="train_model-38"><a href="#train_model-38"><span class="linenos">38</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_batch</span><span class="p">):</span>
</span><span id="train_model-39"><a href="#train_model-39"><span class="linenos">39</span></a>            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
</span><span id="train_model-40"><a href="#train_model-40"><span class="linenos">40</span></a>            <span class="n">x_hat</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">gen</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="train_model-41"><a href="#train_model-41"><span class="linenos">41</span></a>            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_func</span><span class="p">(</span><span class="n">x_hat</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
</span><span id="train_model-42"><a href="#train_model-42"><span class="linenos">42</span></a>            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</span><span id="train_model-43"><a href="#train_model-43"><span class="linenos">43</span></a>            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</span><span id="train_model-44"><a href="#train_model-44"><span class="linenos">44</span></a>
</span><span id="train_model-45"><a href="#train_model-45"><span class="linenos">45</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">200</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="train_model-46"><a href="#train_model-46"><span class="linenos">46</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;generation:&quot;</span><span class="p">,</span> <span class="n">gen</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot; batch:&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> MSE loss:&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="train_model-47"><a href="#train_model-47"><span class="linenos">47</span></a>        <span class="n">loss_gen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="train_model-48"><a href="#train_model-48"><span class="linenos">48</span></a>    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_gen</span>
</span></pre></div>


            <div class="docstring"><p>Train the given model using the specified optimizer and loss function.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model:</strong>  The model to be trained.</li>
<li><strong>optimizer:</strong>  The optimizer to use for training.</li>
<li><strong>loss_func:</strong>  The loss function to use for training.</li>
<li><strong>total_itr:</strong>  The total number of iterations (generations) for training.</li>
<li><strong>solution:</strong>  The target solution tensor.</li>
<li><strong>num_batch:</strong>  The number of batches per iteration.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>The trained model and the list of loss values per iteration.</p>
</blockquote>
</div>


                </section>
    </main>
</body>
</html>